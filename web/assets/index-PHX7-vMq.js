var Wi=Object.defineProperty;var zi=(h,i,l)=>i in h?Wi(h,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):h[i]=l;var jt=(h,i,l)=>zi(h,typeof i!="symbol"?i+"":i,l);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))_(y);new MutationObserver(y=>{for(const w of y)if(w.type==="childList")for(const C of w.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&_(C)}).observe(document,{childList:!0,subtree:!0});function l(y){const w={};return y.integrity&&(w.integrity=y.integrity),y.referrerPolicy&&(w.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?w.credentials="include":y.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function _(y){if(y.ep)return;y.ep=!0;const w=l(y);fetch(y.href,w)}})();function ie(){}const Ut=h=>h;function gi(h){return h()}function Ss(){return Object.create(null)}function fe(h){h.forEach(gi)}function _t(h){return typeof h=="function"}function Pe(h,i){return h!=h?i==i:h!==i||h&&typeof h=="object"||typeof h=="function"}function Ni(h){return Object.keys(h).length===0}function Yt(h,...i){if(h==null){for(const _ of i)_(void 0);return ie}const l=h.subscribe(...i);return l.unsubscribe?()=>l.unsubscribe():l}function bt(h){let i;return Yt(h,l=>i=l)(),i}function be(h,i,l){h.$$.on_destroy.push(Yt(i,l))}function bs(h){const i=typeof h=="string"&&h.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[h,"px"]}const mi=typeof window<"u";let Zt=mi?()=>window.performance.now():()=>Date.now(),Qt=mi?h=>requestAnimationFrame(h):ie;const dt=new Set;function Si(h){dt.forEach(i=>{i.c(h)||(dt.delete(i),i.f())}),dt.size!==0&&Qt(Si)}function es(h){let i;return dt.size===0&&Qt(Si),{promise:new Promise(l=>{dt.add(i={c:h,f:l})}),abort(){dt.delete(i)}}}const bi=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function E(h,i){h.appendChild(i)}function Ci(h){if(!h)return document;const i=h.getRootNode?h.getRootNode():h.ownerDocument;return i&&i.host?i:h.ownerDocument}function Ui(h){const i=T("style");return i.textContent="/* empty */",$i(Ci(h),i),i.sheet}function $i(h,i){return E(h.head||h,i),i.sheet}function ee(h,i,l){h.insertBefore(i,l||null)}function Q(h){h.parentNode&&h.parentNode.removeChild(h)}function T(h){return document.createElement(h)}function se(h){return document.createTextNode(h)}function U(){return se(" ")}function kt(){return se("")}function Z(h,i,l,_){return h.addEventListener(i,l,_),()=>h.removeEventListener(i,l,_)}function Et(h){return function(i){return i.stopPropagation(),h.call(this,i)}}function A(h,i,l){l==null?h.removeAttribute(i):h.getAttribute(i)!==l&&h.setAttribute(i,l)}function wi(h){return h===""?null:+h}function qi(h){return Array.from(h.childNodes)}function ne(h,i){i=""+i,h.data!==i&&(h.data=i)}function ge(h,i){h.value=i??""}function Me(h,i,l,_){l==null?h.style.removeProperty(i):h.style.setProperty(i,l,"")}function at(h,i,l){for(let _=0;_<h.options.length;_+=1){const y=h.options[_];if(y.__value===i){y.selected=!0;return}}(!l||i!==void 0)&&(h.selectedIndex=-1)}function Kt(h){const i=h.querySelector(":checked");return i&&i.__value}function le(h,i,l){h.classList.toggle(i,!!l)}function yi(h,i,{bubbles:l=!1,cancelable:_=!1}={}){return new CustomEvent(h,{detail:i,bubbles:l,cancelable:_})}const Pt=new Map;let It=0;function ji(h){let i=5381,l=h.length;for(;l--;)i=(i<<5)-i^h.charCodeAt(l);return i>>>0}function Ki(h,i){const l={stylesheet:Ui(i),rules:{}};return Pt.set(h,l),l}function ts(h,i,l,_,y,w,C,e=0){const t=16.666/_;let c=`{
`;for(let r=0;r<=1;r+=t){const n=i+(l-i)*w(r);c+=r*100+`%{${C(n,1-n)}}
`}const u=c+`100% {${C(l,1-l)}}
}`,a=`__svelte_${ji(u)}_${e}`,d=Ci(h),{stylesheet:v,rules:m}=Pt.get(d)||Ki(d,h);m[a]||(m[a]=!0,v.insertRule(`@keyframes ${a} ${u}`,v.cssRules.length));const f=h.style.animation||"";return h.style.animation=`${f?`${f}, `:""}${a} ${_}ms linear ${y}ms 1 both`,It+=1,a}function Ht(h,i){const l=(h.style.animation||"").split(", "),_=l.filter(i?w=>w.indexOf(i)<0:w=>w.indexOf("__svelte")===-1),y=l.length-_.length;y&&(h.style.animation=_.join(", "),It-=y,It||Vi())}function Vi(){Qt(()=>{It||(Pt.forEach(h=>{const{ownerNode:i}=h.stylesheet;i&&Q(i)}),Pt.clear())})}function Gi(h,i,l,_){if(!i)return ie;const y=h.getBoundingClientRect();if(i.left===y.left&&i.right===y.right&&i.top===y.top&&i.bottom===y.bottom)return ie;const{delay:w=0,duration:C=300,easing:e=Ut,start:t=Zt()+w,end:c=t+C,tick:u=ie,css:a}=l(h,{from:i,to:y},_);let d=!0,v=!1,m;function f(){a&&(m=ts(h,0,1,C,w,e,a)),w||(v=!0)}function r(){a&&Ht(h,m),d=!1}return es(n=>{if(!v&&n>=t&&(v=!0),v&&n>=c&&(u(1,0),r()),!d)return!1;if(v){const s=n-t,o=0+1*e(s/C);u(o,1-o)}return!0}),f(),u(0,1),r}function Ji(h){const i=getComputedStyle(h);if(i.position!=="absolute"&&i.position!=="fixed"){const{width:l,height:_}=i,y=h.getBoundingClientRect();h.style.position="absolute",h.style.width=l,h.style.height=_,ki(h,y)}}function ki(h,i){const l=h.getBoundingClientRect();if(i.left!==l.left||i.top!==l.top){const _=getComputedStyle(h),y=_.transform==="none"?"":_.transform;h.style.transform=`${y} translate(${i.left-l.left}px, ${i.top-l.top}px)`}}let yt;function Ct(h){yt=h}function ss(){if(!yt)throw new Error("Function called outside component initialization");return yt}function Lt(h){ss().$$.on_mount.push(h)}function Ei(h){ss().$$.on_destroy.push(h)}function pt(){const h=ss();return(i,l,{cancelable:_=!1}={})=>{const y=h.$$.callbacks[i];if(y){const w=yi(i,l,{cancelable:_});return y.slice().forEach(C=>{C.call(h,w)}),!w.defaultPrevented}return!0}}function Li(h,i){const l=h.$$.callbacks[i.type];l&&l.slice().forEach(_=>_.call(this,i))}const ut=[],Ft=[];let ft=[];const Cs=[],Xi=Promise.resolve();let Jt=!1;function Yi(){Jt||(Jt=!0,Xi.then(Di))}function qe(h){ft.push(h)}const Vt=new Set;let lt=0;function Di(){if(lt!==0)return;const h=yt;do{try{for(;lt<ut.length;){const i=ut[lt];lt++,Ct(i),Zi(i.$$)}}catch(i){throw ut.length=0,lt=0,i}for(Ct(null),ut.length=0,lt=0;Ft.length;)Ft.pop()();for(let i=0;i<ft.length;i+=1){const l=ft[i];Vt.has(l)||(Vt.add(l),l())}ft.length=0}while(ut.length);for(;Cs.length;)Cs.pop()();Jt=!1,Vt.clear(),Ct(h)}function Zi(h){if(h.fragment!==null){h.update(),fe(h.before_update);const i=h.dirty;h.dirty=[-1],h.fragment&&h.fragment.p(h.ctx,i),h.after_update.forEach(qe)}}function Qi(h){const i=[],l=[];ft.forEach(_=>h.indexOf(_)===-1?i.push(_):l.push(_)),l.forEach(_=>_()),ft=i}let mt;function Ri(){return mt||(mt=Promise.resolve(),mt.then(()=>{mt=null})),mt}function Wt(h,i,l){h.dispatchEvent(yi(`${i?"intro":"outro"}${l}`))}const Mt=new Set;let Ve;function Ge(){Ve={r:0,c:[],p:Ve}}function Je(){Ve.r||fe(Ve.c),Ve=Ve.p}function ue(h,i){h&&h.i&&(Mt.delete(h),h.i(i))}function pe(h,i,l,_){if(h&&h.o){if(Mt.has(h))return;Mt.add(h),Ve.c.push(()=>{Mt.delete(h),_&&(l&&h.d(1),_())}),h.o(i)}else _&&_()}const Ai={duration:0};function er(h,i,l){const _={direction:"in"};let y=i(h,l,_),w=!1,C,e,t=0;function c(){C&&Ht(h,C)}function u(){const{delay:d=0,duration:v=300,easing:m=Ut,tick:f=ie,css:r}=y||Ai;r&&(C=ts(h,0,1,v,d,m,r,t++)),f(0,1);const n=Zt()+d,s=n+v;e&&e.abort(),w=!0,qe(()=>Wt(h,!0,"start")),e=es(o=>{if(w){if(o>=s)return f(1,0),Wt(h,!0,"end"),c(),w=!1;if(o>=n){const p=m((o-n)/v);f(p,1-p)}}return w})}let a=!1;return{start(){a||(a=!0,Ht(h),_t(y)?(y=y(_),Ri().then(u)):u())},invalidate(){a=!1},end(){w&&(c(),w=!1)}}}function tr(h,i,l){const _={direction:"out"};let y=i(h,l,_),w=!0,C;const e=Ve;e.r+=1;let t;function c(){const{delay:u=0,duration:a=300,easing:d=Ut,tick:v=ie,css:m}=y||Ai;m&&(C=ts(h,1,0,a,u,d,m));const f=Zt()+u,r=f+a;qe(()=>Wt(h,!1,"start")),"inert"in h&&(t=h.inert,h.inert=!0),es(n=>{if(w){if(n>=r)return v(0,1),Wt(h,!1,"end"),--e.r||fe(e.c),!1;if(n>=f){const s=d((n-f)/a);v(1-s,s)}}return w})}return _t(y)?Ri().then(()=>{y=y(_),c()}):c(),{end(u){u&&"inert"in h&&(h.inert=t),u&&y.tick&&y.tick(1,0),w&&(C&&Ht(h,C),w=!1)}}}function Le(h){return(h==null?void 0:h.length)!==void 0?h:Array.from(h)}function Dt(h,i){h.d(1),i.delete(h.key)}function is(h,i){pe(h,1,1,()=>{i.delete(h.key)})}function sr(h,i){h.f(),is(h,i)}function Xe(h,i,l,_,y,w,C,e,t,c,u,a){let d=h.length,v=w.length,m=d;const f={};for(;m--;)f[h[m].key]=m;const r=[],n=new Map,s=new Map,o=[];for(m=v;m--;){const k=a(y,w,m),g=l(k);let L=C.get(g);L?o.push(()=>L.p(k,i)):(L=c(g,k),L.c()),n.set(g,r[m]=L),g in f&&s.set(g,Math.abs(m-f[g]))}const p=new Set,b=new Set;function S(k){ue(k,1),k.m(e,u),C.set(k.key,k),u=k.first,v--}for(;d&&v;){const k=r[v-1],g=h[d-1],L=k.key,R=g.key;k===g?(u=k.first,d--,v--):n.has(R)?!C.has(L)||p.has(L)?S(k):b.has(R)?d--:s.get(L)>s.get(R)?(b.add(L),S(k)):(p.add(R),d--):(t(g,C),d--)}for(;d--;){const k=h[d];n.has(k.key)||t(k,C)}for(;v;)S(r[v-1]);return fe(o),r}function ze(h){h&&h.c()}function xe(h,i,l){const{fragment:_,after_update:y}=h.$$;_&&_.m(i,l),qe(()=>{const w=h.$$.on_mount.map(gi).filter(_t);h.$$.on_destroy?h.$$.on_destroy.push(...w):fe(w),h.$$.on_mount=[]}),y.forEach(qe)}function Oe(h,i){const l=h.$$;l.fragment!==null&&(Qi(l.after_update),fe(l.on_destroy),l.fragment&&l.fragment.d(i),l.on_destroy=l.fragment=null,l.ctx=[])}function ir(h,i){h.$$.dirty[0]===-1&&(ut.push(h),Yi(),h.$$.dirty.fill(0)),h.$$.dirty[i/31|0]|=1<<i%31}function Ne(h,i,l,_,y,w,C=null,e=[-1]){const t=yt;Ct(h);const c=h.$$={fragment:null,ctx:[],props:w,update:ie,not_equal:y,bound:Ss(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(t?t.$$.context:[])),callbacks:Ss(),dirty:e,skip_bound:!1,root:i.target||t.$$.root};C&&C(c.root);let u=!1;if(c.ctx=l?l(h,i.props||{},(a,d,...v)=>{const m=v.length?v[0]:d;return c.ctx&&y(c.ctx[a],c.ctx[a]=m)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](m),u&&ir(h,a)),d}):[],c.update(),u=!0,fe(c.before_update),c.fragment=_?_(c.ctx):!1,i.target){if(i.hydrate){const a=qi(i.target);c.fragment&&c.fragment.l(a),a.forEach(Q)}else c.fragment&&c.fragment.c();i.intro&&ue(h.$$.fragment),xe(h,i.target,i.anchor),Di()}Ct(t)}class Ue{constructor(){jt(this,"$$");jt(this,"$$set")}$destroy(){Oe(this,1),this.$destroy=ie}$on(i,l){if(!_t(l))return ie;const _=this.$$.callbacks[i]||(this.$$.callbacks[i]=[]);return _.push(l),()=>{const y=_.indexOf(l);y!==-1&&_.splice(y,1)}}$set(i){this.$$set&&!Ni(i)&&(this.$$.skip_bound=!0,this.$$set(i),this.$$.skip_bound=!1)}}const rr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rr);const ct=[];function nr(h,i){return{subscribe:Rt(h,i).subscribe}}function Rt(h,i=ie){let l;const _=new Set;function y(e){if(Pe(h,e)&&(h=e,l)){const t=!ct.length;for(const c of _)c[1](),ct.push(c,h);if(t){for(let c=0;c<ct.length;c+=2)ct[c][0](ct[c+1]);ct.length=0}}}function w(e){y(e(h))}function C(e,t=ie){const c=[e,t];return _.add(c),_.size===1&&(l=i(y,w)||ie),e(h),()=>{_.delete(c),_.size===0&&l&&(l(),l=null)}}return{set:y,update:w,subscribe:C}}function ke(h,i,l){const _=!Array.isArray(h),y=_?[h]:h;if(!y.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const w=i.length<2;return nr(l,(C,e)=>{let t=!1;const c=[];let u=0,a=ie;const d=()=>{if(u)return;a();const m=i(_?c[0]:c,C,e);w?C(m):a=_t(m)?m:ie},v=y.map((m,f)=>Yt(m,r=>{c[f]=r,u&=~(1<<f),t&&d()},()=>{u|=1<<f}));return t=!0,d(),function(){fe(v),a(),t=!1}})}const xt={token:null,user:null,isLoading:!1,error:null};function or(){if(typeof window>"u")return xt;try{const h=localStorage.getItem("rexec_token"),i=localStorage.getItem("rexec_user");if(h&&i){const l=JSON.parse(i);return{...xt,token:h,user:l}}}catch(h){console.error("Failed to load persisted auth:",h),localStorage.removeItem("rexec_token"),localStorage.removeItem("rexec_user")}return xt}function ar(){const{subscribe:h,set:i,update:l}=Rt(or());return{subscribe:h,setLoading(_){l(y=>({...y,isLoading:_,error:null}))},setError(_){l(y=>({...y,isLoading:!1,error:_}))},login(_,y){localStorage.setItem("rexec_token",_),localStorage.setItem("rexec_user",JSON.stringify(y)),i({token:_,user:y,isLoading:!1,error:null})},async guestLogin(_){l(y=>({...y,isLoading:!0,error:null}));try{const y=await fetch("/api/auth/guest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,username:`Guest_${Math.floor(Math.random()*1e4)}`})});if(!y.ok){const e=await y.json();throw new Error(e.error||"Guest login failed")}const w=await y.json(),C={id:w.user_id,email:_,name:w.name||"Guest User",tier:"guest",isGuest:!0};return this.login(w.token,C),{success:!0}}catch(y){const w=y instanceof Error?y.message:"Guest login failed";return this.setError(w),{success:!1,error:w}}},async getOAuthUrl(){try{const _=await fetch("/api/auth/oauth/url");if(!_.ok)throw new Error("Failed to get OAuth URL");return(await _.json()).url}catch(_){return console.error("Failed to get OAuth URL:",_),null}},async exchangeOAuthCode(_){l(y=>({...y,isLoading:!0,error:null}));try{const y=await fetch("/api/auth/oauth/exchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:_})});if(!y.ok){const e=await y.json();throw new Error(e.error||"OAuth exchange failed")}const w=await y.json(),C={id:w.user_id,email:w.email||"",name:w.name||w.email||"User",avatar:w.avatar,tier:w.tier||"free",isGuest:!1};return this.login(w.token,C),{success:!0}}catch(y){const w=y instanceof Error?y.message:"OAuth login failed";return this.setError(w),{success:!1,error:w}}},async fetchProfile(){l(_=>({..._,isLoading:!0}));try{const _=localStorage.getItem("rexec_token");if(!_)throw new Error("No token");const y=await fetch("/api/profile",{headers:{Authorization:`Bearer ${_}`}});if(!y.ok)throw y.status===401?(this.logout(),new Error("Session expired")):new Error("Failed to fetch profile");const w=await y.json(),C={id:w.id,email:w.email||"",name:w.name||w.email||"User",avatar:w.avatar,tier:w.tier||"free",isGuest:w.is_guest||!1};return l(e=>({...e,user:C,isLoading:!1,error:null})),localStorage.setItem("rexec_user",JSON.stringify(C)),{success:!0,user:C}}catch(_){const y=_ instanceof Error?_.message:"Failed to fetch profile";return l(w=>({...w,isLoading:!1})),{success:!1,error:y}}},logout(){localStorage.removeItem("rexec_token"),localStorage.removeItem("rexec_user"),i(xt)},async validateToken(){const _=localStorage.getItem("rexec_token");if(!_)return!1;try{return(await fetch("/api/profile",{headers:{Authorization:`Bearer ${_}`}})).ok}catch{return!1}}}}const ye=ar(),Ti=ke(ye,h=>!!h.token),rs=ke(ye,h=>{var i;return((i=h.user)==null?void 0:i.isGuest)??!1});ke(ye,h=>{var i;return((i=h.user)==null?void 0:i.tier)??"guest"});const wt=ke(ye,h=>h.token),ws={containers:[],isLoading:!1,error:null,limit:2,creating:null};function Bi(){return bt(wt)}async function ht(h,i={}){const l=Bi();if(!l)return{error:"Not authenticated",status:401};try{const _=await fetch(h,{...i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`,...i.headers}}),y=await _.json().catch(()=>({}));return _.ok?{data:y,status:_.status}:{error:y.error||`Request failed with status ${_.status}`,status:_.status}}catch(_){return{error:_ instanceof Error?_.message:"Network error",status:0}}}function lr(){const{subscribe:h,set:i,update:l}=Rt(ws);return{subscribe:h,reset(){i(ws)},async fetchContainers(){l(w=>({...w,isLoading:!0,error:null}));const{data:_,error:y}=await ht("/api/containers");return y?(l(w=>({...w,isLoading:!1,error:y})),{success:!1,error:y}):(l(w=>({...w,containers:(_==null?void 0:_.containers)||[],limit:(_==null?void 0:_.limit)||2,isLoading:!1,error:null})),{success:!0,containers:(_==null?void 0:_.containers)||[]})},async getContainer(_){const{data:y,error:w}=await ht(`/api/containers/${_}`);return w?{success:!1,error:w}:(l(C=>({...C,containers:C.containers.map(e=>e.id===_?{...e,...y}:e)})),{success:!0,container:y})},async createContainer(_,y,w){l(u=>({...u,isLoading:!0,error:null}));const C={name:_,image:y};y==="custom"&&w&&(C.custom_image=w);const{data:e,error:t,status:c}=await ht("/api/containers",{method:"POST",body:JSON.stringify(C)});return t?(l(u=>({...u,isLoading:!1,error:t})),{success:!1,error:t,status:c}):(l(u=>({...u,containers:[e,...u.containers],isLoading:!1,error:null})),{success:!0,container:e})},createContainerWithProgress(_,y,w,C,e,t){const c=Bi();if(!c){t==null||t("Not authenticated");return}const u={name:_,image:y};y==="custom"&&w&&(u.custom_image=w),l(a=>({...a,creating:{name:_,image:y,progress:0,message:"Starting...",stage:"initializing"}})),fetch("/api/containers/stream",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(u)}).then(a=>{var f;if(!a.ok)throw l(r=>({...r,creating:null})),new Error("Failed to create container");const d=(f=a.body)==null?void 0:f.getReader(),v=new TextDecoder;function m(){d==null||d.read().then(({done:r,value:n})=>{if(r)return;const o=v.decode(n).split(`
`);for(const p of o)if(p.startsWith("data: "))try{const b=JSON.parse(p.slice(6));if(l(S=>({...S,creating:S.creating?{...S.creating,progress:b.progress||0,message:b.message||"",stage:b.stage||""}:null})),C==null||C(b),b.complete&&b.container_id){const S={id:b.container_id,user_id:"",name:_,image:y,status:"running",created_at:new Date().toISOString()};l(k=>({...k,containers:[S,...k.containers],creating:null})),e==null||e(S)}b.error&&(l(S=>({...S,creating:null})),t==null||t(b.error))}catch{}m()})}m()}).catch(a=>{l(d=>({...d,creating:null})),t==null||t(a instanceof Error?a.message:"Failed to create container")})},async startContainer(_){l(C=>({...C,containers:C.containers.map(e=>e.id===_?{...e,status:"creating"}:e)}));const{data:y,error:w}=await ht(`/api/containers/${_}/start`,{method:"POST"});return w?(l(C=>({...C,containers:C.containers.map(e=>e.id===_?{...e,status:"stopped"}:e)})),{success:!1,error:w}):y!=null&&y.recreated&&y.id!==_?(l(C=>({...C,containers:C.containers.map(e=>e.id===_?{...e,id:y.id,status:"running"}:e)})),{success:!0,newId:y.id,recreated:!0}):(l(C=>({...C,containers:C.containers.map(e=>e.id===_?{...e,status:"running"}:e)})),{success:!0})},async stopContainer(_){l(w=>({...w,containers:w.containers.map(C=>C.id===_?{...C,status:"creating"}:C)}));const{error:y}=await ht(`/api/containers/${_}/stop`,{method:"POST"});return y?(l(w=>({...w,containers:w.containers.map(C=>C.id===_?{...C,status:"running"}:C)})),{success:!1,error:y}):(l(w=>({...w,containers:w.containers.map(C=>C.id===_?{...C,status:"stopped"}:C)})),{success:!0})},async deleteContainer(_){const{error:y}=await ht(`/api/containers/${_}`,{method:"DELETE"});return y?{success:!1,error:y}:(l(w=>({...w,containers:w.containers.filter(C=>C.id!==_)})),{success:!0})},updateStatus(_,y){l(w=>({...w,containers:w.containers.map(C=>C.id===_?{...C,status:y}:C)}))}}}const Ee=lr();ke(Ee,h=>h.containers.filter(i=>i.status==="running"));ke(Ee,h=>h.containers.filter(i=>i.status==="stopped"));ke(Ee,h=>h.containers.length);ke(Ee,h=>h.containers.length>=h.limit);const cr=ke(Ee,h=>h.creating!==null),hr=ke(Ee,h=>h.creating);var Mi={exports:{}};(function(h,i){(function(l,_){h.exports=_()})(globalThis,()=>(()=>{var l={4567:function(C,e,t){var c=this&&this.__decorate||function(s,o,p,b){var S,k=arguments.length,g=k<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,p,b);else for(var L=s.length-1;L>=0;L--)(S=s[L])&&(g=(k<3?S(g):k>3?S(o,p,g):S(o,p))||g);return k>3&&g&&Object.defineProperty(o,p,g),g},u=this&&this.__param||function(s,o){return function(p,b){o(p,b,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibilityManager=void 0;const a=t(9042),d=t(9924),v=t(844),m=t(4725),f=t(2585),r=t(3656);let n=e.AccessibilityManager=class extends v.Disposable{constructor(s,o,p,b){super(),this._terminal=s,this._coreBrowserService=p,this._renderService=b,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let S=0;S<this._terminal.rows;S++)this._rowElements[S]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[S]);if(this._topBoundaryFocusListener=S=>this._handleBoundaryFocus(S,0),this._bottomBoundaryFocusListener=S=>this._handleBoundaryFocus(S,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new d.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(S=>this._handleResize(S.rows))),this.register(this._terminal.onRender(S=>this._refreshRows(S.start,S.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(S=>this._handleChar(S))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(S=>this._handleTab(S))),this.register(this._terminal.onKey(S=>this._handleKey(S.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,r.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,v.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(s){for(let o=0;o<s;o++)this._handleChar(" ")}_handleChar(s){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==s&&(this._charsToAnnounce+=s):this._charsToAnnounce+=s,s===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=a.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(s){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(s)||this._charsToConsume.push(s)}_refreshRows(s,o){this._liveRegionDebouncer.refresh(s,o,this._terminal.rows)}_renderRows(s,o){const p=this._terminal.buffer,b=p.lines.length.toString();for(let S=s;S<=o;S++){const k=p.lines.get(p.ydisp+S),g=[],L=(k==null?void 0:k.translateToString(!0,void 0,void 0,g))||"",R=(p.ydisp+S+1).toString(),x=this._rowElements[S];x&&(L.length===0?(x.innerText="Â ",this._rowColumns.set(x,[0,1])):(x.textContent=L,this._rowColumns.set(x,g)),x.setAttribute("aria-posinset",R),x.setAttribute("aria-setsize",b))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(s,o){const p=s.target,b=this._rowElements[o===0?1:this._rowElements.length-2];if(p.getAttribute("aria-posinset")===(o===0?"1":`${this._terminal.buffer.lines.length}`)||s.relatedTarget!==b)return;let S,k;if(o===0?(S=p,k=this._rowElements.pop(),this._rowContainer.removeChild(k)):(S=this._rowElements.shift(),k=p,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),k.removeEventListener("focus",this._bottomBoundaryFocusListener),o===0){const g=this._createAccessibilityTreeNode();this._rowElements.unshift(g),this._rowContainer.insertAdjacentElement("afterbegin",g)}else{const g=this._createAccessibilityTreeNode();this._rowElements.push(g),this._rowContainer.appendChild(g)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(o===0?-1:1),this._rowElements[o===0?1:this._rowElements.length-2].focus(),s.preventDefault(),s.stopImmediatePropagation()}_handleSelectionChange(){var L;if(this._rowElements.length===0)return;const s=document.getSelection();if(!s)return;if(s.isCollapsed)return void(this._rowContainer.contains(s.anchorNode)&&this._terminal.clearSelection());if(!s.anchorNode||!s.focusNode)return void console.error("anchorNode and/or focusNode are null");let o={node:s.anchorNode,offset:s.anchorOffset},p={node:s.focusNode,offset:s.focusOffset};if((o.node.compareDocumentPosition(p.node)&Node.DOCUMENT_POSITION_PRECEDING||o.node===p.node&&o.offset>p.offset)&&([o,p]=[p,o]),o.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(o={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(o.node))return;const b=this._rowElements.slice(-1)[0];if(p.node.compareDocumentPosition(b)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(p={node:b,offset:((L=b.textContent)==null?void 0:L.length)??0}),!this._rowContainer.contains(p.node))return;const S=({node:R,offset:x})=>{const O=R instanceof Text?R.parentNode:R;let B=parseInt(O==null?void 0:O.getAttribute("aria-posinset"),10)-1;if(isNaN(B))return console.warn("row is invalid. Race condition?"),null;const H=this._rowColumns.get(O);if(!H)return console.warn("columns is null. Race condition?"),null;let N=x<H.length?H[x]:H.slice(-1)[0]+1;return N>=this._terminal.cols&&(++B,N=0),{row:B,column:N}},k=S(o),g=S(p);if(k&&g){if(k.row>g.row||k.row===g.row&&k.column>=g.column)throw new Error("invalid range");this._terminal.select(k.column,k.row,(g.row-k.row)*this._terminal.cols-k.column+g.column)}}_handleResize(s){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let o=this._rowContainer.children.length;o<this._terminal.rows;o++)this._rowElements[o]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[o]);for(;this._rowElements.length>s;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const s=this._coreBrowserService.mainDocument.createElement("div");return s.setAttribute("role","listitem"),s.tabIndex=-1,this._refreshRowDimensions(s),s}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let s=0;s<this._terminal.rows;s++)this._refreshRowDimensions(this._rowElements[s])}}_refreshRowDimensions(s){s.style.height=`${this._renderService.dimensions.css.cell.height}px`}};e.AccessibilityManager=n=c([u(1,f.IInstantiationService),u(2,m.ICoreBrowserService),u(3,m.IRenderService)],n)},3614:(C,e)=>{function t(d){return d.replace(/\r?\n/g,"\r")}function c(d,v){return v?"\x1B[200~"+d+"\x1B[201~":d}function u(d,v,m,f){d=c(d=t(d),m.decPrivateModes.bracketedPasteMode&&f.rawOptions.ignoreBracketedPasteMode!==!0),m.triggerDataEvent(d,!0),v.value=""}function a(d,v,m){const f=m.getBoundingClientRect(),r=d.clientX-f.left-10,n=d.clientY-f.top-10;v.style.width="20px",v.style.height="20px",v.style.left=`${r}px`,v.style.top=`${n}px`,v.style.zIndex="1000",v.focus()}Object.defineProperty(e,"__esModule",{value:!0}),e.rightClickHandler=e.moveTextAreaUnderMouseCursor=e.paste=e.handlePasteEvent=e.copyHandler=e.bracketTextForPaste=e.prepareTextForTerminal=void 0,e.prepareTextForTerminal=t,e.bracketTextForPaste=c,e.copyHandler=function(d,v){d.clipboardData&&d.clipboardData.setData("text/plain",v.selectionText),d.preventDefault()},e.handlePasteEvent=function(d,v,m,f){d.stopPropagation(),d.clipboardData&&u(d.clipboardData.getData("text/plain"),v,m,f)},e.paste=u,e.moveTextAreaUnderMouseCursor=a,e.rightClickHandler=function(d,v,m,f,r){a(d,v,m),r&&f.rightClickSelect(d),v.value=f.selectionText,v.select()}},7239:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorContrastCache=void 0;const c=t(1505);e.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(u,a,d){this._css.set(u,a,d)}getCss(u,a){return this._css.get(u,a)}setColor(u,a,d){this._color.set(u,a,d)}getColor(u,a){return this._color.get(u,a)}clear(){this._color.clear(),this._css.clear()}}},3656:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(t,c,u,a){t.addEventListener(c,u,a);let d=!1;return{dispose:()=>{d||(d=!0,t.removeEventListener(c,u,a))}}}},3551:function(C,e,t){var c=this&&this.__decorate||function(n,s,o,p){var b,S=arguments.length,k=S<3?s:p===null?p=Object.getOwnPropertyDescriptor(s,o):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(n,s,o,p);else for(var g=n.length-1;g>=0;g--)(b=n[g])&&(k=(S<3?b(k):S>3?b(s,o,k):b(s,o))||k);return S>3&&k&&Object.defineProperty(s,o,k),k},u=this&&this.__param||function(n,s){return function(o,p){s(o,p,n)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Linkifier=void 0;const a=t(3656),d=t(8460),v=t(844),m=t(2585),f=t(4725);let r=e.Linkifier=class extends v.Disposable{get currentLink(){return this._currentLink}constructor(n,s,o,p,b){super(),this._element=n,this._mouseService=s,this._renderService=o,this._bufferService=p,this._linkProviderService=b,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,v.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,v.toDisposable)(()=>{var S;this._lastMouseEvent=void 0,(S=this._activeProviderReplies)==null||S.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(n){this._lastMouseEvent=n;const s=this._positionFromMouseEvent(n,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;const o=n.composedPath();for(let p=0;p<o.length;p++){const b=o[p];if(b.classList.contains("xterm"))break;if(b.classList.contains("xterm-hover"))return}this._lastBufferCell&&s.x===this._lastBufferCell.x&&s.y===this._lastBufferCell.y||(this._handleHover(s),this._lastBufferCell=s)}_handleHover(n){if(this._activeLine!==n.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(n,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,n)||(this._clearCurrentLink(),this._askForLink(n,!0))}_askForLink(n,s){var p,b;this._activeProviderReplies&&s||((p=this._activeProviderReplies)==null||p.forEach(S=>{S==null||S.forEach(k=>{k.link.dispose&&k.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=n.y);let o=!1;for(const[S,k]of this._linkProviderService.linkProviders.entries())s?(b=this._activeProviderReplies)!=null&&b.get(S)&&(o=this._checkLinkProviderResult(S,n,o)):k.provideLinks(n.y,g=>{var R,x;if(this._isMouseOut)return;const L=g==null?void 0:g.map(O=>({link:O}));(R=this._activeProviderReplies)==null||R.set(S,L),o=this._checkLinkProviderResult(S,n,o),((x=this._activeProviderReplies)==null?void 0:x.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(n.y,this._activeProviderReplies)})}_removeIntersectingLinks(n,s){const o=new Set;for(let p=0;p<s.size;p++){const b=s.get(p);if(b)for(let S=0;S<b.length;S++){const k=b[S],g=k.link.range.start.y<n?0:k.link.range.start.x,L=k.link.range.end.y>n?this._bufferService.cols:k.link.range.end.x;for(let R=g;R<=L;R++){if(o.has(R)){b.splice(S--,1);break}o.add(R)}}}}_checkLinkProviderResult(n,s,o){var S;if(!this._activeProviderReplies)return o;const p=this._activeProviderReplies.get(n);let b=!1;for(let k=0;k<n;k++)this._activeProviderReplies.has(k)&&!this._activeProviderReplies.get(k)||(b=!0);if(!b&&p){const k=p.find(g=>this._linkAtPosition(g.link,s));k&&(o=!0,this._handleNewLink(k))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!o)for(let k=0;k<this._activeProviderReplies.size;k++){const g=(S=this._activeProviderReplies.get(k))==null?void 0:S.find(L=>this._linkAtPosition(L.link,s));if(g){o=!0,this._handleNewLink(g);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(n){if(!this._currentLink)return;const s=this._positionFromMouseEvent(n,this._element,this._mouseService);s&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(n,this._currentLink.link.text)}_clearCurrentLink(n,s){this._currentLink&&this._lastMouseEvent&&(!n||!s||this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,v.disposeArray)(this._linkCacheDisposables))}_handleNewLink(n){if(!this._lastMouseEvent)return;const s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(n.link,s)&&(this._currentLink=n,this._currentLink.state={decorations:{underline:n.link.decorations===void 0||n.link.decorations.underline,pointerCursor:n.link.decorations===void 0||n.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,n.link,this._lastMouseEvent),n.link.decorations={},Object.defineProperties(n.link.decorations,{pointerCursor:{get:()=>{var o,p;return(p=(o=this._currentLink)==null?void 0:o.state)==null?void 0:p.decorations.pointerCursor},set:o=>{var p;(p=this._currentLink)!=null&&p.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",o))}},underline:{get:()=>{var o,p;return(p=(o=this._currentLink)==null?void 0:o.state)==null?void 0:p.decorations.underline},set:o=>{var p,b,S;(p=this._currentLink)!=null&&p.state&&((S=(b=this._currentLink)==null?void 0:b.state)==null?void 0:S.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(n.link,o))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{if(!this._currentLink)return;const p=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,b=this._bufferService.buffer.ydisp+1+o.end;if(this._currentLink.link.range.start.y>=p&&this._currentLink.link.range.end.y<=b&&(this._clearCurrentLink(p,b),this._lastMouseEvent)){const S=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);S&&this._askForLink(S,!1)}})))}_linkHover(n,s,o){var p;(p=this._currentLink)!=null&&p.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&n.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(o,s.text)}_fireUnderlineEvent(n,s){const o=n.range,p=this._bufferService.buffer.ydisp,b=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-p-1,o.end.x,o.end.y-p-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(b)}_linkLeave(n,s,o){var p;(p=this._currentLink)!=null&&p.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&n.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(o,s.text)}_linkAtPosition(n,s){const o=n.range.start.y*this._bufferService.cols+n.range.start.x,p=n.range.end.y*this._bufferService.cols+n.range.end.x,b=s.y*this._bufferService.cols+s.x;return o<=b&&b<=p}_positionFromMouseEvent(n,s,o){const p=o.getCoords(n,s,this._bufferService.cols,this._bufferService.rows);if(p)return{x:p[0],y:p[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(n,s,o,p,b){return{x1:n,y1:s,x2:o,y2:p,cols:this._bufferService.cols,fg:b}}};e.Linkifier=r=c([u(1,f.IMouseService),u(2,f.IRenderService),u(3,m.IBufferService),u(4,f.ILinkProviderService)],r)},9042:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tooMuchOutput=e.promptLabel=void 0,e.promptLabel="Terminal input",e.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(C,e,t){var c=this&&this.__decorate||function(f,r,n,s){var o,p=arguments.length,b=p<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,n):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(f,r,n,s);else for(var S=f.length-1;S>=0;S--)(o=f[S])&&(b=(p<3?o(b):p>3?o(r,n,b):o(r,n))||b);return p>3&&b&&Object.defineProperty(r,n,b),b},u=this&&this.__param||function(f,r){return function(n,s){r(n,s,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkProvider=void 0;const a=t(511),d=t(2585);let v=e.OscLinkProvider=class{constructor(f,r,n){this._bufferService=f,this._optionsService=r,this._oscLinkService=n}provideLinks(f,r){var L;const n=this._bufferService.buffer.lines.get(f-1);if(!n)return void r(void 0);const s=[],o=this._optionsService.rawOptions.linkHandler,p=new a.CellData,b=n.getTrimmedLength();let S=-1,k=-1,g=!1;for(let R=0;R<b;R++)if(k!==-1||n.hasContent(R)){if(n.loadCell(R,p),p.hasExtendedAttrs()&&p.extended.urlId){if(k===-1){k=R,S=p.extended.urlId;continue}g=p.extended.urlId!==S}else k!==-1&&(g=!0);if(g||k!==-1&&R===b-1){const x=(L=this._oscLinkService.getLinkData(S))==null?void 0:L.uri;if(x){const O={start:{x:k+1,y:f},end:{x:R+(g||R!==b-1?0:1),y:f}};let B=!1;if(!(o!=null&&o.allowNonHttpProtocols))try{const H=new URL(x);["http:","https:"].includes(H.protocol)||(B=!0)}catch{B=!0}B||s.push({text:x,range:O,activate:(H,N)=>o?o.activate(H,N,O):m(0,N),hover:(H,N)=>{var W;return(W=o==null?void 0:o.hover)==null?void 0:W.call(o,H,N,O)},leave:(H,N)=>{var W;return(W=o==null?void 0:o.leave)==null?void 0:W.call(o,H,N,O)}})}g=!1,p.hasExtendedAttrs()&&p.extended.urlId?(k=R,S=p.extended.urlId):(k=-1,S=-1)}}r(s)}};function m(f,r){if(confirm(`Do you want to navigate to ${r}?

WARNING: This link could potentially be dangerous`)){const n=window.open();if(n){try{n.opener=null}catch{}n.location.href=r}else console.warn("Opening link blocked as opener could not be cleared")}}e.OscLinkProvider=v=c([u(0,d.IBufferService),u(1,d.IOptionsService),u(2,d.IOscLinkService)],v)},6193:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderDebouncer=void 0,e.RenderDebouncer=class{constructor(t,c){this._renderCallback=t,this._coreBrowserService=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(t){return this._refreshCallbacks.push(t),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(t,c,u){this._rowCount=u,t=t!==void 0?t:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const t=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const t of this._refreshCallbacks)t(0);this._refreshCallbacks=[]}}},3236:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const c=t(3614),u=t(3656),a=t(3551),d=t(9042),v=t(3730),m=t(1680),f=t(3107),r=t(5744),n=t(2950),s=t(1296),o=t(428),p=t(4269),b=t(5114),S=t(8934),k=t(3230),g=t(9312),L=t(4725),R=t(6731),x=t(8055),O=t(8969),B=t(8460),H=t(844),N=t(6114),W=t(8437),$=t(2584),j=t(7399),D=t(5941),P=t(9074),I=t(2585),F=t(5435),V=t(4567),X=t(779);class Y extends O.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(z={}){super(z),this.browser=N,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new H.MutableDisposable),this._onCursorMove=this.register(new B.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new B.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new B.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new B.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new B.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new B.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new B.EventEmitter),this._onBlur=this.register(new B.EventEmitter),this._onA11yCharEmitter=this.register(new B.EventEmitter),this._onA11yTabEmitter=this.register(new B.EventEmitter),this._onWillOpen=this.register(new B.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(P.DecorationService),this._instantiationService.setService(I.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(X.LinkProviderService),this._instantiationService.setService(L.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(v.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((M,K)=>this.refresh(M,K))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(M=>this._reportWindowsOptions(M))),this.register(this._inputHandler.onColor(M=>this._handleColorEvent(M))),this.register((0,B.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,B.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(M=>this._afterResize(M.cols,M.rows))),this.register((0,H.toDisposable)(()=>{var M,K;this._customKeyEventHandler=void 0,(K=(M=this.element)==null?void 0:M.parentNode)==null||K.removeChild(this.element)}))}_handleColorEvent(z){if(this._themeService)for(const M of z){let K,q="";switch(M.index){case 256:K="foreground",q="10";break;case 257:K="background",q="11";break;case 258:K="cursor",q="12";break;default:K="ansi",q="4;"+M.index}switch(M.type){case 0:const G=x.color.toColorRGB(K==="ansi"?this._themeService.colors.ansi[M.index]:this._themeService.colors[K]);this.coreService.triggerDataEvent(`${$.C0.ESC}]${q};${(0,D.toRgbString)(G)}${$.C1_ESCAPED.ST}`);break;case 1:if(K==="ansi")this._themeService.modifyColors(te=>te.ansi[M.index]=x.channels.toColor(...M.color));else{const te=K;this._themeService.modifyColors(oe=>oe[te]=x.channels.toColor(...M.color))}break;case 2:this._themeService.restoreColor(M.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(z){z?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(z){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent($.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var z;return(z=this.textarea)==null?void 0:z.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent($.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const z=this.buffer.ybase+this.buffer.y,M=this.buffer.lines.get(z);if(!M)return;const K=Math.min(this.buffer.x,this.cols-1),q=this._renderService.dimensions.css.cell.height,G=M.getWidth(K),te=this._renderService.dimensions.css.cell.width*G,oe=this.buffer.y*this._renderService.dimensions.css.cell.height,ce=K*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ce+"px",this.textarea.style.top=oe+"px",this.textarea.style.width=te+"px",this.textarea.style.height=q+"px",this.textarea.style.lineHeight=q+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,u.addDisposableDomListener)(this.element,"copy",M=>{this.hasSelection()&&(0,c.copyHandler)(M,this._selectionService)}));const z=M=>(0,c.handlePasteEvent)(M,this.textarea,this.coreService,this.optionsService);this.register((0,u.addDisposableDomListener)(this.textarea,"paste",z)),this.register((0,u.addDisposableDomListener)(this.element,"paste",z)),N.isFirefox?this.register((0,u.addDisposableDomListener)(this.element,"mousedown",M=>{M.button===2&&(0,c.rightClickHandler)(M,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,u.addDisposableDomListener)(this.element,"contextmenu",M=>{(0,c.rightClickHandler)(M,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),N.isLinux&&this.register((0,u.addDisposableDomListener)(this.element,"auxclick",M=>{M.button===1&&(0,c.moveTextAreaUnderMouseCursor)(M,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,u.addDisposableDomListener)(this.textarea,"keyup",z=>this._keyUp(z),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keydown",z=>this._keyDown(z),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keypress",z=>this._keyPress(z),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionupdate",z=>this._compositionHelper.compositionupdate(z))),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,u.addDisposableDomListener)(this.textarea,"input",z=>this._inputEvent(z),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(z){var K;if(!z)throw new Error("Terminal requires a parent element.");if(z.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((K=this.element)==null?void 0:K.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=z.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),z.appendChild(this.element);const M=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),M.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,u.addDisposableDomListener)(this.screenElement,"mousemove",q=>this.updateCursorStyle(q))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),M.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),N.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,z.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(L.ICoreBrowserService,this._coreBrowserService),this.register((0,u.addDisposableDomListener)(this.textarea,"focus",q=>this._handleTextAreaFocus(q))),this.register((0,u.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(o.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(L.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(R.ThemeService),this._instantiationService.setService(L.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(p.CharacterJoinerService),this._instantiationService.setService(L.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(L.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(q=>this._onRender.fire(q))),this.onResize(q=>this._renderService.resize(q.cols,q.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(n.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(L.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(a.Linkifier,this.screenElement)),this.element.appendChild(M);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(m.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(q=>this.scrollLines(q.amount,q.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(g.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(L.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(q=>this.scrollLines(q.amount,q.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(q=>this._renderService.handleSelectionChanged(q.start,q.end,q.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(q=>{this.textarea.value=q,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(q=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(f.BufferDecorationRenderer,this.screenElement)),this.register((0,u.addDisposableDomListener)(this.element,"mousedown",q=>this._selectionService.handleMouseDown(q))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",q=>this._handleScreenReaderModeOptionChange(q))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",q=>{!this._overviewRulerRenderer&&q&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(s.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const z=this,M=this.element;function K(te){const oe=z._mouseService.getMouseReportCoords(te,z.screenElement);if(!oe)return!1;let ce,ae;switch(te.overrideType||te.type){case"mousemove":ae=32,te.buttons===void 0?(ce=3,te.button!==void 0&&(ce=te.button<3?te.button:3)):ce=1&te.buttons?0:4&te.buttons?1:2&te.buttons?2:3;break;case"mouseup":ae=0,ce=te.button<3?te.button:3;break;case"mousedown":ae=1,ce=te.button<3?te.button:3;break;case"wheel":if(z._customWheelEventHandler&&z._customWheelEventHandler(te)===!1||z.viewport.getLinesScrolled(te)===0)return!1;ae=te.deltaY<0?0:1,ce=4;break;default:return!1}return!(ae===void 0||ce===void 0||ce>4)&&z.coreMouseService.triggerMouseEvent({col:oe.col,row:oe.row,x:oe.x,y:oe.y,button:ce,action:ae,ctrl:te.ctrlKey,alt:te.altKey,shift:te.shiftKey})}const q={mouseup:null,wheel:null,mousedrag:null,mousemove:null},G={mouseup:te=>(K(te),te.buttons||(this._document.removeEventListener("mouseup",q.mouseup),q.mousedrag&&this._document.removeEventListener("mousemove",q.mousedrag)),this.cancel(te)),wheel:te=>(K(te),this.cancel(te,!0)),mousedrag:te=>{te.buttons&&K(te)},mousemove:te=>{te.buttons||K(te)}};this.register(this.coreMouseService.onProtocolChange(te=>{te?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(te)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&te?q.mousemove||(M.addEventListener("mousemove",G.mousemove),q.mousemove=G.mousemove):(M.removeEventListener("mousemove",q.mousemove),q.mousemove=null),16&te?q.wheel||(M.addEventListener("wheel",G.wheel,{passive:!1}),q.wheel=G.wheel):(M.removeEventListener("wheel",q.wheel),q.wheel=null),2&te?q.mouseup||(q.mouseup=G.mouseup):(this._document.removeEventListener("mouseup",q.mouseup),q.mouseup=null),4&te?q.mousedrag||(q.mousedrag=G.mousedrag):(this._document.removeEventListener("mousemove",q.mousedrag),q.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,u.addDisposableDomListener)(M,"mousedown",te=>{if(te.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(te))return K(te),q.mouseup&&this._document.addEventListener("mouseup",q.mouseup),q.mousedrag&&this._document.addEventListener("mousemove",q.mousedrag),this.cancel(te)})),this.register((0,u.addDisposableDomListener)(M,"wheel",te=>{if(!q.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(te)===!1)return!1;if(!this.buffer.hasScrollback){const oe=this.viewport.getLinesScrolled(te);if(oe===0)return;const ce=$.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(te.deltaY<0?"A":"B");let ae="";for(let ve=0;ve<Math.abs(oe);ve++)ae+=ce;return this.coreService.triggerDataEvent(ae,!0),this.cancel(te,!0)}return this.viewport.handleWheel(te)?this.cancel(te):void 0}},{passive:!1})),this.register((0,u.addDisposableDomListener)(M,"touchstart",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(te),this.cancel(te)},{passive:!0})),this.register((0,u.addDisposableDomListener)(M,"touchmove",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(te)?void 0:this.cancel(te)},{passive:!1}))}refresh(z,M){var K;(K=this._renderService)==null||K.refreshRows(z,M)}updateCursorStyle(z){var M;(M=this._selectionService)!=null&&M.shouldColumnSelect(z)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(z,M,K=0){var q;K===1?(super.scrollLines(z,M,K),this.refresh(0,this.rows-1)):(q=this.viewport)==null||q.scrollLines(z)}paste(z){(0,c.paste)(z,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(z){this._customKeyEventHandler=z}attachCustomWheelEventHandler(z){this._customWheelEventHandler=z}registerLinkProvider(z){return this._linkProviderService.registerLinkProvider(z)}registerCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const M=this._characterJoinerService.register(z);return this.refresh(0,this.rows-1),M}deregisterCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(z)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(z){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+z)}registerDecoration(z){return this._decorationService.registerDecoration(z)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(z,M,K){this._selectionService.setSelection(z,M,K)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var z;(z=this._selectionService)==null||z.clearSelection()}selectAll(){var z;(z=this._selectionService)==null||z.selectAll()}selectLines(z,M){var K;(K=this._selectionService)==null||K.selectLines(z,M)}_keyDown(z){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;const M=this.browser.isMac&&this.options.macOptionIsMeta&&z.altKey;if(!M&&!this._compositionHelper.keydown(z))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;M||z.key!=="Dead"&&z.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const K=(0,j.evaluateKeyboardEvent)(z,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(z),K.type===3||K.type===2){const q=this.rows-1;return this.scrollLines(K.type===2?-q:q),this.cancel(z,!0)}return K.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,z)||(K.cancel&&this.cancel(z,!0),!K.key||!!(z.key&&!z.ctrlKey&&!z.altKey&&!z.metaKey&&z.key.length===1&&z.key.charCodeAt(0)>=65&&z.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(K.key!==$.C0.ETX&&K.key!==$.C0.CR||(this.textarea.value=""),this._onKey.fire({key:K.key,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(K.key,!0),!this.optionsService.rawOptions.screenReaderMode||z.altKey||z.ctrlKey?this.cancel(z,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(z,M){const K=z.isMac&&!this.options.macOptionIsMeta&&M.altKey&&!M.ctrlKey&&!M.metaKey||z.isWindows&&M.altKey&&M.ctrlKey&&!M.metaKey||z.isWindows&&M.getModifierState("AltGraph");return M.type==="keypress"?K:K&&(!M.keyCode||M.keyCode>47)}_keyUp(z){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1||(function(M){return M.keyCode===16||M.keyCode===17||M.keyCode===18}(z)||this.focus(),this.updateCursorStyle(z),this._keyPressHandled=!1)}_keyPress(z){let M;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;if(this.cancel(z),z.charCode)M=z.charCode;else if(z.which===null||z.which===void 0)M=z.keyCode;else{if(z.which===0||z.charCode===0)return!1;M=z.which}return!(!M||(z.altKey||z.ctrlKey||z.metaKey)&&!this._isThirdLevelShift(this.browser,z)||(M=String.fromCharCode(M),this._onKey.fire({key:M,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(M,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(z){if(z.data&&z.inputType==="insertText"&&(!z.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const M=z.data;return this.coreService.triggerDataEvent(M,!0),this.cancel(z),!0}return!1}resize(z,M){z!==this.cols||M!==this.rows?super.resize(z,M):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(z,M){var K,q;(K=this._charSizeService)==null||K.measure(),(q=this.viewport)==null||q.syncScrollArea(!0)}clear(){var z;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let M=1;M<this.rows;M++)this.buffer.lines.push(this.buffer.getBlankLine(W.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(z=this.viewport)==null||z.reset(),this.refresh(0,this.rows-1)}}reset(){var M,K;this.options.rows=this.rows,this.options.cols=this.cols;const z=this._customKeyEventHandler;this._setup(),super.reset(),(M=this._selectionService)==null||M.reset(),this._decorationService.reset(),(K=this.viewport)==null||K.reset(),this._customKeyEventHandler=z,this.refresh(0,this.rows-1)}clearTextureAtlas(){var z;(z=this._renderService)==null||z.clearTextureAtlas()}_reportFocus(){var z;(z=this.element)!=null&&z.classList.contains("focus")?this.coreService.triggerDataEvent($.C0.ESC+"[I"):this.coreService.triggerDataEvent($.C0.ESC+"[O")}_reportWindowsOptions(z){if(this._renderService)switch(z){case F.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const M=this._renderService.dimensions.css.canvas.width.toFixed(0),K=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${$.C0.ESC}[4;${K};${M}t`);break;case F.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const q=this._renderService.dimensions.css.cell.width.toFixed(0),G=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${$.C0.ESC}[6;${G};${q}t`)}}cancel(z,M){if(this.options.cancelEvents||M)return z.preventDefault(),z.stopPropagation(),!1}}e.Terminal=Y},9924:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TimeBasedDebouncer=void 0,e.TimeBasedDebouncer=class{constructor(t,c=1e3){this._renderCallback=t,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(t,c,u){this._rowCount=u,t=t!==void 0?t:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const a=Date.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=a-this._lastRefreshMs,v=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},v)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const t=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,c)}}},1680:function(C,e,t){var c=this&&this.__decorate||function(n,s,o,p){var b,S=arguments.length,k=S<3?s:p===null?p=Object.getOwnPropertyDescriptor(s,o):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(n,s,o,p);else for(var g=n.length-1;g>=0;g--)(b=n[g])&&(k=(S<3?b(k):S>3?b(s,o,k):b(s,o))||k);return S>3&&k&&Object.defineProperty(s,o,k),k},u=this&&this.__param||function(n,s){return function(o,p){s(o,p,n)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;const a=t(3656),d=t(4725),v=t(8460),m=t(844),f=t(2585);let r=e.Viewport=class extends m.Disposable{constructor(n,s,o,p,b,S,k,g){super(),this._viewportElement=n,this._scrollArea=s,this._bufferService=o,this._optionsService=p,this._charSizeService=b,this._renderService=S,this._coreBrowserService=k,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(L=>this._renderDimensions=L)),this._handleThemeChange(g.colors),this.register(g.onChangeColors(L=>this._handleThemeChange(L))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(n){this._viewportElement.style.backgroundColor=n.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(n){if(n)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const s=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==s&&(this._lastRecordedBufferHeight=s,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const n=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==n&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=n),this._refreshAnimationFrame=null}syncScrollArea(n=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(n);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(n)}_handleScroll(n){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const s=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:s,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const n=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(n*(this._smoothScrollState.target-this._smoothScrollState.origin)),n<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(n,s){const o=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(s<0&&this._viewportElement.scrollTop!==0||s>0&&o<this._lastRecordedBufferHeight)||(n.cancelable&&n.preventDefault(),!1)}handleWheel(n){const s=this._getPixelsScrolled(n);return s!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+s:this._smoothScrollState.target+=s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=s,this._bubbleScroll(n,s))}scrollLines(n){if(n!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const s=n*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:n,suppressScrollEvent:!1})}_getPixelsScrolled(n){if(n.deltaY===0||n.shiftKey)return 0;let s=this._applyScrollModifier(n.deltaY,n);return n.deltaMode===WheelEvent.DOM_DELTA_LINE?s*=this._currentRowHeight:n.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._currentRowHeight*this._bufferService.rows),s}getBufferElements(n,s){var g;let o,p="";const b=[],S=s??this._bufferService.buffer.lines.length,k=this._bufferService.buffer.lines;for(let L=n;L<S;L++){const R=k.get(L);if(!R)continue;const x=(g=k.get(L+1))==null?void 0:g.isWrapped;if(p+=R.translateToString(!x),!x||L===k.length-1){const O=document.createElement("div");O.textContent=p,b.push(O),p.length>0&&(o=O),p=""}}return{bufferElements:b,cursorElement:o}}getLinesScrolled(n){if(n.deltaY===0||n.shiftKey)return 0;let s=this._applyScrollModifier(n.deltaY,n);return n.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(s/=this._currentRowHeight+0,this._wheelPartialScroll+=s,s=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):n.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._bufferService.rows),s}_applyScrollModifier(n,s){const o=this._optionsService.rawOptions.fastScrollModifier;return o==="alt"&&s.altKey||o==="ctrl"&&s.ctrlKey||o==="shift"&&s.shiftKey?n*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:n*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(n){this._lastTouchY=n.touches[0].pageY}handleTouchMove(n){const s=this._lastTouchY-n.touches[0].pageY;return this._lastTouchY=n.touches[0].pageY,s!==0&&(this._viewportElement.scrollTop+=s,this._bubbleScroll(n,s))}};e.Viewport=r=c([u(2,f.IBufferService),u(3,f.IOptionsService),u(4,d.ICharSizeService),u(5,d.IRenderService),u(6,d.ICoreBrowserService),u(7,d.IThemeService)],r)},3107:function(C,e,t){var c=this&&this.__decorate||function(f,r,n,s){var o,p=arguments.length,b=p<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,n):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(f,r,n,s);else for(var S=f.length-1;S>=0;S--)(o=f[S])&&(b=(p<3?o(b):p>3?o(r,n,b):o(r,n))||b);return p>3&&b&&Object.defineProperty(r,n,b),b},u=this&&this.__param||function(f,r){return function(n,s){r(n,s,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferDecorationRenderer=void 0;const a=t(4725),d=t(844),v=t(2585);let m=e.BufferDecorationRenderer=class extends d.Disposable{constructor(f,r,n,s,o){super(),this._screenElement=f,this._bufferService=r,this._coreBrowserService=n,this._decorationService=s,this._renderService=o,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(p=>this._removeDecoration(p))),this.register((0,d.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const f of this._decorationService.decorations)this._renderDecoration(f);this._dimensionsChanged=!1}_renderDecoration(f){this._refreshStyle(f),this._dimensionsChanged&&this._refreshXPosition(f)}_createElement(f){var s;const r=this._coreBrowserService.mainDocument.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",((s=f==null?void 0:f.options)==null?void 0:s.layer)==="top"),r.style.width=`${Math.round((f.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(f.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(f.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const n=f.options.x??0;return n&&n>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(f,r),r}_refreshStyle(f){const r=f.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)f.element&&(f.element.style.display="none",f.onRenderEmitter.fire(f.element));else{let n=this._decorationElements.get(f);n||(n=this._createElement(f),f.element=n,this._decorationElements.set(f,n),this._container.appendChild(n),f.onDispose(()=>{this._decorationElements.delete(f),n.remove()})),n.style.top=r*this._renderService.dimensions.css.cell.height+"px",n.style.display=this._altBufferIsActive?"none":"block",f.onRenderEmitter.fire(n)}}_refreshXPosition(f,r=f.element){if(!r)return;const n=f.options.x??0;(f.options.anchor||"left")==="right"?r.style.right=n?n*this._renderService.dimensions.css.cell.width+"px":"":r.style.left=n?n*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(f){var r;(r=this._decorationElements.get(f))==null||r.remove(),this._decorationElements.delete(f),f.dispose()}};e.BufferDecorationRenderer=m=c([u(1,v.IBufferService),u(2,a.ICoreBrowserService),u(3,v.IDecorationService),u(4,a.IRenderService)],m)},5871:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorZoneStore=void 0,e.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(t){if(t.options.overviewRulerOptions){for(const c of this._zones)if(c.color===t.options.overviewRulerOptions.color&&c.position===t.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,t.marker.line))return;if(this._lineAdjacentToZone(c,t.marker.line,t.options.overviewRulerOptions.position))return void this._addLineToZone(c,t.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=t.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=t.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=t.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=t.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:t.options.overviewRulerOptions.color,position:t.options.overviewRulerOptions.position,startBufferLine:t.marker.line,endBufferLine:t.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(t){this._linePadding=t}_lineIntersectsZone(t,c){return c>=t.startBufferLine&&c<=t.endBufferLine}_lineAdjacentToZone(t,c,u){return c>=t.startBufferLine-this._linePadding[u||"full"]&&c<=t.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(t,c){t.startBufferLine=Math.min(t.startBufferLine,c),t.endBufferLine=Math.max(t.endBufferLine,c)}}},5744:function(C,e,t){var c=this&&this.__decorate||function(o,p,b,S){var k,g=arguments.length,L=g<3?p:S===null?S=Object.getOwnPropertyDescriptor(p,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(o,p,b,S);else for(var R=o.length-1;R>=0;R--)(k=o[R])&&(L=(g<3?k(L):g>3?k(p,b,L):k(p,b))||L);return g>3&&L&&Object.defineProperty(p,b,L),L},u=this&&this.__param||function(o,p){return function(b,S){p(b,S,o)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OverviewRulerRenderer=void 0;const a=t(5871),d=t(4725),v=t(844),m=t(2585),f={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0},n={full:0,left:0,center:0,right:0};let s=e.OverviewRulerRenderer=class extends v.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(o,p,b,S,k,g,L){var x;super(),this._viewportElement=o,this._screenElement=p,this._bufferService=b,this._decorationService=S,this._renderService=k,this._optionsService=g,this._coreBrowserService=L,this._colorZoneStore=new a.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(x=this._viewportElement.parentElement)==null||x.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var O;(O=this._canvas)==null||O.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const o=Math.floor(this._canvas.width/3),p=Math.ceil(this._canvas.width/3);r.full=this._canvas.width,r.left=o,r.center=p,r.right=o,this._refreshDrawHeightConstants(),n.full=0,n.left=0,n.center=r.left,n.right=r.left+r.center}_refreshDrawHeightConstants(){f.full=Math.round(2*this._coreBrowserService.dpr);const o=this._canvas.height/this._bufferService.buffer.lines.length,p=Math.round(Math.max(Math.min(o,12),6)*this._coreBrowserService.dpr);f.left=p,f.center=p,f.right=p}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const p of this._decorationService.decorations)this._colorZoneStore.addDecoration(p);this._ctx.lineWidth=1;const o=this._colorZoneStore.zones;for(const p of o)p.position!=="full"&&this._renderColorZone(p);for(const p of o)p.position==="full"&&this._renderColorZone(p);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(o){this._ctx.fillStyle=o.color,this._ctx.fillRect(n[o.position||"full"],Math.round((this._canvas.height-1)*(o.startBufferLine/this._bufferService.buffers.active.lines.length)-f[o.position||"full"]/2),r[o.position||"full"],Math.round((this._canvas.height-1)*((o.endBufferLine-o.startBufferLine)/this._bufferService.buffers.active.lines.length)+f[o.position||"full"]))}_queueRefresh(o,p){this._shouldUpdateDimensions=o||this._shouldUpdateDimensions,this._shouldUpdateAnchor=p||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};e.OverviewRulerRenderer=s=c([u(2,m.IBufferService),u(3,m.IDecorationService),u(4,d.IRenderService),u(5,m.IOptionsService),u(6,d.ICoreBrowserService)],s)},2950:function(C,e,t){var c=this&&this.__decorate||function(f,r,n,s){var o,p=arguments.length,b=p<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,n):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(f,r,n,s);else for(var S=f.length-1;S>=0;S--)(o=f[S])&&(b=(p<3?o(b):p>3?o(r,n,b):o(r,n))||b);return p>3&&b&&Object.defineProperty(r,n,b),b},u=this&&this.__param||function(f,r){return function(n,s){r(n,s,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHelper=void 0;const a=t(4725),d=t(2585),v=t(2584);let m=e.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(f,r,n,s,o,p){this._textarea=f,this._compositionView=r,this._bufferService=n,this._optionsService=s,this._coreService=o,this._renderService=p,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(f){this._compositionView.textContent=f.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(f){if(this._isComposing||this._isSendingComposition){if(f.keyCode===229||f.keyCode===16||f.keyCode===17||f.keyCode===18)return!1;this._finalizeComposition(!1)}return f.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(f){if(this._compositionView.classList.remove("active"),this._isComposing=!1,f){const r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let n;this._isSendingComposition=!1,r.start+=this._dataAlreadySent.length,n=this._isComposing?this._textarea.value.substring(r.start,r.end):this._textarea.value.substring(r.start),n.length>0&&this._coreService.triggerDataEvent(n,!0)}},0)}else{this._isSendingComposition=!1;const r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}}_handleAnyTextareaChanges(){const f=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const r=this._textarea.value,n=r.replace(f,"");this._dataAlreadySent=n,r.length>f.length?this._coreService.triggerDataEvent(n,!0):r.length<f.length?this._coreService.triggerDataEvent(`${v.C0.DEL}`,!0):r.length===f.length&&r!==f&&this._coreService.triggerDataEvent(r,!0)}},0)}updateCompositionElements(f){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,o=r*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=o+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=n+"px",this._compositionView.style.lineHeight=n+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const p=this._compositionView.getBoundingClientRect();this._textarea.style.left=o+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(p.width,1)+"px",this._textarea.style.height=Math.max(p.height,1)+"px",this._textarea.style.lineHeight=p.height+"px"}f||setTimeout(()=>this.updateCompositionElements(!0),0)}}};e.CompositionHelper=m=c([u(2,d.IBufferService),u(3,d.IOptionsService),u(4,d.ICoreService),u(5,a.IRenderService)],m)},9806:(C,e)=>{function t(c,u,a){const d=a.getBoundingClientRect(),v=c.getComputedStyle(a),m=parseInt(v.getPropertyValue("padding-left")),f=parseInt(v.getPropertyValue("padding-top"));return[u.clientX-d.left-m,u.clientY-d.top-f]}Object.defineProperty(e,"__esModule",{value:!0}),e.getCoords=e.getCoordsRelativeToElement=void 0,e.getCoordsRelativeToElement=t,e.getCoords=function(c,u,a,d,v,m,f,r,n){if(!m)return;const s=t(c,u,a);return s?(s[0]=Math.ceil((s[0]+(n?f/2:0))/f),s[1]=Math.ceil(s[1]/r),s[0]=Math.min(Math.max(s[0],1),d+(n?1:0)),s[1]=Math.min(Math.max(s[1],1),v),s):void 0}},9504:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.moveToCellSequence=void 0;const c=t(2584);function u(r,n,s,o){const p=r-a(r,s),b=n-a(n,s),S=Math.abs(p-b)-function(k,g,L){let R=0;const x=k-a(k,L),O=g-a(g,L);for(let B=0;B<Math.abs(x-O);B++){const H=d(k,g)==="A"?-1:1,N=L.buffer.lines.get(x+H*B);N!=null&&N.isWrapped&&R++}return R}(r,n,s);return f(S,m(d(r,n),o))}function a(r,n){let s=0,o=n.buffer.lines.get(r),p=o==null?void 0:o.isWrapped;for(;p&&r>=0&&r<n.rows;)s++,o=n.buffer.lines.get(--r),p=o==null?void 0:o.isWrapped;return s}function d(r,n){return r>n?"A":"B"}function v(r,n,s,o,p,b){let S=r,k=n,g="";for(;S!==s||k!==o;)S+=p?1:-1,p&&S>b.cols-1?(g+=b.buffer.translateBufferLineToString(k,!1,r,S),S=0,r=0,k++):!p&&S<0&&(g+=b.buffer.translateBufferLineToString(k,!1,0,r+1),S=b.cols-1,r=S,k--);return g+b.buffer.translateBufferLineToString(k,!1,r,S)}function m(r,n){const s=n?"O":"[";return c.C0.ESC+s+r}function f(r,n){r=Math.floor(r);let s="";for(let o=0;o<r;o++)s+=n;return s}e.moveToCellSequence=function(r,n,s,o){const p=s.buffer.x,b=s.buffer.y;if(!s.buffer.hasScrollback)return function(g,L,R,x,O,B){return u(L,x,O,B).length===0?"":f(v(g,L,g,L-a(L,O),!1,O).length,m("D",B))}(p,b,0,n,s,o)+u(b,n,s,o)+function(g,L,R,x,O,B){let H;H=u(L,x,O,B).length>0?x-a(x,O):L;const N=x,W=function($,j,D,P,I,F){let V;return V=u(D,P,I,F).length>0?P-a(P,I):j,$<D&&V<=P||$>=D&&V<P?"C":"D"}(g,L,R,x,O,B);return f(v(g,H,R,N,W==="C",O).length,m(W,B))}(p,b,r,n,s,o);let S;if(b===n)return S=p>r?"D":"C",f(Math.abs(p-r),m(S,o));S=b>n?"D":"C";const k=Math.abs(b-n);return f(function(g,L){return L.cols-g}(b>n?r:p,s)+(k-1)*s.cols+1+((b>n?p:r)-1),m(S,o))}},1296:function(C,e,t){var c=this&&this.__decorate||function(B,H,N,W){var $,j=arguments.length,D=j<3?H:W===null?W=Object.getOwnPropertyDescriptor(H,N):W;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(B,H,N,W);else for(var P=B.length-1;P>=0;P--)($=B[P])&&(D=(j<3?$(D):j>3?$(H,N,D):$(H,N))||D);return j>3&&D&&Object.defineProperty(H,N,D),D},u=this&&this.__param||function(B,H){return function(N,W){H(N,W,B)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRenderer=void 0;const a=t(3787),d=t(2550),v=t(2223),m=t(6171),f=t(6052),r=t(4725),n=t(8055),s=t(8460),o=t(844),p=t(2585),b="xterm-dom-renderer-owner-",S="xterm-rows",k="xterm-fg-",g="xterm-bg-",L="xterm-focus",R="xterm-selection";let x=1,O=e.DomRenderer=class extends o.Disposable{constructor(B,H,N,W,$,j,D,P,I,F,V,X,Y){super(),this._terminal=B,this._document=H,this._element=N,this._screenElement=W,this._viewportElement=$,this._helperContainer=j,this._linkifier2=D,this._charSizeService=I,this._optionsService=F,this._bufferService=V,this._coreBrowserService=X,this._themeService=Y,this._terminalClass=x++,this._rowElements=[],this._selectionRenderModel=(0,f.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new s.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(S),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(R),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,m.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(J=>this._injectCss(J))),this._injectCss(this._themeService.colors),this._rowFactory=P.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(b+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(J=>this._handleLinkHover(J))),this.register(this._linkifier2.onHideLinkUnderline(J=>this._handleLinkLeave(J))),this.register((0,o.toDisposable)(()=>{this._element.classList.remove(b+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new d.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const B=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*B,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*B),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/B),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/B),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const N of this._rowElements)N.style.width=`${this.dimensions.css.canvas.width}px`,N.style.height=`${this.dimensions.css.cell.height}px`,N.style.lineHeight=`${this.dimensions.css.cell.height}px`,N.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const H=`${this._terminalSelector} .${S} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=H,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(B){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let H=`${this._terminalSelector} .${S} { color: ${B.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;H+=`${this._terminalSelector} .${S} .xterm-dim { color: ${n.color.multiplyOpacity(B.foreground,.5).css};}`,H+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const N=`blink_underline_${this._terminalClass}`,W=`blink_bar_${this._terminalClass}`,$=`blink_block_${this._terminalClass}`;H+=`@keyframes ${N} { 50% {  border-bottom-style: hidden; }}`,H+=`@keyframes ${W} { 50% {  box-shadow: none; }}`,H+=`@keyframes ${$} { 0% {  background-color: ${B.cursor.css};  color: ${B.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${B.cursor.css}; }}`,H+=`${this._terminalSelector} .${S}.${L} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${N} 1s step-end infinite;}${this._terminalSelector} .${S}.${L} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${W} 1s step-end infinite;}${this._terminalSelector} .${S}.${L} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${$} 1s step-end infinite;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block { background-color: ${B.cursor.css}; color: ${B.cursorAccent.css};}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${B.cursor.css} !important; color: ${B.cursorAccent.css} !important;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${B.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${B.cursor.css} inset;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${B.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,H+=`${this._terminalSelector} .${R} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${R} div { position: absolute; background-color: ${B.selectionBackgroundOpaque.css};}${this._terminalSelector} .${R} div { position: absolute; background-color: ${B.selectionInactiveBackgroundOpaque.css};}`;for(const[j,D]of B.ansi.entries())H+=`${this._terminalSelector} .${k}${j} { color: ${D.css}; }${this._terminalSelector} .${k}${j}.xterm-dim { color: ${n.color.multiplyOpacity(D,.5).css}; }${this._terminalSelector} .${g}${j} { background-color: ${D.css}; }`;H+=`${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR} { color: ${n.color.opaque(B.background).css}; }${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${n.color.multiplyOpacity(n.color.opaque(B.background),.5).css}; }${this._terminalSelector} .${g}${v.INVERTED_DEFAULT_COLOR} { background-color: ${B.foreground.css}; }`,this._themeStyleElement.textContent=H}_setDefaultSpacing(){const B=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${B}px`,this._rowFactory.defaultSpacing=B}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(B,H){for(let N=this._rowElements.length;N<=H;N++){const W=this._document.createElement("div");this._rowContainer.appendChild(W),this._rowElements.push(W)}for(;this._rowElements.length>H;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(B,H){this._refreshRowElements(B,H),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(L),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(L),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(B,H,N){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(B,H,N),this.renderRows(0,this._bufferService.rows-1),!B||!H)return;this._selectionRenderModel.update(this._terminal,B,H,N);const W=this._selectionRenderModel.viewportStartRow,$=this._selectionRenderModel.viewportEndRow,j=this._selectionRenderModel.viewportCappedStartRow,D=this._selectionRenderModel.viewportCappedEndRow;if(j>=this._bufferService.rows||D<0)return;const P=this._document.createDocumentFragment();if(N){const I=B[0]>H[0];P.appendChild(this._createSelectionElement(j,I?H[0]:B[0],I?B[0]:H[0],D-j+1))}else{const I=W===j?B[0]:0,F=j===$?H[0]:this._bufferService.cols;P.appendChild(this._createSelectionElement(j,I,F));const V=D-j-1;if(P.appendChild(this._createSelectionElement(j+1,0,this._bufferService.cols,V)),j!==D){const X=$===D?H[0]:this._bufferService.cols;P.appendChild(this._createSelectionElement(D,0,X))}}this._selectionContainer.appendChild(P)}_createSelectionElement(B,H,N,W=1){const $=this._document.createElement("div"),j=H*this.dimensions.css.cell.width;let D=this.dimensions.css.cell.width*(N-H);return j+D>this.dimensions.css.canvas.width&&(D=this.dimensions.css.canvas.width-j),$.style.height=W*this.dimensions.css.cell.height+"px",$.style.top=B*this.dimensions.css.cell.height+"px",$.style.left=`${j}px`,$.style.width=`${D}px`,$}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const B of this._rowElements)B.replaceChildren()}renderRows(B,H){const N=this._bufferService.buffer,W=N.ybase+N.y,$=Math.min(N.x,this._bufferService.cols-1),j=this._optionsService.rawOptions.cursorBlink,D=this._optionsService.rawOptions.cursorStyle,P=this._optionsService.rawOptions.cursorInactiveStyle;for(let I=B;I<=H;I++){const F=I+N.ydisp,V=this._rowElements[I],X=N.lines.get(F);if(!V||!X)break;V.replaceChildren(...this._rowFactory.createRow(X,F,F===W,D,P,$,j,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${b}${this._terminalClass}`}_handleLinkHover(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!0)}_handleLinkLeave(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!1)}_setCellUnderline(B,H,N,W,$,j){N<0&&(B=0),W<0&&(H=0);const D=this._bufferService.rows-1;N=Math.max(Math.min(N,D),0),W=Math.max(Math.min(W,D),0),$=Math.min($,this._bufferService.cols);const P=this._bufferService.buffer,I=P.ybase+P.y,F=Math.min(P.x,$-1),V=this._optionsService.rawOptions.cursorBlink,X=this._optionsService.rawOptions.cursorStyle,Y=this._optionsService.rawOptions.cursorInactiveStyle;for(let J=N;J<=W;++J){const z=J+P.ydisp,M=this._rowElements[J],K=P.lines.get(z);if(!M||!K)break;M.replaceChildren(...this._rowFactory.createRow(K,z,z===I,X,Y,F,V,this.dimensions.css.cell.width,this._widthCache,j?J===N?B:0:-1,j?(J===W?H:$)-1:-1))}}};e.DomRenderer=O=c([u(7,p.IInstantiationService),u(8,r.ICharSizeService),u(9,p.IOptionsService),u(10,p.IBufferService),u(11,r.ICoreBrowserService),u(12,r.IThemeService)],O)},3787:function(C,e,t){var c=this&&this.__decorate||function(S,k,g,L){var R,x=arguments.length,O=x<3?k:L===null?L=Object.getOwnPropertyDescriptor(k,g):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(S,k,g,L);else for(var B=S.length-1;B>=0;B--)(R=S[B])&&(O=(x<3?R(O):x>3?R(k,g,O):R(k,g))||O);return x>3&&O&&Object.defineProperty(k,g,O),O},u=this&&this.__param||function(S,k){return function(g,L){k(g,L,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRendererRowFactory=void 0;const a=t(2223),d=t(643),v=t(511),m=t(2585),f=t(8055),r=t(4725),n=t(4269),s=t(6171),o=t(3734);let p=e.DomRendererRowFactory=class{constructor(S,k,g,L,R,x,O){this._document=S,this._characterJoinerService=k,this._optionsService=g,this._coreBrowserService=L,this._coreService=R,this._decorationService=x,this._themeService=O,this._workCell=new v.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(S,k,g){this._selectionStart=S,this._selectionEnd=k,this._columnSelectMode=g}createRow(S,k,g,L,R,x,O,B,H,N,W){const $=[],j=this._characterJoinerService.getJoinedCharacters(k),D=this._themeService.colors;let P,I=S.getNoBgTrimmedLength();g&&I<x+1&&(I=x+1);let F=0,V="",X=0,Y=0,J=0,z=!1,M=0,K=!1,q=0;const G=[],te=N!==-1&&W!==-1;for(let oe=0;oe<I;oe++){S.loadCell(oe,this._workCell);let ce=this._workCell.getWidth();if(ce===0)continue;let ae=!1,ve=oe,re=this._workCell;if(j.length>0&&oe===j[0][0]){ae=!0;const de=j.shift();re=new n.JoinedCellData(this._workCell,S.translateToString(!0,de[0],de[1]),de[1]-de[0]),ve=de[1]-1,ce=re.getWidth()}const $e=this._isCellInSelection(oe,k),et=g&&oe===x,Ie=te&&oe>=N&&oe<=W;let je=!1;this._decorationService.forEachDecorationAtCell(oe,k,void 0,de=>{je=!0});let Ye=re.getChars()||d.WHITESPACE_CELL_CHAR;if(Ye===" "&&(re.isUnderline()||re.isOverline())&&(Ye="Â "),q=ce*B-H.get(Ye,re.isBold(),re.isItalic()),P){if(F&&($e&&K||!$e&&!K&&re.bg===X)&&($e&&K&&D.selectionForeground||re.fg===Y)&&re.extended.ext===J&&Ie===z&&q===M&&!et&&!ae&&!je){re.isInvisible()?V+=d.WHITESPACE_CELL_CHAR:V+=Ye,F++;continue}F&&(P.textContent=V),P=this._document.createElement("span"),F=0,V=""}else P=this._document.createElement("span");if(X=re.bg,Y=re.fg,J=re.extended.ext,z=Ie,M=q,K=$e,ae&&x>=oe&&x<=ve&&(x=oe),!this._coreService.isCursorHidden&&et&&this._coreService.isCursorInitialized){if(G.push("xterm-cursor"),this._coreBrowserService.isFocused)O&&G.push("xterm-cursor-blink"),G.push(L==="bar"?"xterm-cursor-bar":L==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(R)switch(R){case"outline":G.push("xterm-cursor-outline");break;case"block":G.push("xterm-cursor-block");break;case"bar":G.push("xterm-cursor-bar");break;case"underline":G.push("xterm-cursor-underline")}}if(re.isBold()&&G.push("xterm-bold"),re.isItalic()&&G.push("xterm-italic"),re.isDim()&&G.push("xterm-dim"),V=re.isInvisible()?d.WHITESPACE_CELL_CHAR:re.getChars()||d.WHITESPACE_CELL_CHAR,re.isUnderline()&&(G.push(`xterm-underline-${re.extended.underlineStyle}`),V===" "&&(V="Â "),!re.isUnderlineColorDefault()))if(re.isUnderlineColorRGB())P.style.textDecorationColor=`rgb(${o.AttributeData.toColorRGB(re.getUnderlineColor()).join(",")})`;else{let de=re.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&re.isBold()&&de<8&&(de+=8),P.style.textDecorationColor=D.ansi[de].css}re.isOverline()&&(G.push("xterm-overline"),V===" "&&(V="Â ")),re.isStrikethrough()&&G.push("xterm-strikethrough"),Ie&&(P.style.textDecoration="underline");let Ce=re.getFgColor(),Se=re.getFgColorMode(),we=re.getBgColor(),Te=re.getBgColorMode();const He=!!re.isInverse();if(He){const de=Ce;Ce=we,we=de;const tt=Se;Se=Te,Te=tt}let De,Ze,Re,Fe=!1;switch(this._decorationService.forEachDecorationAtCell(oe,k,void 0,de=>{de.options.layer!=="top"&&Fe||(de.backgroundColorRGB&&(Te=50331648,we=de.backgroundColorRGB.rgba>>8&16777215,De=de.backgroundColorRGB),de.foregroundColorRGB&&(Se=50331648,Ce=de.foregroundColorRGB.rgba>>8&16777215,Ze=de.foregroundColorRGB),Fe=de.options.layer==="top")}),!Fe&&$e&&(De=this._coreBrowserService.isFocused?D.selectionBackgroundOpaque:D.selectionInactiveBackgroundOpaque,we=De.rgba>>8&16777215,Te=50331648,Fe=!0,D.selectionForeground&&(Se=50331648,Ce=D.selectionForeground.rgba>>8&16777215,Ze=D.selectionForeground)),Fe&&G.push("xterm-decoration-top"),Te){case 16777216:case 33554432:Re=D.ansi[we],G.push(`xterm-bg-${we}`);break;case 50331648:Re=f.channels.toColor(we>>16,we>>8&255,255&we),this._addStyle(P,`background-color:#${b((we>>>0).toString(16),"0",6)}`);break;default:He?(Re=D.foreground,G.push(`xterm-bg-${a.INVERTED_DEFAULT_COLOR}`)):Re=D.background}switch(De||re.isDim()&&(De=f.color.multiplyOpacity(Re,.5)),Se){case 16777216:case 33554432:re.isBold()&&Ce<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Ce+=8),this._applyMinimumContrast(P,Re,D.ansi[Ce],re,De,void 0)||G.push(`xterm-fg-${Ce}`);break;case 50331648:const de=f.channels.toColor(Ce>>16&255,Ce>>8&255,255&Ce);this._applyMinimumContrast(P,Re,de,re,De,Ze)||this._addStyle(P,`color:#${b(Ce.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(P,Re,D.foreground,re,De,Ze)||He&&G.push(`xterm-fg-${a.INVERTED_DEFAULT_COLOR}`)}G.length&&(P.className=G.join(" "),G.length=0),et||ae||je?P.textContent=V:F++,q!==this.defaultSpacing&&(P.style.letterSpacing=`${q}px`),$.push(P),oe=ve}return P&&F&&(P.textContent=V),$}_applyMinimumContrast(S,k,g,L,R,x){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.treatGlyphAsBackgroundColor)(L.getCode()))return!1;const O=this._getContrastCache(L);let B;if(R||x||(B=O.getColor(k.rgba,g.rgba)),B===void 0){const H=this._optionsService.rawOptions.minimumContrastRatio/(L.isDim()?2:1);B=f.color.ensureContrastRatio(R||k,x||g,H),O.setColor((R||k).rgba,(x||g).rgba,B??null)}return!!B&&(this._addStyle(S,`color:${B.css}`),!0)}_getContrastCache(S){return S.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(S,k){S.setAttribute("style",`${S.getAttribute("style")||""}${k};`)}_isCellInSelection(S,k){const g=this._selectionStart,L=this._selectionEnd;return!(!g||!L)&&(this._columnSelectMode?g[0]<=L[0]?S>=g[0]&&k>=g[1]&&S<L[0]&&k<=L[1]:S<g[0]&&k>=g[1]&&S>=L[0]&&k<=L[1]:k>g[1]&&k<L[1]||g[1]===L[1]&&k===g[1]&&S>=g[0]&&S<L[0]||g[1]<L[1]&&k===L[1]&&S<L[0]||g[1]<L[1]&&k===g[1]&&S>=g[0])}};function b(S,k,g){for(;S.length<g;)S=k+S;return S}e.DomRendererRowFactory=p=c([u(1,r.ICharacterJoinerService),u(2,m.IOptionsService),u(3,r.ICoreBrowserService),u(4,m.ICoreService),u(5,m.IDecorationService),u(6,r.IThemeService)],p)},2550:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WidthCache=void 0,e.WidthCache=class{constructor(t,c){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const u=t.createElement("span");u.classList.add("xterm-char-measure-element");const a=t.createElement("span");a.classList.add("xterm-char-measure-element"),a.style.fontWeight="bold";const d=t.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontStyle="italic";const v=t.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontWeight="bold",v.style.fontStyle="italic",this._measureElements=[u,a,d,v],this._container.appendChild(u),this._container.appendChild(a),this._container.appendChild(d),this._container.appendChild(v),c.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(t,c,u,a){t===this._font&&c===this._fontSize&&u===this._weight&&a===this._weightBold||(this._font=t,this._fontSize=c,this._weight=u,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${u}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${u}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(t,c,u){let a=0;if(!c&&!u&&t.length===1&&(a=t.charCodeAt(0))<256){if(this._flat[a]!==-9999)return this._flat[a];const m=this._measure(t,0);return m>0&&(this._flat[a]=m),m}let d=t;c&&(d+="B"),u&&(d+="I");let v=this._holey.get(d);if(v===void 0){let m=0;c&&(m|=1),u&&(m|=2),v=this._measure(t,m),v>0&&this._holey.set(d,v)}return v}_measure(t,c){const u=this._measureElements[c];return u.textContent=t.repeat(32),u.offsetWidth/32}}},2223:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;const c=t(6114);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(C,e)=>{function t(u){return 57508<=u&&u<=57558}function c(u){return u>=128512&&u<=128591||u>=127744&&u<=128511||u>=128640&&u<=128767||u>=9728&&u<=9983||u>=9984&&u<=10175||u>=65024&&u<=65039||u>=129280&&u<=129535||u>=127462&&u<=127487}Object.defineProperty(e,"__esModule",{value:!0}),e.computeNextVariantOffset=e.createRenderDimensions=e.treatGlyphAsBackgroundColor=e.allowRescaling=e.isEmoji=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},e.isPowerlineGlyph=t,e.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},e.isEmoji=c,e.allowRescaling=function(u,a,d,v){return a===1&&d>Math.ceil(1.5*v)&&u!==void 0&&u>255&&!c(u)&&!t(u)&&!function(m){return 57344<=m&&m<=63743}(u)},e.treatGlyphAsBackgroundColor=function(u){return t(u)||function(a){return 9472<=a&&a<=9631}(u)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},e.computeNextVariantOffset=function(u,a,d=0){return(u-(2*Math.round(a)-d))%(2*Math.round(a))}},6052:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createSelectionRenderModel=void 0;class t{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(u,a,d,v=!1){if(this.selectionStart=a,this.selectionEnd=d,!a||!d||a[0]===d[0]&&a[1]===d[1])return void this.clear();const m=u.buffers.active.ydisp,f=a[1]-m,r=d[1]-m,n=Math.max(f,0),s=Math.min(r,u.rows-1);n>=u.rows||s<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=v,this.viewportStartRow=f,this.viewportEndRow=r,this.viewportCappedStartRow=n,this.viewportCappedEndRow=s,this.startCol=a[0],this.endCol=d[0])}isCellSelected(u,a,d){return!!this.hasSelection&&(d-=u.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?a>=this.startCol&&d>=this.viewportCappedStartRow&&a<this.endCol&&d<=this.viewportCappedEndRow:a<this.startCol&&d>=this.viewportCappedStartRow&&a>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&a>=this.startCol&&a<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&a<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&a>=this.startCol)}}e.createSelectionRenderModel=function(){return new t}},456:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionModel=void 0,e.SelectionModel=class{constructor(t){this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?t%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)-1]:[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[t,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const t=this.selectionStart,c=this.selectionEnd;return!(!t||!c)&&(t[1]>c[1]||t[1]===c[1]&&t[0]>c[0])}handleTrim(t){return this.selectionStart&&(this.selectionStart[1]-=t),this.selectionEnd&&(this.selectionEnd[1]-=t),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(C,e,t){var c=this&&this.__decorate||function(s,o,p,b){var S,k=arguments.length,g=k<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,p,b);else for(var L=s.length-1;L>=0;L--)(S=s[L])&&(g=(k<3?S(g):k>3?S(o,p,g):S(o,p))||g);return k>3&&g&&Object.defineProperty(o,p,g),g},u=this&&this.__param||function(s,o){return function(p,b){o(p,b,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharSizeService=void 0;const a=t(2585),d=t(8460),v=t(844);let m=e.CharSizeService=class extends v.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(s,o,p){super(),this._optionsService=p,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new n(this._optionsService))}catch{this._measureStrategy=this.register(new r(s,o,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const s=this._measureStrategy.measure();s.width===this.width&&s.height===this.height||(this.width=s.width,this.height=s.height,this._onCharSizeChange.fire())}};e.CharSizeService=m=c([u(2,a.IOptionsService)],m);class f extends v.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(o,p){o!==void 0&&o>0&&p!==void 0&&p>0&&(this._result.width=o,this._result.height=p)}}class r extends f{constructor(o,p,b){super(),this._document=o,this._parentElement=p,this._optionsService=b,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class n extends f{constructor(o){super(),this._optionsService=o,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const p=this._ctx.measureText("W");if(!("width"in p&&"fontBoundingBoxAscent"in p&&"fontBoundingBoxDescent"in p))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const o=this._ctx.measureText("W");return this._validateAndSet(o.width,o.fontBoundingBoxAscent+o.fontBoundingBoxDescent),this._result}}},4269:function(C,e,t){var c=this&&this.__decorate||function(n,s,o,p){var b,S=arguments.length,k=S<3?s:p===null?p=Object.getOwnPropertyDescriptor(s,o):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(n,s,o,p);else for(var g=n.length-1;g>=0;g--)(b=n[g])&&(k=(S<3?b(k):S>3?b(s,o,k):b(s,o))||k);return S>3&&k&&Object.defineProperty(s,o,k),k},u=this&&this.__param||function(n,s){return function(o,p){s(o,p,n)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterJoinerService=e.JoinedCellData=void 0;const a=t(3734),d=t(643),v=t(511),m=t(2585);class f extends a.AttributeData{constructor(s,o,p){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=o,this._width=p}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.JoinedCellData=f;let r=e.CharacterJoinerService=class xi{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new v.CellData}register(s){const o={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(o),o.id}deregister(s){for(let o=0;o<this._characterJoiners.length;o++)if(this._characterJoiners[o].id===s)return this._characterJoiners.splice(o,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const o=this._bufferService.buffer.lines.get(s);if(!o||o.length===0)return[];const p=[],b=o.translateToString(!0);let S=0,k=0,g=0,L=o.getFg(0),R=o.getBg(0);for(let x=0;x<o.getTrimmedLength();x++)if(o.loadCell(x,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==L||this._workCell.bg!==R){if(x-S>1){const O=this._getJoinedRanges(b,g,k,o,S);for(let B=0;B<O.length;B++)p.push(O[B])}S=x,g=k,L=this._workCell.fg,R=this._workCell.bg}k+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-S>1){const x=this._getJoinedRanges(b,g,k,o,S);for(let O=0;O<x.length;O++)p.push(x[O])}return p}_getJoinedRanges(s,o,p,b,S){const k=s.substring(o,p);let g=[];try{g=this._characterJoiners[0].handler(k)}catch(L){console.error(L)}for(let L=1;L<this._characterJoiners.length;L++)try{const R=this._characterJoiners[L].handler(k);for(let x=0;x<R.length;x++)xi._mergeRanges(g,R[x])}catch(R){console.error(R)}return this._stringRangesToCellRanges(g,b,S),g}_stringRangesToCellRanges(s,o,p){let b=0,S=!1,k=0,g=s[b];if(g){for(let L=p;L<this._bufferService.cols;L++){const R=o.getWidth(L),x=o.getString(L).length||d.WHITESPACE_CELL_CHAR.length;if(R!==0){if(!S&&g[0]<=k&&(g[0]=L,S=!0),g[1]<=k){if(g[1]=L,g=s[++b],!g)break;g[0]<=k?(g[0]=L,S=!0):S=!1}k+=x}}g&&(g[1]=this._bufferService.cols)}}static _mergeRanges(s,o){let p=!1;for(let b=0;b<s.length;b++){const S=s[b];if(p){if(o[1]<=S[0])return s[b-1][1]=o[1],s;if(o[1]<=S[1])return s[b-1][1]=Math.max(o[1],S[1]),s.splice(b,1),s;s.splice(b,1),b--}else{if(o[1]<=S[0])return s.splice(b,0,o),s;if(o[1]<=S[1])return S[0]=Math.min(o[0],S[0]),s;o[0]<S[1]&&(S[0]=Math.min(o[0],S[0]),p=!0)}}return p?s[s.length-1][1]=o[1]:s.push(o),s}};e.CharacterJoinerService=r=c([u(0,m.IBufferService)],r)},5114:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreBrowserService=void 0;const c=t(844),u=t(8460),a=t(3656);class d extends c.Disposable{constructor(f,r,n){super(),this._textarea=f,this._window=r,this.mainDocument=n,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new v(this._window),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new u.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(s=>this._screenDprMonitor.setWindow(s))),this.register((0,u.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(f){this._window!==f&&(this._window=f,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}e.CoreBrowserService=d;class v extends c.Disposable{constructor(f){super(),this._parentWindow=f,this._windowResizeListener=this.register(new c.MutableDisposable),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,c.toDisposable)(()=>this.clearListener()))}setWindow(f){this._parentWindow=f,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,a.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var f;this._outerListener&&((f=this._resolutionMediaMatchList)==null||f.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkProviderService=void 0;const c=t(844);class u extends c.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,c.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(d){return this.linkProviders.push(d),{dispose:()=>{const v=this.linkProviders.indexOf(d);v!==-1&&this.linkProviders.splice(v,1)}}}}e.LinkProviderService=u},8934:function(C,e,t){var c=this&&this.__decorate||function(m,f,r,n){var s,o=arguments.length,p=o<3?f:n===null?n=Object.getOwnPropertyDescriptor(f,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(m,f,r,n);else for(var b=m.length-1;b>=0;b--)(s=m[b])&&(p=(o<3?s(p):o>3?s(f,r,p):s(f,r))||p);return o>3&&p&&Object.defineProperty(f,r,p),p},u=this&&this.__param||function(m,f){return function(r,n){f(r,n,m)}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseService=void 0;const a=t(4725),d=t(9806);let v=e.MouseService=class{constructor(m,f){this._renderService=m,this._charSizeService=f}getCoords(m,f,r,n,s){return(0,d.getCoords)(window,m,f,r,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(m,f){const r=(0,d.getCoordsRelativeToElement)(window,m,f);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};e.MouseService=v=c([u(0,a.IRenderService),u(1,a.ICharSizeService)],v)},3230:function(C,e,t){var c=this&&this.__decorate||function(s,o,p,b){var S,k=arguments.length,g=k<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,p,b);else for(var L=s.length-1;L>=0;L--)(S=s[L])&&(g=(k<3?S(g):k>3?S(o,p,g):S(o,p))||g);return k>3&&g&&Object.defineProperty(o,p,g),g},u=this&&this.__param||function(s,o){return function(p,b){o(p,b,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderService=void 0;const a=t(6193),d=t(4725),v=t(8460),m=t(844),f=t(7226),r=t(2585);let n=e.RenderService=class extends m.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(s,o,p,b,S,k,g,L){super(),this._rowCount=s,this._charSizeService=b,this._renderer=this.register(new m.MutableDisposable),this._pausedResizeTask=new f.DebouncedIdleTask,this._observerDisposable=this.register(new m.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new v.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new v.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new v.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new v.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new a.RenderDebouncer((R,x)=>this._renderRows(R,x),g),this.register(this._renderDebouncer),this.register(g.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var R;return(R=this._renderer.value)==null?void 0:R.clear()})),this.register(p.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(p.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(p.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,!0))),this.register(L.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(g.window,o),this.register(g.onWindowChange(R=>this._registerIntersectionObserver(R,o)))}_registerIntersectionObserver(s,o){if("IntersectionObserver"in s){const p=new s.IntersectionObserver(b=>this._handleIntersectionChange(b[b.length-1]),{threshold:0});p.observe(o),this._observerDisposable.value=(0,m.toDisposable)(()=>p.disconnect())}}_handleIntersectionChange(s){this._isPaused=s.isIntersecting===void 0?s.intersectionRatio===0:!s.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(s,o,p=!1){this._isPaused?this._needsFullRefresh=!0:(p||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(s,o,this._rowCount))}_renderRows(s,o){this._renderer.value&&(s=Math.min(s,this._rowCount-1),o=Math.min(o,this._rowCount-1),this._renderer.value.renderRows(s,o),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:s,end:o}),this._onRender.fire({start:s,end:o}),this._isNextRenderRedrawOnly=!0)}resize(s,o){this._rowCount=o,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(s){this._renderer.value=s,this._renderer.value&&(this._renderer.value.onRequestRedraw(o=>this.refreshRows(o.start,o.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(s){return this._renderDebouncer.addRefreshCallback(s)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var s,o;this._renderer.value&&((o=(s=this._renderer.value).clearTextureAtlas)==null||o.call(s),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(s,o){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var p;return(p=this._renderer.value)==null?void 0:p.handleResize(s,o)}):this._renderer.value.handleResize(s,o),this._fullRefresh())}handleCharSizeChanged(){var s;(s=this._renderer.value)==null||s.handleCharSizeChanged()}handleBlur(){var s;(s=this._renderer.value)==null||s.handleBlur()}handleFocus(){var s;(s=this._renderer.value)==null||s.handleFocus()}handleSelectionChanged(s,o,p){var b;this._selectionState.start=s,this._selectionState.end=o,this._selectionState.columnSelectMode=p,(b=this._renderer.value)==null||b.handleSelectionChanged(s,o,p)}handleCursorMove(){var s;(s=this._renderer.value)==null||s.handleCursorMove()}clear(){var s;(s=this._renderer.value)==null||s.clear()}};e.RenderService=n=c([u(2,r.IOptionsService),u(3,d.ICharSizeService),u(4,r.IDecorationService),u(5,r.IBufferService),u(6,d.ICoreBrowserService),u(7,d.IThemeService)],n)},9312:function(C,e,t){var c=this&&this.__decorate||function(g,L,R,x){var O,B=arguments.length,H=B<3?L:x===null?x=Object.getOwnPropertyDescriptor(L,R):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(g,L,R,x);else for(var N=g.length-1;N>=0;N--)(O=g[N])&&(H=(B<3?O(H):B>3?O(L,R,H):O(L,R))||H);return B>3&&H&&Object.defineProperty(L,R,H),H},u=this&&this.__param||function(g,L){return function(R,x){L(R,x,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;const a=t(9806),d=t(9504),v=t(456),m=t(4725),f=t(8460),r=t(844),n=t(6114),s=t(4841),o=t(511),p=t(2585),b="Â ",S=new RegExp(b,"g");let k=e.SelectionService=class extends r.Disposable{constructor(g,L,R,x,O,B,H,N,W){super(),this._element=g,this._screenElement=L,this._linkifier=R,this._bufferService=x,this._coreService=O,this._mouseService=B,this._optionsService=H,this._renderService=N,this._coreBrowserService=W,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new o.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=$=>this._handleMouseMove($),this._mouseUpListener=$=>this._handleMouseUp($),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim($=>this._handleTrim($)),this.register(this._bufferService.buffers.onBufferActivate($=>this._handleBufferActivate($))),this.enable(),this._model=new v.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,r.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const g=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!(!g||!L||g[0]===L[0]&&g[1]===L[1])}get selectionText(){const g=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;if(!g||!L)return"";const R=this._bufferService.buffer,x=[];if(this._activeSelectionMode===3){if(g[0]===L[0])return"";const O=g[0]<L[0]?g[0]:L[0],B=g[0]<L[0]?L[0]:g[0];for(let H=g[1];H<=L[1];H++){const N=R.translateBufferLineToString(H,!0,O,B);x.push(N)}}else{const O=g[1]===L[1]?L[0]:void 0;x.push(R.translateBufferLineToString(g[1],!0,g[0],O));for(let B=g[1]+1;B<=L[1]-1;B++){const H=R.lines.get(B),N=R.translateBufferLineToString(B,!0);H!=null&&H.isWrapped?x[x.length-1]+=N:x.push(N)}if(g[1]!==L[1]){const B=R.lines.get(L[1]),H=R.translateBufferLineToString(L[1],!0,0,L[0]);B&&B.isWrapped?x[x.length-1]+=H:x.push(H)}}return x.map(O=>O.replace(S," ")).join(n.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(g){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),n.isLinux&&g&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(g){const L=this._getMouseBufferCoords(g),R=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!!(R&&x&&L)&&this._areCoordsInSelection(L,R,x)}isCellInSelection(g,L){const R=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!R||!x)&&this._areCoordsInSelection([g,L],R,x)}_areCoordsInSelection(g,L,R){return g[1]>L[1]&&g[1]<R[1]||L[1]===R[1]&&g[1]===L[1]&&g[0]>=L[0]&&g[0]<R[0]||L[1]<R[1]&&g[1]===R[1]&&g[0]<R[0]||L[1]<R[1]&&g[1]===L[1]&&g[0]>=L[0]}_selectWordAtCursor(g,L){var O,B;const R=(B=(O=this._linkifier.currentLink)==null?void 0:O.link)==null?void 0:B.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,s.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const x=this._getMouseBufferCoords(g);return!!x&&(this._selectWordAt(x,L),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(g,L){this._model.clearSelection(),g=Math.max(g,0),L=Math.min(L,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,g],this._model.selectionEnd=[this._bufferService.cols,L],this.refresh(),this._onSelectionChange.fire()}_handleTrim(g){this._model.handleTrim(g)&&this.refresh()}_getMouseBufferCoords(g){const L=this._mouseService.getCoords(g,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(L)return L[0]--,L[1]--,L[1]+=this._bufferService.buffer.ydisp,L}_getMouseEventScrollAmount(g){let L=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,g,this._screenElement)[1];const R=this._renderService.dimensions.css.canvas.height;return L>=0&&L<=R?0:(L>R&&(L-=R),L=Math.min(Math.max(L,-50),50),L/=50,L/Math.abs(L)+Math.round(14*L))}shouldForceSelection(g){return n.isMac?g.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:g.shiftKey}handleMouseDown(g){if(this._mouseDownTimeStamp=g.timeStamp,(g.button!==2||!this.hasSelection)&&g.button===0){if(!this._enabled){if(!this.shouldForceSelection(g))return;g.stopPropagation()}g.preventDefault(),this._dragScrollAmount=0,this._enabled&&g.shiftKey?this._handleIncrementalClick(g):g.detail===1?this._handleSingleClick(g):g.detail===2?this._handleDoubleClick(g):g.detail===3&&this._handleTripleClick(g),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(g){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(g))}_handleSingleClick(g){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(g)?3:0,this._model.selectionStart=this._getMouseBufferCoords(g),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const L=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);L&&L.length!==this._model.selectionStart[0]&&L.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(g){this._selectWordAtCursor(g,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(g){const L=this._getMouseBufferCoords(g);L&&(this._activeSelectionMode=2,this._selectLineAt(L[1]))}shouldColumnSelect(g){return g.altKey&&!(n.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(g){if(g.stopImmediatePropagation(),!this._model.selectionStart)return;const L=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(g),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(g),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const R=this._bufferService.buffer;if(this._model.selectionEnd[1]<R.lines.length){const x=R.lines.get(this._model.selectionEnd[1]);x&&x.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}L&&L[0]===this._model.selectionEnd[0]&&L[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const g=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(g.ydisp+this._bufferService.rows,g.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=g.ydisp),this.refresh()}}_handleMouseUp(g){const L=g.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&L<500&&g.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const R=this._mouseService.getCoords(g,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(R&&R[0]!==void 0&&R[1]!==void 0){const x=(0,d.moveToCellSequence)(R[0]-1,R[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(x,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const g=this._model.finalSelectionStart,L=this._model.finalSelectionEnd,R=!(!g||!L||g[0]===L[0]&&g[1]===L[1]);R?g&&L&&(this._oldSelectionStart&&this._oldSelectionEnd&&g[0]===this._oldSelectionStart[0]&&g[1]===this._oldSelectionStart[1]&&L[0]===this._oldSelectionEnd[0]&&L[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(g,L,R)):this._oldHasSelection&&this._fireOnSelectionChange(g,L,R)}_fireOnSelectionChange(g,L,R){this._oldSelectionStart=g,this._oldSelectionEnd=L,this._oldHasSelection=R,this._onSelectionChange.fire()}_handleBufferActivate(g){this.clearSelection(),this._trimListener.dispose(),this._trimListener=g.activeBuffer.lines.onTrim(L=>this._handleTrim(L))}_convertViewportColToCharacterIndex(g,L){let R=L;for(let x=0;L>=x;x++){const O=g.loadCell(x,this._workCell).getChars().length;this._workCell.getWidth()===0?R--:O>1&&L!==x&&(R+=O-1)}return R}setSelection(g,L,R){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[g,L],this._model.selectionStartLength=R,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(g){this._isClickInSelection(g)||(this._selectWordAtCursor(g,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(g,L,R=!0,x=!0){if(g[0]>=this._bufferService.cols)return;const O=this._bufferService.buffer,B=O.lines.get(g[1]);if(!B)return;const H=O.translateBufferLineToString(g[1],!1);let N=this._convertViewportColToCharacterIndex(B,g[0]),W=N;const $=g[0]-N;let j=0,D=0,P=0,I=0;if(H.charAt(N)===" "){for(;N>0&&H.charAt(N-1)===" ";)N--;for(;W<H.length&&H.charAt(W+1)===" ";)W++}else{let X=g[0],Y=g[0];B.getWidth(X)===0&&(j++,X--),B.getWidth(Y)===2&&(D++,Y++);const J=B.getString(Y).length;for(J>1&&(I+=J-1,W+=J-1);X>0&&N>0&&!this._isCharWordSeparator(B.loadCell(X-1,this._workCell));){B.loadCell(X-1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===0?(j++,X--):z>1&&(P+=z-1,N-=z-1),N--,X--}for(;Y<B.length&&W+1<H.length&&!this._isCharWordSeparator(B.loadCell(Y+1,this._workCell));){B.loadCell(Y+1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===2?(D++,Y++):z>1&&(I+=z-1,W+=z-1),W++,Y++}}W++;let F=N+$-j+P,V=Math.min(this._bufferService.cols,W-N+j+D-P-I);if(L||H.slice(N,W).trim()!==""){if(R&&F===0&&B.getCodePoint(0)!==32){const X=O.lines.get(g[1]-1);if(X&&B.isWrapped&&X.getCodePoint(this._bufferService.cols-1)!==32){const Y=this._getWordAt([this._bufferService.cols-1,g[1]-1],!1,!0,!1);if(Y){const J=this._bufferService.cols-Y.start;F-=J,V+=J}}}if(x&&F+V===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const X=O.lines.get(g[1]+1);if(X!=null&&X.isWrapped&&X.getCodePoint(0)!==32){const Y=this._getWordAt([0,g[1]+1],!1,!1,!0);Y&&(V+=Y.length)}}return{start:F,length:V}}}_selectWordAt(g,L){const R=this._getWordAt(g,L);if(R){for(;R.start<0;)R.start+=this._bufferService.cols,g[1]--;this._model.selectionStart=[R.start,g[1]],this._model.selectionStartLength=R.length}}_selectToWordAt(g){const L=this._getWordAt(g,!0);if(L){let R=g[1];for(;L.start<0;)L.start+=this._bufferService.cols,R--;if(!this._model.areSelectionValuesReversed())for(;L.start+L.length>this._bufferService.cols;)L.length-=this._bufferService.cols,R++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?L.start:L.start+L.length,R]}}_isCharWordSeparator(g){return g.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(g.getChars())>=0}_selectLineAt(g){const L=this._bufferService.buffer.getWrappedRangeForLine(g),R={start:{x:0,y:L.first},end:{x:this._bufferService.cols-1,y:L.last}};this._model.selectionStart=[0,L.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,s.getRangeLength)(R,this._bufferService.cols)}};e.SelectionService=k=c([u(3,p.IBufferService),u(4,p.ICoreService),u(5,m.IMouseService),u(6,p.IOptionsService),u(7,m.IRenderService),u(8,m.ICoreBrowserService)],k)},4725:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ILinkProviderService=e.IThemeService=e.ICharacterJoinerService=e.ISelectionService=e.IRenderService=e.IMouseService=e.ICoreBrowserService=e.ICharSizeService=void 0;const c=t(8343);e.ICharSizeService=(0,c.createDecorator)("CharSizeService"),e.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),e.IMouseService=(0,c.createDecorator)("MouseService"),e.IRenderService=(0,c.createDecorator)("RenderService"),e.ISelectionService=(0,c.createDecorator)("SelectionService"),e.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),e.IThemeService=(0,c.createDecorator)("ThemeService"),e.ILinkProviderService=(0,c.createDecorator)("LinkProviderService")},6731:function(C,e,t){var c=this&&this.__decorate||function(k,g,L,R){var x,O=arguments.length,B=O<3?g:R===null?R=Object.getOwnPropertyDescriptor(g,L):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(k,g,L,R);else for(var H=k.length-1;H>=0;H--)(x=k[H])&&(B=(O<3?x(B):O>3?x(g,L,B):x(g,L))||B);return O>3&&B&&Object.defineProperty(g,L,B),B},u=this&&this.__param||function(k,g){return function(L,R){g(L,R,k)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeService=e.DEFAULT_ANSI_COLORS=void 0;const a=t(7239),d=t(8055),v=t(8460),m=t(844),f=t(2585),r=d.css.toColor("#ffffff"),n=d.css.toColor("#000000"),s=d.css.toColor("#ffffff"),o=d.css.toColor("#000000"),p={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};e.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const k=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],g=[0,95,135,175,215,255];for(let L=0;L<216;L++){const R=g[L/36%6|0],x=g[L/6%6|0],O=g[L%6];k.push({css:d.channels.toCss(R,x,O),rgba:d.channels.toRgba(R,x,O)})}for(let L=0;L<24;L++){const R=8+10*L;k.push({css:d.channels.toCss(R,R,R),rgba:d.channels.toRgba(R,R,R)})}return k})());let b=e.ThemeService=class extends m.Disposable{get colors(){return this._colors}constructor(k){super(),this._optionsService=k,this._contrastCache=new a.ColorContrastCache,this._halfContrastCache=new a.ColorContrastCache,this._onChangeColors=this.register(new v.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:r,background:n,cursor:s,cursorAccent:o,selectionForeground:void 0,selectionBackgroundTransparent:p,selectionBackgroundOpaque:d.color.blend(n,p),selectionInactiveBackgroundTransparent:p,selectionInactiveBackgroundOpaque:d.color.blend(n,p),ansi:e.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(k={}){const g=this._colors;if(g.foreground=S(k.foreground,r),g.background=S(k.background,n),g.cursor=S(k.cursor,s),g.cursorAccent=S(k.cursorAccent,o),g.selectionBackgroundTransparent=S(k.selectionBackground,p),g.selectionBackgroundOpaque=d.color.blend(g.background,g.selectionBackgroundTransparent),g.selectionInactiveBackgroundTransparent=S(k.selectionInactiveBackground,g.selectionBackgroundTransparent),g.selectionInactiveBackgroundOpaque=d.color.blend(g.background,g.selectionInactiveBackgroundTransparent),g.selectionForeground=k.selectionForeground?S(k.selectionForeground,d.NULL_COLOR):void 0,g.selectionForeground===d.NULL_COLOR&&(g.selectionForeground=void 0),d.color.isOpaque(g.selectionBackgroundTransparent)&&(g.selectionBackgroundTransparent=d.color.opacity(g.selectionBackgroundTransparent,.3)),d.color.isOpaque(g.selectionInactiveBackgroundTransparent)&&(g.selectionInactiveBackgroundTransparent=d.color.opacity(g.selectionInactiveBackgroundTransparent,.3)),g.ansi=e.DEFAULT_ANSI_COLORS.slice(),g.ansi[0]=S(k.black,e.DEFAULT_ANSI_COLORS[0]),g.ansi[1]=S(k.red,e.DEFAULT_ANSI_COLORS[1]),g.ansi[2]=S(k.green,e.DEFAULT_ANSI_COLORS[2]),g.ansi[3]=S(k.yellow,e.DEFAULT_ANSI_COLORS[3]),g.ansi[4]=S(k.blue,e.DEFAULT_ANSI_COLORS[4]),g.ansi[5]=S(k.magenta,e.DEFAULT_ANSI_COLORS[5]),g.ansi[6]=S(k.cyan,e.DEFAULT_ANSI_COLORS[6]),g.ansi[7]=S(k.white,e.DEFAULT_ANSI_COLORS[7]),g.ansi[8]=S(k.brightBlack,e.DEFAULT_ANSI_COLORS[8]),g.ansi[9]=S(k.brightRed,e.DEFAULT_ANSI_COLORS[9]),g.ansi[10]=S(k.brightGreen,e.DEFAULT_ANSI_COLORS[10]),g.ansi[11]=S(k.brightYellow,e.DEFAULT_ANSI_COLORS[11]),g.ansi[12]=S(k.brightBlue,e.DEFAULT_ANSI_COLORS[12]),g.ansi[13]=S(k.brightMagenta,e.DEFAULT_ANSI_COLORS[13]),g.ansi[14]=S(k.brightCyan,e.DEFAULT_ANSI_COLORS[14]),g.ansi[15]=S(k.brightWhite,e.DEFAULT_ANSI_COLORS[15]),k.extendedAnsi){const L=Math.min(g.ansi.length-16,k.extendedAnsi.length);for(let R=0;R<L;R++)g.ansi[R+16]=S(k.extendedAnsi[R],e.DEFAULT_ANSI_COLORS[R+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(k){this._restoreColor(k),this._onChangeColors.fire(this.colors)}_restoreColor(k){if(k!==void 0)switch(k){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[k]=this._restoreColors.ansi[k]}else for(let g=0;g<this._restoreColors.ansi.length;++g)this._colors.ansi[g]=this._restoreColors.ansi[g]}modifyColors(k){k(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function S(k,g){if(k!==void 0)try{return d.css.toColor(k)}catch{}return g}e.ThemeService=b=c([u(0,f.IOptionsService)],b)},6349:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularList=void 0;const c=t(8460),u=t(844);class a extends u.Disposable{constructor(v){super(),this._maxLength=v,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(v){if(this._maxLength===v)return;const m=new Array(v);for(let f=0;f<Math.min(v,this.length);f++)m[f]=this._array[this._getCyclicIndex(f)];this._array=m,this._maxLength=v,this._startIndex=0}get length(){return this._length}set length(v){if(v>this._length)for(let m=this._length;m<v;m++)this._array[m]=void 0;this._length=v}get(v){return this._array[this._getCyclicIndex(v)]}set(v,m){this._array[this._getCyclicIndex(v)]=m}push(v){this._array[this._getCyclicIndex(this._length)]=v,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(v,m,...f){if(m){for(let r=v;r<this._length-m;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+m)];this._length-=m,this.onDeleteEmitter.fire({index:v,amount:m})}for(let r=this._length-1;r>=v;r--)this._array[this._getCyclicIndex(r+f.length)]=this._array[this._getCyclicIndex(r)];for(let r=0;r<f.length;r++)this._array[this._getCyclicIndex(v+r)]=f[r];if(f.length&&this.onInsertEmitter.fire({index:v,amount:f.length}),this._length+f.length>this._maxLength){const r=this._length+f.length-this._maxLength;this._startIndex+=r,this._length=this._maxLength,this.onTrimEmitter.fire(r)}else this._length+=f.length}trimStart(v){v>this._length&&(v=this._length),this._startIndex+=v,this._length-=v,this.onTrimEmitter.fire(v)}shiftElements(v,m,f){if(!(m<=0)){if(v<0||v>=this._length)throw new Error("start argument out of range");if(v+f<0)throw new Error("Cannot shift elements in list beyond index 0");if(f>0){for(let n=m-1;n>=0;n--)this.set(v+n+f,this.get(v+n));const r=v+m+f-this._length;if(r>0)for(this._length+=r;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let r=0;r<m;r++)this.set(v+r+f,this.get(v+r))}}_getCyclicIndex(v){return(this._startIndex+v)%this._maxLength}}e.CircularList=a},1439:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function t(c,u=5){if(typeof c!="object")return c;const a=Array.isArray(c)?[]:{};for(const d in c)a[d]=u<=1?c[d]:c[d]&&t(c[d],u-1);return a}},8055:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;let t=0,c=0,u=0,a=0;var d,v,m,f,r;function n(o){const p=o.toString(16);return p.length<2?"0"+p:p}function s(o,p){return o<p?(p+.05)/(o+.05):(o+.05)/(p+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(o){o.toCss=function(p,b,S,k){return k!==void 0?`#${n(p)}${n(b)}${n(S)}${n(k)}`:`#${n(p)}${n(b)}${n(S)}`},o.toRgba=function(p,b,S,k=255){return(p<<24|b<<16|S<<8|k)>>>0},o.toColor=function(p,b,S,k){return{css:o.toCss(p,b,S,k),rgba:o.toRgba(p,b,S,k)}}}(d||(e.channels=d={})),function(o){function p(b,S){return a=Math.round(255*S),[t,c,u]=r.toChannels(b.rgba),{css:d.toCss(t,c,u,a),rgba:d.toRgba(t,c,u,a)}}o.blend=function(b,S){if(a=(255&S.rgba)/255,a===1)return{css:S.css,rgba:S.rgba};const k=S.rgba>>24&255,g=S.rgba>>16&255,L=S.rgba>>8&255,R=b.rgba>>24&255,x=b.rgba>>16&255,O=b.rgba>>8&255;return t=R+Math.round((k-R)*a),c=x+Math.round((g-x)*a),u=O+Math.round((L-O)*a),{css:d.toCss(t,c,u),rgba:d.toRgba(t,c,u)}},o.isOpaque=function(b){return(255&b.rgba)==255},o.ensureContrastRatio=function(b,S,k){const g=r.ensureContrastRatio(b.rgba,S.rgba,k);if(g)return d.toColor(g>>24&255,g>>16&255,g>>8&255)},o.opaque=function(b){const S=(255|b.rgba)>>>0;return[t,c,u]=r.toChannels(S),{css:d.toCss(t,c,u),rgba:S}},o.opacity=p,o.multiplyOpacity=function(b,S){return a=255&b.rgba,p(b,a*S/255)},o.toColorRGB=function(b){return[b.rgba>>24&255,b.rgba>>16&255,b.rgba>>8&255]}}(v||(e.color=v={})),function(o){let p,b;try{const S=document.createElement("canvas");S.width=1,S.height=1;const k=S.getContext("2d",{willReadFrequently:!0});k&&(p=k,p.globalCompositeOperation="copy",b=p.createLinearGradient(0,0,1,1))}catch{}o.toColor=function(S){if(S.match(/#[\da-f]{3,8}/i))switch(S.length){case 4:return t=parseInt(S.slice(1,2).repeat(2),16),c=parseInt(S.slice(2,3).repeat(2),16),u=parseInt(S.slice(3,4).repeat(2),16),d.toColor(t,c,u);case 5:return t=parseInt(S.slice(1,2).repeat(2),16),c=parseInt(S.slice(2,3).repeat(2),16),u=parseInt(S.slice(3,4).repeat(2),16),a=parseInt(S.slice(4,5).repeat(2),16),d.toColor(t,c,u,a);case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}const k=S.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return t=parseInt(k[1]),c=parseInt(k[2]),u=parseInt(k[3]),a=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),d.toColor(t,c,u,a);if(!p||!b)throw new Error("css.toColor: Unsupported css format");if(p.fillStyle=b,p.fillStyle=S,typeof p.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(p.fillRect(0,0,1,1),[t,c,u,a]=p.getImageData(0,0,1,1).data,a!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(t,c,u,a),css:S}}}(m||(e.css=m={})),function(o){function p(b,S,k){const g=b/255,L=S/255,R=k/255;return .2126*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))+.7152*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))+.0722*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))}o.relativeLuminance=function(b){return p(b>>16&255,b>>8&255,255&b)},o.relativeLuminance2=p}(f||(e.rgb=f={})),function(o){function p(S,k,g){const L=S>>24&255,R=S>>16&255,x=S>>8&255;let O=k>>24&255,B=k>>16&255,H=k>>8&255,N=s(f.relativeLuminance2(O,B,H),f.relativeLuminance2(L,R,x));for(;N<g&&(O>0||B>0||H>0);)O-=Math.max(0,Math.ceil(.1*O)),B-=Math.max(0,Math.ceil(.1*B)),H-=Math.max(0,Math.ceil(.1*H)),N=s(f.relativeLuminance2(O,B,H),f.relativeLuminance2(L,R,x));return(O<<24|B<<16|H<<8|255)>>>0}function b(S,k,g){const L=S>>24&255,R=S>>16&255,x=S>>8&255;let O=k>>24&255,B=k>>16&255,H=k>>8&255,N=s(f.relativeLuminance2(O,B,H),f.relativeLuminance2(L,R,x));for(;N<g&&(O<255||B<255||H<255);)O=Math.min(255,O+Math.ceil(.1*(255-O))),B=Math.min(255,B+Math.ceil(.1*(255-B))),H=Math.min(255,H+Math.ceil(.1*(255-H))),N=s(f.relativeLuminance2(O,B,H),f.relativeLuminance2(L,R,x));return(O<<24|B<<16|H<<8|255)>>>0}o.blend=function(S,k){if(a=(255&k)/255,a===1)return k;const g=k>>24&255,L=k>>16&255,R=k>>8&255,x=S>>24&255,O=S>>16&255,B=S>>8&255;return t=x+Math.round((g-x)*a),c=O+Math.round((L-O)*a),u=B+Math.round((R-B)*a),d.toRgba(t,c,u)},o.ensureContrastRatio=function(S,k,g){const L=f.relativeLuminance(S>>8),R=f.relativeLuminance(k>>8);if(s(L,R)<g){if(R<L){const B=p(S,k,g),H=s(L,f.relativeLuminance(B>>8));if(H<g){const N=b(S,k,g);return H>s(L,f.relativeLuminance(N>>8))?B:N}return B}const x=b(S,k,g),O=s(L,f.relativeLuminance(x>>8));if(O<g){const B=p(S,k,g);return O>s(L,f.relativeLuminance(B>>8))?x:B}return x}},o.reduceLuminance=p,o.increaseLuminance=b,o.toChannels=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]}}(r||(e.rgba=r={})),e.toPaddedHex=n,e.contrastRatio=s},8969:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreTerminal=void 0;const c=t(844),u=t(2585),a=t(4348),d=t(7866),v=t(744),m=t(7302),f=t(6975),r=t(8460),n=t(1753),s=t(1480),o=t(7994),p=t(9282),b=t(5435),S=t(5981),k=t(2660);let g=!1;class L extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new r.EventEmitter),this._onScroll.event(x=>{var O;(O=this._onScrollApi)==null||O.fire(x.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(x){for(const O in x)this.optionsService.options[O]=x[O]}constructor(x){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new r.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new r.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new r.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new r.EventEmitter),this._instantiationService=new a.InstantiationService,this.optionsService=this.register(new m.OptionsService(x)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(v.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(f.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(n.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(o.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(k.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,r.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,r.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,r.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,r.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(O=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(O=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new S.WriteBuffer((O,B)=>this._inputHandler.parse(O,B))),this.register((0,r.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(x,O){this._writeBuffer.write(x,O)}writeSync(x,O){this._logService.logLevel<=u.LogLevelEnum.WARN&&!g&&(this._logService.warn("writeSync is unreliable and will be removed soon."),g=!0),this._writeBuffer.writeSync(x,O)}input(x,O=!0){this.coreService.triggerDataEvent(x,O)}resize(x,O){isNaN(x)||isNaN(O)||(x=Math.max(x,v.MINIMUM_COLS),O=Math.max(O,v.MINIMUM_ROWS),this._bufferService.resize(x,O))}scroll(x,O=!1){this._bufferService.scroll(x,O)}scrollLines(x,O,B){this._bufferService.scrollLines(x,O,B)}scrollPages(x){this.scrollLines(x*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(x){const O=x-this._bufferService.buffer.ydisp;O!==0&&this.scrollLines(O)}registerEscHandler(x,O){return this._inputHandler.registerEscHandler(x,O)}registerDcsHandler(x,O){return this._inputHandler.registerDcsHandler(x,O)}registerCsiHandler(x,O){return this._inputHandler.registerCsiHandler(x,O)}registerOscHandler(x,O){return this._inputHandler.registerOscHandler(x,O)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let x=!1;const O=this.optionsService.rawOptions.windowsPty;O&&O.buildNumber!==void 0&&O.buildNumber!==void 0?x=O.backend==="conpty"&&O.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(x=!0),x?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const x=[];x.push(this.onLineFeed(p.updateWindowsModeWrappedState.bind(null,this._bufferService))),x.push(this.registerCsiHandler({final:"H"},()=>((0,p.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const O of x)O.dispose()})}}}e.CoreTerminal=L},8460:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.runAndSubscribe=e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=t=>(this._listeners.push(t),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===t)return void this._listeners.splice(c,1)}}})),this._event}fire(t,c){const u=[];for(let a=0;a<this._listeners.length;a++)u.push(this._listeners[a]);for(let a=0;a<u.length;a++)u[a].call(void 0,t,c)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(t,c){return t(u=>c.fire(u))},e.runAndSubscribe=function(t,c){return c(void 0),t(u=>c(u))}},5435:function(C,e,t){var c=this&&this.__decorate||function(j,D,P,I){var F,V=arguments.length,X=V<3?D:I===null?I=Object.getOwnPropertyDescriptor(D,P):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(j,D,P,I);else for(var Y=j.length-1;Y>=0;Y--)(F=j[Y])&&(X=(V<3?F(X):V>3?F(D,P,X):F(D,P))||X);return V>3&&X&&Object.defineProperty(D,P,X),X},u=this&&this.__param||function(j,D){return function(P,I){D(P,I,j)}};Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.WindowsOptionsReportType=void 0;const a=t(2584),d=t(7116),v=t(2015),m=t(844),f=t(482),r=t(8437),n=t(8460),s=t(643),o=t(511),p=t(3734),b=t(2585),S=t(1480),k=t(6242),g=t(6351),L=t(5941),R={"(":0,")":1,"*":2,"+":3,"-":1,".":2},x=131072;function O(j,D){if(j>24)return D.setWinLines||!1;switch(j){case 1:return!!D.restoreWin;case 2:return!!D.minimizeWin;case 3:return!!D.setWinPosition;case 4:return!!D.setWinSizePixels;case 5:return!!D.raiseWin;case 6:return!!D.lowerWin;case 7:return!!D.refreshWin;case 8:return!!D.setWinSizeChars;case 9:return!!D.maximizeWin;case 10:return!!D.fullscreenWin;case 11:return!!D.getWinState;case 13:return!!D.getWinPosition;case 14:return!!D.getWinSizePixels;case 15:return!!D.getScreenSizePixels;case 16:return!!D.getCellSizePixels;case 18:return!!D.getWinSizeChars;case 19:return!!D.getScreenSizeChars;case 20:return!!D.getIconTitle;case 21:return!!D.getWinTitle;case 22:return!!D.pushTitle;case 23:return!!D.popTitle;case 24:return!!D.setWinLines}return!1}var B;(function(j){j[j.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",j[j.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(B||(e.WindowsOptionsReportType=B={}));let H=0;class N extends m.Disposable{getAttrData(){return this._curAttrData}constructor(D,P,I,F,V,X,Y,J,z=new v.EscapeSequenceParser){super(),this._bufferService=D,this._charsetService=P,this._coreService=I,this._logService=F,this._optionsService=V,this._oscLinkService=X,this._coreMouseService=Y,this._unicodeService=J,this._parser=z,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new f.StringToUtf32,this._utf8Decoder=new f.Utf8ToUtf32,this._workCell=new o.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new n.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new n.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new n.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new n.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new n.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new n.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new n.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new n.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new n.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new n.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new n.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new n.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new W(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(M=>this._activeBuffer=M.activeBuffer)),this._parser.setCsiHandlerFallback((M,K)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(M),params:K.toArray()})}),this._parser.setEscHandlerFallback(M=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(M)})}),this._parser.setExecuteHandlerFallback(M=>{this._logService.debug("Unknown EXECUTE code: ",{code:M})}),this._parser.setOscHandlerFallback((M,K,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:M,action:K,data:q})}),this._parser.setDcsHandlerFallback((M,K,q)=>{K==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(M),action:K,payload:q})}),this._parser.setPrintHandler((M,K,q)=>this.print(M,K,q)),this._parser.registerCsiHandler({final:"@"},M=>this.insertChars(M)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},M=>this.scrollLeft(M)),this._parser.registerCsiHandler({final:"A"},M=>this.cursorUp(M)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},M=>this.scrollRight(M)),this._parser.registerCsiHandler({final:"B"},M=>this.cursorDown(M)),this._parser.registerCsiHandler({final:"C"},M=>this.cursorForward(M)),this._parser.registerCsiHandler({final:"D"},M=>this.cursorBackward(M)),this._parser.registerCsiHandler({final:"E"},M=>this.cursorNextLine(M)),this._parser.registerCsiHandler({final:"F"},M=>this.cursorPrecedingLine(M)),this._parser.registerCsiHandler({final:"G"},M=>this.cursorCharAbsolute(M)),this._parser.registerCsiHandler({final:"H"},M=>this.cursorPosition(M)),this._parser.registerCsiHandler({final:"I"},M=>this.cursorForwardTab(M)),this._parser.registerCsiHandler({final:"J"},M=>this.eraseInDisplay(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},M=>this.eraseInDisplay(M,!0)),this._parser.registerCsiHandler({final:"K"},M=>this.eraseInLine(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},M=>this.eraseInLine(M,!0)),this._parser.registerCsiHandler({final:"L"},M=>this.insertLines(M)),this._parser.registerCsiHandler({final:"M"},M=>this.deleteLines(M)),this._parser.registerCsiHandler({final:"P"},M=>this.deleteChars(M)),this._parser.registerCsiHandler({final:"S"},M=>this.scrollUp(M)),this._parser.registerCsiHandler({final:"T"},M=>this.scrollDown(M)),this._parser.registerCsiHandler({final:"X"},M=>this.eraseChars(M)),this._parser.registerCsiHandler({final:"Z"},M=>this.cursorBackwardTab(M)),this._parser.registerCsiHandler({final:"`"},M=>this.charPosAbsolute(M)),this._parser.registerCsiHandler({final:"a"},M=>this.hPositionRelative(M)),this._parser.registerCsiHandler({final:"b"},M=>this.repeatPrecedingCharacter(M)),this._parser.registerCsiHandler({final:"c"},M=>this.sendDeviceAttributesPrimary(M)),this._parser.registerCsiHandler({prefix:">",final:"c"},M=>this.sendDeviceAttributesSecondary(M)),this._parser.registerCsiHandler({final:"d"},M=>this.linePosAbsolute(M)),this._parser.registerCsiHandler({final:"e"},M=>this.vPositionRelative(M)),this._parser.registerCsiHandler({final:"f"},M=>this.hVPosition(M)),this._parser.registerCsiHandler({final:"g"},M=>this.tabClear(M)),this._parser.registerCsiHandler({final:"h"},M=>this.setMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"h"},M=>this.setModePrivate(M)),this._parser.registerCsiHandler({final:"l"},M=>this.resetMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"l"},M=>this.resetModePrivate(M)),this._parser.registerCsiHandler({final:"m"},M=>this.charAttributes(M)),this._parser.registerCsiHandler({final:"n"},M=>this.deviceStatus(M)),this._parser.registerCsiHandler({prefix:"?",final:"n"},M=>this.deviceStatusPrivate(M)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},M=>this.softReset(M)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},M=>this.setCursorStyle(M)),this._parser.registerCsiHandler({final:"r"},M=>this.setScrollRegion(M)),this._parser.registerCsiHandler({final:"s"},M=>this.saveCursor(M)),this._parser.registerCsiHandler({final:"t"},M=>this.windowOptions(M)),this._parser.registerCsiHandler({final:"u"},M=>this.restoreCursor(M)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},M=>this.insertColumns(M)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},M=>this.deleteColumns(M)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},M=>this.selectProtected(M)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},M=>this.requestMode(M,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},M=>this.requestMode(M,!1)),this._parser.setExecuteHandler(a.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(a.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(a.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(a.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(a.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(a.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(a.C1.IND,()=>this.index()),this._parser.setExecuteHandler(a.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(a.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new k.OscHandler(M=>(this.setTitle(M),this.setIconName(M),!0))),this._parser.registerOscHandler(1,new k.OscHandler(M=>this.setIconName(M))),this._parser.registerOscHandler(2,new k.OscHandler(M=>this.setTitle(M))),this._parser.registerOscHandler(4,new k.OscHandler(M=>this.setOrReportIndexedColor(M))),this._parser.registerOscHandler(8,new k.OscHandler(M=>this.setHyperlink(M))),this._parser.registerOscHandler(10,new k.OscHandler(M=>this.setOrReportFgColor(M))),this._parser.registerOscHandler(11,new k.OscHandler(M=>this.setOrReportBgColor(M))),this._parser.registerOscHandler(12,new k.OscHandler(M=>this.setOrReportCursorColor(M))),this._parser.registerOscHandler(104,new k.OscHandler(M=>this.restoreIndexedColor(M))),this._parser.registerOscHandler(110,new k.OscHandler(M=>this.restoreFgColor(M))),this._parser.registerOscHandler(111,new k.OscHandler(M=>this.restoreBgColor(M))),this._parser.registerOscHandler(112,new k.OscHandler(M=>this.restoreCursorColor(M))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const M in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:M},()=>this.selectCharset("("+M)),this._parser.registerEscHandler({intermediates:")",final:M},()=>this.selectCharset(")"+M)),this._parser.registerEscHandler({intermediates:"*",final:M},()=>this.selectCharset("*"+M)),this._parser.registerEscHandler({intermediates:"+",final:M},()=>this.selectCharset("+"+M)),this._parser.registerEscHandler({intermediates:"-",final:M},()=>this.selectCharset("-"+M)),this._parser.registerEscHandler({intermediates:".",final:M},()=>this.selectCharset("."+M)),this._parser.registerEscHandler({intermediates:"/",final:M},()=>this.selectCharset("/"+M));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(M=>(this._logService.error("Parsing error: ",M),M)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new g.DcsHandler((M,K)=>this.requestStatusString(M,K)))}_preserveStack(D,P,I,F){this._parseStack.paused=!0,this._parseStack.cursorStartX=D,this._parseStack.cursorStartY=P,this._parseStack.decodedLength=I,this._parseStack.position=F}_logSlowResolvingAsync(D){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([D,new Promise((P,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(P=>{if(P!=="#SLOW_TIMEOUT")throw P;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(D,P){let I,F=this._activeBuffer.x,V=this._activeBuffer.y,X=0;const Y=this._parseStack.paused;if(Y){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,P))return this._logSlowResolvingAsync(I),I;F=this._parseStack.cursorStartX,V=this._parseStack.cursorStartY,this._parseStack.paused=!1,D.length>x&&(X=this._parseStack.position+x)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof D=="string"?` "${D}"`:` "${Array.prototype.map.call(D,M=>String.fromCharCode(M)).join("")}"`),typeof D=="string"?D.split("").map(M=>M.charCodeAt(0)):D),this._parseBuffer.length<D.length&&this._parseBuffer.length<x&&(this._parseBuffer=new Uint32Array(Math.min(D.length,x))),Y||this._dirtyRowTracker.clearRange(),D.length>x)for(let M=X;M<D.length;M+=x){const K=M+x<D.length?M+x:D.length,q=typeof D=="string"?this._stringDecoder.decode(D.substring(M,K),this._parseBuffer):this._utf8Decoder.decode(D.subarray(M,K),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,q))return this._preserveStack(F,V,q,M),this._logSlowResolvingAsync(I),I}else if(!Y){const M=typeof D=="string"?this._stringDecoder.decode(D,this._parseBuffer):this._utf8Decoder.decode(D,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,M))return this._preserveStack(F,V,M,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===F&&this._activeBuffer.y===V||this._onCursorMove.fire();const J=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),z=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);z<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(z,this._bufferService.rows-1),Math.min(J,this._bufferService.rows-1))}print(D,P,I){let F,V;const X=this._charsetService.charset,Y=this._optionsService.rawOptions.screenReaderMode,J=this._bufferService.cols,z=this._coreService.decPrivateModes.wraparound,M=this._coreService.modes.insertMode,K=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-P>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodepoint(this._activeBuffer.x-1,0,1,K);let G=this._parser.precedingJoinState;for(let te=P;te<I;++te){if(F=D[te],F<127&&X){const ve=X[String.fromCharCode(F)];ve&&(F=ve.charCodeAt(0))}const oe=this._unicodeService.charProperties(F,G);V=S.UnicodeService.extractWidth(oe);const ce=S.UnicodeService.extractShouldJoin(oe),ae=ce?S.UnicodeService.extractWidth(G):0;if(G=oe,Y&&this._onA11yChar.fire((0,f.stringFromCodePoint)(F)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+V-ae>J){if(z){const ve=q;let re=this._activeBuffer.x-ae;for(this._activeBuffer.x=ae,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ae>0&&q instanceof r.BufferLine&&q.copyCellsFrom(ve,re,0,ae,!1);re<J;)ve.setCellFromCodepoint(re++,0,1,K)}else if(this._activeBuffer.x=J-1,V===2)continue}if(ce&&this._activeBuffer.x){const ve=q.getWidth(this._activeBuffer.x-1)?1:2;q.addCodepointToCell(this._activeBuffer.x-ve,F,V);for(let re=V-ae;--re>=0;)q.setCellFromCodepoint(this._activeBuffer.x++,0,0,K)}else if(M&&(q.insertCells(this._activeBuffer.x,V-ae,this._activeBuffer.getNullCell(K)),q.getWidth(J-1)===2&&q.setCellFromCodepoint(J-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,K)),q.setCellFromCodepoint(this._activeBuffer.x++,F,V,K),V>0)for(;--V;)q.setCellFromCodepoint(this._activeBuffer.x++,0,0,K)}this._parser.precedingJoinState=G,this._activeBuffer.x<J&&I-P>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodepoint(this._activeBuffer.x,0,1,K),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(D,P){return D.final!=="t"||D.prefix||D.intermediates?this._parser.registerCsiHandler(D,P):this._parser.registerCsiHandler(D,I=>!O(I.params[0],this._optionsService.rawOptions.windowOptions)||P(I))}registerDcsHandler(D,P){return this._parser.registerDcsHandler(D,new g.DcsHandler(P))}registerEscHandler(D,P){return this._parser.registerEscHandler(D,P)}registerOscHandler(D,P){return this._parser.registerOscHandler(D,new k.OscHandler(P))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var D;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&D.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);P.hasWidth(this._activeBuffer.x)&&!P.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const D=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-D),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(D=this._bufferService.cols-1){this._activeBuffer.x=Math.min(D,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(D,P){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=D,this._activeBuffer.y=this._activeBuffer.scrollTop+P):(this._activeBuffer.x=D,this._activeBuffer.y=P),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(D,P){this._restrictCursor(),this._setCursor(this._activeBuffer.x+D,this._activeBuffer.y+P)}cursorUp(D){const P=this._activeBuffer.y-this._activeBuffer.scrollTop;return P>=0?this._moveCursor(0,-Math.min(P,D.params[0]||1)):this._moveCursor(0,-(D.params[0]||1)),!0}cursorDown(D){const P=this._activeBuffer.scrollBottom-this._activeBuffer.y;return P>=0?this._moveCursor(0,Math.min(P,D.params[0]||1)):this._moveCursor(0,D.params[0]||1),!0}cursorForward(D){return this._moveCursor(D.params[0]||1,0),!0}cursorBackward(D){return this._moveCursor(-(D.params[0]||1),0),!0}cursorNextLine(D){return this.cursorDown(D),this._activeBuffer.x=0,!0}cursorPrecedingLine(D){return this.cursorUp(D),this._activeBuffer.x=0,!0}cursorCharAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(D){return this._setCursor(D.length>=2?(D.params[1]||1)-1:0,(D.params[0]||1)-1),!0}charPosAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(D){return this._moveCursor(D.params[0]||1,0),!0}linePosAbsolute(D){return this._setCursor(this._activeBuffer.x,(D.params[0]||1)-1),!0}vPositionRelative(D){return this._moveCursor(0,D.params[0]||1),!0}hVPosition(D){return this.cursorPosition(D),!0}tabClear(D){const P=D.params[0];return P===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:P===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let P=D.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let P=D.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(D){const P=D.params[0];return P===1&&(this._curAttrData.bg|=536870912),P!==2&&P!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(D,P,I,F=!1,V=!1){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);X.replaceCells(P,I,this._activeBuffer.getNullCell(this._eraseAttrData()),V),F&&(X.isWrapped=!1)}_resetBufferLine(D,P=!1){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I&&(I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),P),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+D),I.isWrapped=!1)}eraseInDisplay(D,P=!1){let I;switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);I<this._bufferService.rows;I++)this._resetBufferLine(I,P);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,P),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,P);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,P);this._dirtyRowTracker.markDirty(0);break;case 3:const F=this._activeBuffer.lines.length-this._bufferService.rows;F>0&&(this._activeBuffer.lines.trimStart(F),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-F,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-F,0),this._onScroll.fire(0))}return!0}eraseInLine(D,P=!1){switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,P);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,P)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(D){this._restrictCursor();let P=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y,F=this._bufferService.rows-1-this._activeBuffer.scrollBottom,V=this._bufferService.rows-1+this._activeBuffer.ybase-F+1;for(;P--;)this._activeBuffer.lines.splice(V-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(D){this._restrictCursor();let P=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y;let F;for(F=this._bufferService.rows-1-this._activeBuffer.scrollBottom,F=this._bufferService.rows-1+this._activeBuffer.ybase-F;P--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(F,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.insertCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.deleteCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(D){let P=D.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(D){let P=D.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(r.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);F.deleteCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);F.insertCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);F.insertCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);F.deleteCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(D.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(D){const P=this._parser.precedingJoinState;if(!P)return!0;const I=D.params[0]||1,F=S.UnicodeService.extractWidth(P),V=this._activeBuffer.x-F,X=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(V),Y=new Uint32Array(X.length*I);let J=0;for(let M=0;M<X.length;){const K=X.codePointAt(M)||0;Y[J++]=K,M+=K>65535?2:1}let z=J;for(let M=1;M<I;++M)Y.copyWithin(z,0,J),z+=J;return this.print(Y,0,z),!0}sendDeviceAttributesPrimary(D){return D.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(a.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(a.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(D){return D.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(a.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(a.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(D.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(a.C0.ESC+"[>83;40003;0c")),!0}_is(D){return(this._optionsService.rawOptions.termName+"").indexOf(D)===0}setMode(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),D.params[P]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(D,P){const I=this._coreService.decPrivateModes,{activeProtocol:F,activeEncoding:V}=this._coreMouseService,X=this._coreService,{buffers:Y,cols:J}=this._bufferService,{active:z,alt:M}=Y,K=this._optionsService.rawOptions,q=ce=>ce?1:2,G=D.params[0];return te=G,oe=P?G===2?4:G===4?q(X.modes.insertMode):G===12?3:G===20?q(K.convertEol):0:G===1?q(I.applicationCursorKeys):G===3?K.windowOptions.setWinLines?J===80?2:J===132?1:0:0:G===6?q(I.origin):G===7?q(I.wraparound):G===8?3:G===9?q(F==="X10"):G===12?q(K.cursorBlink):G===25?q(!X.isCursorHidden):G===45?q(I.reverseWraparound):G===66?q(I.applicationKeypad):G===67?4:G===1e3?q(F==="VT200"):G===1002?q(F==="DRAG"):G===1003?q(F==="ANY"):G===1004?q(I.sendFocus):G===1005?4:G===1006?q(V==="SGR"):G===1015?4:G===1016?q(V==="SGR_PIXELS"):G===1048?1:G===47||G===1047||G===1049?q(z===M):G===2004?q(I.bracketedPasteMode):0,X.triggerDataEvent(`${a.C0.ESC}[${P?"":"?"}${te};${oe}$y`),!0;var te,oe}_updateAttrColor(D,P,I,F,V){return P===2?(D|=50331648,D&=-16777216,D|=p.AttributeData.fromColorRGB([I,F,V])):P===5&&(D&=-50331904,D|=33554432|255&I),D}_extractColor(D,P,I){const F=[0,0,-1,0,0,0];let V=0,X=0;do{if(F[X+V]=D.params[P+X],D.hasSubParams(P+X)){const Y=D.getSubParams(P+X);let J=0;do F[1]===5&&(V=1),F[X+J+1+V]=Y[J];while(++J<Y.length&&J+X+1+V<F.length);break}if(F[1]===5&&X+V>=2||F[1]===2&&X+V>=5)break;F[1]&&(V=1)}while(++X+P<D.length&&X+V<F.length);for(let Y=2;Y<F.length;++Y)F[Y]===-1&&(F[Y]=0);switch(F[0]){case 38:I.fg=this._updateAttrColor(I.fg,F[1],F[3],F[4],F[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,F[1],F[3],F[4],F[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,F[1],F[3],F[4],F[5])}return X}_processUnderline(D,P){P.extended=P.extended.clone(),(!~D||D>5)&&(D=1),P.extended.underlineStyle=D,P.fg|=268435456,D===0&&(P.fg&=-268435457),P.updateExtended()}_processSGR0(D){D.fg=r.DEFAULT_ATTR_DATA.fg,D.bg=r.DEFAULT_ATTR_DATA.bg,D.extended=D.extended.clone(),D.extended.underlineStyle=0,D.extended.underlineColor&=-67108864,D.updateExtended()}charAttributes(D){if(D.length===1&&D.params[0]===0)return this._processSGR0(this._curAttrData),!0;const P=D.length;let I;const F=this._curAttrData;for(let V=0;V<P;V++)I=D.params[V],I>=30&&I<=37?(F.fg&=-50331904,F.fg|=16777216|I-30):I>=40&&I<=47?(F.bg&=-50331904,F.bg|=16777216|I-40):I>=90&&I<=97?(F.fg&=-50331904,F.fg|=16777224|I-90):I>=100&&I<=107?(F.bg&=-50331904,F.bg|=16777224|I-100):I===0?this._processSGR0(F):I===1?F.fg|=134217728:I===3?F.bg|=67108864:I===4?(F.fg|=268435456,this._processUnderline(D.hasSubParams(V)?D.getSubParams(V)[0]:1,F)):I===5?F.fg|=536870912:I===7?F.fg|=67108864:I===8?F.fg|=1073741824:I===9?F.fg|=2147483648:I===2?F.bg|=134217728:I===21?this._processUnderline(2,F):I===22?(F.fg&=-134217729,F.bg&=-134217729):I===23?F.bg&=-67108865:I===24?(F.fg&=-268435457,this._processUnderline(0,F)):I===25?F.fg&=-536870913:I===27?F.fg&=-67108865:I===28?F.fg&=-1073741825:I===29?F.fg&=2147483647:I===39?(F.fg&=-67108864,F.fg|=16777215&r.DEFAULT_ATTR_DATA.fg):I===49?(F.bg&=-67108864,F.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?V+=this._extractColor(D,V,F):I===53?F.bg|=1073741824:I===55?F.bg&=-1073741825:I===59?(F.extended=F.extended.clone(),F.extended.underlineColor=-1,F.updateExtended()):I===100?(F.fg&=-67108864,F.fg|=16777215&r.DEFAULT_ATTR_DATA.fg,F.bg&=-67108864,F.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(D){switch(D.params[0]){case 5:this._coreService.triggerDataEvent(`${a.C0.ESC}[0n`);break;case 6:const P=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[${P};${I}R`)}return!0}deviceStatusPrivate(D){if(D.params[0]===6){const P=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[?${P};${I}R`)}return!0}softReset(D){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(D){const P=D.params[0]||1;switch(P){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const I=P%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(D){const P=D.params[0]||1;let I;return(D.length<2||(I=D.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>P&&(this._activeBuffer.scrollTop=P-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(D){if(!O(D.params[0],this._optionsService.rawOptions.windowOptions))return!0;const P=D.length>1?D.params[1]:0;switch(D.params[0]){case 14:P!==2&&this._onRequestWindowsOptionsReport.fire(B.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(B.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${a.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:P!==0&&P!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),P!==0&&P!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:P!==0&&P!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),P!==0&&P!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(D){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(D){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(D){return this._windowTitle=D,this._onTitleChange.fire(D),!0}setIconName(D){return this._iconName=D,!0}setOrReportIndexedColor(D){const P=[],I=D.split(";");for(;I.length>1;){const F=I.shift(),V=I.shift();if(/^\d+$/.exec(F)){const X=parseInt(F);if($(X))if(V==="?")P.push({type:0,index:X});else{const Y=(0,L.parseColor)(V);Y&&P.push({type:1,index:X,color:Y})}}}return P.length&&this._onColor.fire(P),!0}setHyperlink(D){const P=D.split(";");return!(P.length<2)&&(P[1]?this._createHyperlink(P[0],P[1]):!P[0]&&this._finishHyperlink())}_createHyperlink(D,P){this._getCurrentLinkId()&&this._finishHyperlink();const I=D.split(":");let F;const V=I.findIndex(X=>X.startsWith("id="));return V!==-1&&(F=I[V].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:F,uri:P}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(D,P){const I=D.split(";");for(let F=0;F<I.length&&!(P>=this._specialColors.length);++F,++P)if(I[F]==="?")this._onColor.fire([{type:0,index:this._specialColors[P]}]);else{const V=(0,L.parseColor)(I[F]);V&&this._onColor.fire([{type:1,index:this._specialColors[P],color:V}])}return!0}setOrReportFgColor(D){return this._setOrReportSpecialColor(D,0)}setOrReportBgColor(D){return this._setOrReportSpecialColor(D,1)}setOrReportCursorColor(D){return this._setOrReportSpecialColor(D,2)}restoreIndexedColor(D){if(!D)return this._onColor.fire([{type:2}]),!0;const P=[],I=D.split(";");for(let F=0;F<I.length;++F)if(/^\d+$/.exec(I[F])){const V=parseInt(I[F]);$(V)&&P.push({type:2,index:V})}return P.length&&this._onColor.fire(P),!0}restoreFgColor(D){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(D){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(D){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(D){return D.length!==2?(this.selectDefaultCharset(),!0):(D[0]==="/"||this._charsetService.setgCharset(R[D[0]],d.CHARSETS[D[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const D=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,D,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(D){return this._charsetService.setgLevel(D),!0}screenAlignmentPattern(){const D=new o.CellData;D.content=4194373,D.fg=this._curAttrData.fg,D.bg=this._curAttrData.bg,this._setCursor(0,0);for(let P=0;P<this._bufferService.rows;++P){const I=this._activeBuffer.ybase+this._activeBuffer.y+P,F=this._activeBuffer.lines.get(I);F&&(F.fill(D),F.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(D,P){const I=this._bufferService.buffer,F=this._optionsService.rawOptions;return(V=>(this._coreService.triggerDataEvent(`${a.C0.ESC}${V}${a.C0.ESC}\\`),!0))(D==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:D==='"p'?'P1$r61;1"p':D==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:D==="m"?"P1$r0m":D===" q"?`P1$r${{block:2,underline:4,bar:6}[F.cursorStyle]-(F.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(D,P){this._dirtyRowTracker.markRangeDirty(D,P)}}e.InputHandler=N;let W=class{constructor(j){this._bufferService=j,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(j){j<this.start?this.start=j:j>this.end&&(this.end=j)}markRangeDirty(j,D){j>D&&(H=j,j=D,D=H),j<this.start&&(this.start=j),D>this.end&&(this.end=D)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function $(j){return 0<=j&&j<256}W=c([u(0,b.IBufferService)],W)},844:(C,e)=>{function t(c){for(const u of c)u.dispose();c.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const u=this._disposables.indexOf(c);u!==-1&&this._disposables.splice(u,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(c){var u;this._isDisposed||c===this._value||((u=this._value)==null||u.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){var c;this._isDisposed=!0,(c=this._value)==null||c.dispose(),this._value=void 0}},e.toDisposable=function(c){return{dispose:c}},e.disposeArray=t,e.getDisposeArrayDisposable=function(c){return{dispose:()=>t(c)}}},1505:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class t{constructor(){this._data={}}set(u,a,d){this._data[u]||(this._data[u]={}),this._data[u][a]=d}get(u,a){return this._data[u]?this._data[u][a]:void 0}clear(){this._data={}}}e.TwoKeyMap=t,e.FourKeyMap=class{constructor(){this._data=new t}set(c,u,a,d,v){this._data.get(c,u)||this._data.set(c,u,new t),this._data.get(c,u).set(a,d,v)}get(c,u,a,d){var v;return(v=this._data.get(c,u))==null?void 0:v.get(a,d)}clear(){this._data.clear()}}},6114:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof process<"u"&&"title"in process;const t=e.isNode?"node":navigator.userAgent,c=e.isNode?"node":navigator.platform;e.isFirefox=t.includes("Firefox"),e.isLegacyEdge=t.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(t),e.getSafariVersion=function(){if(!e.isSafari)return 0;const u=t.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),e.isIpad=c==="iPad",e.isIphone=c==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),e.isLinux=c.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(t)},6106:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SortedList=void 0;let t=0;e.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(t=this._search(this._getKey(c)),this._array.splice(t,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const u=this._getKey(c);if(u===void 0||(t=this._search(u),t===-1)||this._getKey(this._array[t])!==u)return!1;do if(this._array[t]===c)return this._array.splice(t,1),!0;while(++t<this._array.length&&this._getKey(this._array[t])===u);return!1}*getKeyIterator(c){if(this._array.length!==0&&(t=this._search(c),!(t<0||t>=this._array.length)&&this._getKey(this._array[t])===c))do yield this._array[t];while(++t<this._array.length&&this._getKey(this._array[t])===c)}forEachByKey(c,u){if(this._array.length!==0&&(t=this._search(c),!(t<0||t>=this._array.length)&&this._getKey(this._array[t])===c))do u(this._array[t]);while(++t<this._array.length&&this._getKey(this._array[t])===c)}values(){return[...this._array].values()}_search(c){let u=0,a=this._array.length-1;for(;a>=u;){let d=u+a>>1;const v=this._getKey(this._array[d]);if(v>c)a=d-1;else{if(!(v<c)){for(;d>0&&this._getKey(this._array[d-1])===c;)d--;return d}u=d+1}}return u}}},7226:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;const c=t(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(v){this._tasks.push(v),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(v){this._idleCallback=void 0;let m=0,f=0,r=v.timeRemaining(),n=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),f=Math.max(m,f),n=v.timeRemaining(),1.5*f>n)return r-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-m))}ms`),void this._start();r=n}this.clear()}}class a extends u{_requestCallback(v){return setTimeout(()=>v(this._createDeadline(16)))}_cancelCallback(v){clearTimeout(v)}_createDeadline(v){const m=Date.now()+v;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}e.PriorityTaskQueue=a,e.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:a,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updateWindowsModeWrappedState=void 0;const c=t(643);e.updateWindowsModeWrappedState=function(u){const a=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),d=a==null?void 0:a.get(u.cols-1),v=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);v&&d&&(v.isWrapped=d[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&d[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class t{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(a){return[a>>>16&255,a>>>8&255,255&a]}static fromColorRGB(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]}clone(){const a=new t;return a.fg=this.fg,a.bg=this.bg,a.extended=this.extended.clone(),a}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}e.AttributeData=t;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(a){this._ext=a}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(a){this._ext&=-469762049,this._ext|=a<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(a){this._ext&=-67108864,this._ext|=67108863&a}get urlId(){return this._urlId}set urlId(a){this._urlId=a}get underlineVariantOffset(){const a=(3758096384&this._ext)>>29;return a<0?4294967288^a:a}set underlineVariantOffset(a){this._ext&=536870911,this._ext|=a<<29&3758096384}constructor(a=0,d=0){this._ext=0,this._urlId=0,this._ext=a,this._urlId=d}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=c},9092:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Buffer=e.MAX_BUFFER_SIZE=void 0;const c=t(6349),u=t(7226),a=t(3734),d=t(8437),v=t(4634),m=t(511),f=t(643),r=t(4863),n=t(7116);e.MAX_BUFFER_SIZE=4294967295,e.Buffer=class{constructor(s,o,p){this._hasScrollback=s,this._optionsService=o,this._bufferService=p,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=n.DEFAULT_CHARSET,this.markers=[],this._nullCell=m.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]),this._whitespaceCell=m.CellData.fromCharData([0,f.WHITESPACE_CELL_CHAR,f.WHITESPACE_CELL_WIDTH,f.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new u.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,o){return new d.BufferLine(this._bufferService.cols,this.getNullCell(s),o)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const o=s+this._optionsService.rawOptions.scrollback;return o>e.MAX_BUFFER_SIZE?e.MAX_BUFFER_SIZE:o}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=d.DEFAULT_ATTR_DATA);let o=this._rows;for(;o--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,o){const p=this.getNullCell(d.DEFAULT_ATTR_DATA);let b=0;const S=this._getCorrectBufferLength(o);if(S>this.lines.maxLength&&(this.lines.maxLength=S),this.lines.length>0){if(this._cols<s)for(let g=0;g<this.lines.length;g++)b+=+this.lines.get(g).resize(s,p);let k=0;if(this._rows<o)for(let g=this._rows;g<o;g++)this.lines.length<o+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new d.BufferLine(s,p)):this.ybase>0&&this.lines.length<=this.ybase+this.y+k+1?(this.ybase--,k++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(s,p)));else for(let g=this._rows;g>o;g--)this.lines.length>o+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(S<this.lines.maxLength){const g=this.lines.length-S;g>0&&(this.lines.trimStart(g),this.ybase=Math.max(this.ybase-g,0),this.ydisp=Math.max(this.ydisp-g,0),this.savedY=Math.max(this.savedY-g,0)),this.lines.maxLength=S}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,o-1),k&&(this.y+=k),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=o-1,this._isReflowEnabled&&(this._reflow(s,o),this._cols>s))for(let k=0;k<this.lines.length;k++)b+=+this.lines.get(k).resize(s,p);this._cols=s,this._rows=o,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let o=0;for(;this._memoryCleanupPosition<this.lines.length;)if(o+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),o>100)return!0;return s}get _isReflowEnabled(){const s=this._optionsService.rawOptions.windowsPty;return s&&s.buildNumber?this._hasScrollback&&s.backend==="conpty"&&s.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,o){this._cols!==s&&(s>this._cols?this._reflowLarger(s,o):this._reflowSmaller(s,o))}_reflowLarger(s,o){const p=(0,v.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(p.length>0){const b=(0,v.reflowLargerCreateNewLayout)(this.lines,p);(0,v.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(s,o,b.countRemoved)}}_reflowLargerAdjustViewport(s,o,p){const b=this.getNullCell(d.DEFAULT_ATTR_DATA);let S=p;for(;S-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<o&&this.lines.push(new d.BufferLine(s,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-p,0)}_reflowSmaller(s,o){const p=this.getNullCell(d.DEFAULT_ATTR_DATA),b=[];let S=0;for(let k=this.lines.length-1;k>=0;k--){let g=this.lines.get(k);if(!g||!g.isWrapped&&g.getTrimmedLength()<=s)continue;const L=[g];for(;g.isWrapped&&k>0;)g=this.lines.get(--k),L.unshift(g);const R=this.ybase+this.y;if(R>=k&&R<k+L.length)continue;const x=L[L.length-1].getTrimmedLength(),O=(0,v.reflowSmallerGetNewLineLengths)(L,this._cols,s),B=O.length-L.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const N=[];for(let I=0;I<B;I++){const F=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);N.push(F)}N.length>0&&(b.push({start:k+L.length+S,newLines:N}),S+=N.length),L.push(...N);let W=O.length-1,$=O[W];$===0&&(W--,$=O[W]);let j=L.length-B-1,D=x;for(;j>=0;){const I=Math.min(D,$);if(L[W]===void 0)break;if(L[W].copyCellsFrom(L[j],D-I,$-I,I,!0),$-=I,$===0&&(W--,$=O[W]),D-=I,D===0){j--;const F=Math.max(j,0);D=(0,v.getWrappedLineTrimmedLength)(L,F,this._cols)}}for(let I=0;I<L.length;I++)O[I]<s&&L[I].setCell(O[I],p);let P=B-H;for(;P-- >0;)this.ybase===0?this.y<o-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+S)-o&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+o-1)}if(b.length>0){const k=[],g=[];for(let W=0;W<this.lines.length;W++)g.push(this.lines.get(W));const L=this.lines.length;let R=L-1,x=0,O=b[x];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+S);let B=0;for(let W=Math.min(this.lines.maxLength-1,L+S-1);W>=0;W--)if(O&&O.start>R+B){for(let $=O.newLines.length-1;$>=0;$--)this.lines.set(W--,O.newLines[$]);W++,k.push({index:R+1,amount:O.newLines.length}),B+=O.newLines.length,O=b[++x]}else this.lines.set(W,g[R--]);let H=0;for(let W=k.length-1;W>=0;W--)k[W].index+=H,this.lines.onInsertEmitter.fire(k[W]),H+=k[W].amount;const N=Math.max(0,L+S-this.lines.maxLength);N>0&&this.lines.onTrimEmitter.fire(N)}}translateBufferLineToString(s,o,p=0,b){const S=this.lines.get(s);return S?S.translateToString(o,p,b):""}getWrappedRangeForLine(s){let o=s,p=s;for(;o>0&&this.lines.get(o).isWrapped;)o--;for(;p+1<this.lines.length&&this.lines.get(p+1).isWrapped;)p++;return{first:o,last:p}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].line===s&&(this.markers[o].dispose(),this.markers.splice(o--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const o=new r.Marker(s);return this.markers.push(o),o.register(this.lines.onTrim(p=>{o.line-=p,o.line<0&&o.dispose()})),o.register(this.lines.onInsert(p=>{o.line>=p.index&&(o.line+=p.amount)})),o.register(this.lines.onDelete(p=>{o.line>=p.index&&o.line<p.index+p.amount&&o.dispose(),o.line>p.index&&(o.line-=p.amount)})),o.register(o.onDispose(()=>this._removeMarker(o))),o}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLine=e.DEFAULT_ATTR_DATA=void 0;const c=t(3734),u=t(511),a=t(643),d=t(482);e.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let v=0;class m{constructor(r,n,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*r);const o=n||u.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]);for(let p=0;p<r;++p)this.setCell(p,o);this.length=r}get(r){const n=this._data[3*r+0],s=2097151&n;return[this._data[3*r+1],2097152&n?this._combined[r]:s?(0,d.stringFromCodePoint)(s):"",n>>22,2097152&n?this._combined[r].charCodeAt(this._combined[r].length-1):s]}set(r,n){this._data[3*r+1]=n[a.CHAR_DATA_ATTR_INDEX],n[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[r]=n[1],this._data[3*r+0]=2097152|r|n[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*r+0]=n[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|n[a.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(r){return this._data[3*r+0]>>22}hasWidth(r){return 12582912&this._data[3*r+0]}getFg(r){return this._data[3*r+1]}getBg(r){return this._data[3*r+2]}hasContent(r){return 4194303&this._data[3*r+0]}getCodePoint(r){const n=this._data[3*r+0];return 2097152&n?this._combined[r].charCodeAt(this._combined[r].length-1):2097151&n}isCombined(r){return 2097152&this._data[3*r+0]}getString(r){const n=this._data[3*r+0];return 2097152&n?this._combined[r]:2097151&n?(0,d.stringFromCodePoint)(2097151&n):""}isProtected(r){return 536870912&this._data[3*r+2]}loadCell(r,n){return v=3*r,n.content=this._data[v+0],n.fg=this._data[v+1],n.bg=this._data[v+2],2097152&n.content&&(n.combinedData=this._combined[r]),268435456&n.bg&&(n.extended=this._extendedAttrs[r]),n}setCell(r,n){2097152&n.content&&(this._combined[r]=n.combinedData),268435456&n.bg&&(this._extendedAttrs[r]=n.extended),this._data[3*r+0]=n.content,this._data[3*r+1]=n.fg,this._data[3*r+2]=n.bg}setCellFromCodepoint(r,n,s,o){268435456&o.bg&&(this._extendedAttrs[r]=o.extended),this._data[3*r+0]=n|s<<22,this._data[3*r+1]=o.fg,this._data[3*r+2]=o.bg}addCodepointToCell(r,n,s){let o=this._data[3*r+0];2097152&o?this._combined[r]+=(0,d.stringFromCodePoint)(n):2097151&o?(this._combined[r]=(0,d.stringFromCodePoint)(2097151&o)+(0,d.stringFromCodePoint)(n),o&=-2097152,o|=2097152):o=n|4194304,s&&(o&=-12582913,o|=s<<22),this._data[3*r+0]=o}insertCells(r,n,s){if((r%=this.length)&&this.getWidth(r-1)===2&&this.setCellFromCodepoint(r-1,0,1,s),n<this.length-r){const o=new u.CellData;for(let p=this.length-r-n-1;p>=0;--p)this.setCell(r+n+p,this.loadCell(r+p,o));for(let p=0;p<n;++p)this.setCell(r+p,s)}else for(let o=r;o<this.length;++o)this.setCell(o,s);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,s)}deleteCells(r,n,s){if(r%=this.length,n<this.length-r){const o=new u.CellData;for(let p=0;p<this.length-r-n;++p)this.setCell(r+p,this.loadCell(r+n+p,o));for(let p=this.length-n;p<this.length;++p)this.setCell(p,s)}else for(let o=r;o<this.length;++o)this.setCell(o,s);r&&this.getWidth(r-1)===2&&this.setCellFromCodepoint(r-1,0,1,s),this.getWidth(r)!==0||this.hasContent(r)||this.setCellFromCodepoint(r,0,1,s)}replaceCells(r,n,s,o=!1){if(o)for(r&&this.getWidth(r-1)===2&&!this.isProtected(r-1)&&this.setCellFromCodepoint(r-1,0,1,s),n<this.length&&this.getWidth(n-1)===2&&!this.isProtected(n)&&this.setCellFromCodepoint(n,0,1,s);r<n&&r<this.length;)this.isProtected(r)||this.setCell(r,s),r++;else for(r&&this.getWidth(r-1)===2&&this.setCellFromCodepoint(r-1,0,1,s),n<this.length&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n,0,1,s);r<n&&r<this.length;)this.setCell(r++,s)}resize(r,n){if(r===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*r;if(r>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const o=new Uint32Array(s);o.set(this._data),this._data=o}for(let o=this.length;o<r;++o)this.setCell(o,n)}else{this._data=this._data.subarray(0,s);const o=Object.keys(this._combined);for(let b=0;b<o.length;b++){const S=parseInt(o[b],10);S>=r&&delete this._combined[S]}const p=Object.keys(this._extendedAttrs);for(let b=0;b<p.length;b++){const S=parseInt(p[b],10);S>=r&&delete this._extendedAttrs[S]}}return this.length=r,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const r=new Uint32Array(this._data.length);return r.set(this._data),this._data=r,1}return 0}fill(r,n=!1){if(n)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,r);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,r)}}copyFrom(r){this.length!==r.length?this._data=new Uint32Array(r._data):this._data.set(r._data),this.length=r.length,this._combined={};for(const n in r._combined)this._combined[n]=r._combined[n];this._extendedAttrs={};for(const n in r._extendedAttrs)this._extendedAttrs[n]=r._extendedAttrs[n];this.isWrapped=r.isWrapped}clone(){const r=new m(0);r._data=new Uint32Array(this._data),r.length=this.length;for(const n in this._combined)r._combined[n]=this._combined[n];for(const n in this._extendedAttrs)r._extendedAttrs[n]=this._extendedAttrs[n];return r.isWrapped=this.isWrapped,r}getTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0])return r+(this._data[3*r+0]>>22);return 0}getNoBgTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0]||50331648&this._data[3*r+2])return r+(this._data[3*r+0]>>22);return 0}copyCellsFrom(r,n,s,o,p){const b=r._data;if(p)for(let k=o-1;k>=0;k--){for(let g=0;g<3;g++)this._data[3*(s+k)+g]=b[3*(n+k)+g];268435456&b[3*(n+k)+2]&&(this._extendedAttrs[s+k]=r._extendedAttrs[n+k])}else for(let k=0;k<o;k++){for(let g=0;g<3;g++)this._data[3*(s+k)+g]=b[3*(n+k)+g];268435456&b[3*(n+k)+2]&&(this._extendedAttrs[s+k]=r._extendedAttrs[n+k])}const S=Object.keys(r._combined);for(let k=0;k<S.length;k++){const g=parseInt(S[k],10);g>=n&&(this._combined[g-n+s]=r._combined[g])}}translateToString(r,n,s,o){n=n??0,s=s??this.length,r&&(s=Math.min(s,this.getTrimmedLength())),o&&(o.length=0);let p="";for(;n<s;){const b=this._data[3*n+0],S=2097151&b,k=2097152&b?this._combined[n]:S?(0,d.stringFromCodePoint)(S):a.WHITESPACE_CELL_CHAR;if(p+=k,o)for(let g=0;g<k.length;++g)o.push(n);n+=b>>22||1}return o&&o.push(n),p}}e.BufferLine=m},4841:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRangeLength=void 0,e.getRangeLength=function(t,c){if(t.start.y>t.end.y)throw new Error(`Buffer range end (${t.end.x}, ${t.end.y}) cannot be before start (${t.start.x}, ${t.start.y})`);return c*(t.end.y-t.start.y)+(t.end.x-t.start.x+1)}},4634:(C,e)=>{function t(c,u,a){if(u===c.length-1)return c[u].getTrimmedLength();const d=!c[u].hasContent(a-1)&&c[u].getWidth(a-1)===1,v=c[u+1].getWidth(0)===2;return d&&v?a-1:a}Object.defineProperty(e,"__esModule",{value:!0}),e.getWrappedLineTrimmedLength=e.reflowSmallerGetNewLineLengths=e.reflowLargerApplyNewLayout=e.reflowLargerCreateNewLayout=e.reflowLargerGetLinesToRemove=void 0,e.reflowLargerGetLinesToRemove=function(c,u,a,d,v){const m=[];for(let f=0;f<c.length-1;f++){let r=f,n=c.get(++r);if(!n.isWrapped)continue;const s=[c.get(f)];for(;r<c.length&&n.isWrapped;)s.push(n),n=c.get(++r);if(d>=f&&d<r){f+=s.length-1;continue}let o=0,p=t(s,o,u),b=1,S=0;for(;b<s.length;){const g=t(s,b,u),L=g-S,R=a-p,x=Math.min(L,R);s[o].copyCellsFrom(s[b],S,p,x,!1),p+=x,p===a&&(o++,p=0),S+=x,S===g&&(b++,S=0),p===0&&o!==0&&s[o-1].getWidth(a-1)===2&&(s[o].copyCellsFrom(s[o-1],a-1,p++,1,!1),s[o-1].setCell(a-1,v))}s[o].replaceCells(p,a,v);let k=0;for(let g=s.length-1;g>0&&(g>o||s[g].getTrimmedLength()===0);g--)k++;k>0&&(m.push(f+s.length-k),m.push(k)),f+=s.length-1}return m},e.reflowLargerCreateNewLayout=function(c,u){const a=[];let d=0,v=u[d],m=0;for(let f=0;f<c.length;f++)if(v===f){const r=u[++d];c.onDeleteEmitter.fire({index:f-m,amount:r}),f+=r-1,m+=r,v=u[++d]}else a.push(f);return{layout:a,countRemoved:m}},e.reflowLargerApplyNewLayout=function(c,u){const a=[];for(let d=0;d<u.length;d++)a.push(c.get(u[d]));for(let d=0;d<a.length;d++)c.set(d,a[d]);c.length=u.length},e.reflowSmallerGetNewLineLengths=function(c,u,a){const d=[],v=c.map((n,s)=>t(c,s,u)).reduce((n,s)=>n+s);let m=0,f=0,r=0;for(;r<v;){if(v-r<a){d.push(v-r);break}m+=a;const n=t(c,f,u);m>n&&(m-=n,f++);const s=c[f].getWidth(m-1)===2;s&&m--;const o=s?a-1:a;d.push(o),r+=o}return d},e.getWrappedLineTrimmedLength=t},5295:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferSet=void 0;const c=t(8460),u=t(844),a=t(9092);class d extends u.Disposable{constructor(m,f){super(),this._optionsService=m,this._bufferService=f,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(m){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(m),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(m,f){this._normal.resize(m,f),this._alt.resize(m,f),this.setupTabStops(m)}setupTabStops(m){this._normal.setupTabStops(m),this._alt.setupTabStops(m)}}e.BufferSet=d},511:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;const c=t(482),u=t(643),a=t(3734);class d extends a.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new a.ExtendedAttrs,this.combinedData=""}static fromCharData(m){const f=new d;return f.setFromCharData(m),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(m[u.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(m[u.CHAR_DATA_CHAR_INDEX].length===2){const r=m[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){const n=m[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(r-55296)+n-56320+65536|m[u.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=m[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[u.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=m[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=d},643:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},4863:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;const c=t(8460),u=t(844);class a{get id(){return this._id}constructor(v){this.line=v,this.isDisposed=!1,this._disposables=[],this._id=a._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(v){return this._disposables.push(v),v}}e.Marker=a,a._nextId=1},7116:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CHARSET=e.CHARSETS=void 0,e.CHARSETS={},e.DEFAULT_CHARSET=e.CHARSETS.B,e.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},e.CHARSETS.A={"#":"Â£"},e.CHARSETS.B=void 0,e.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},e.CHARSETS.C=e.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},e.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},e.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},e.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},e.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},e.CHARSETS.E=e.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},e.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},e.CHARSETS.H=e.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},e.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(C,e)=>{var t,c,u;Object.defineProperty(e,"__esModule",{value:!0}),e.C1_ESCAPED=e.C1=e.C0=void 0,function(a){a.NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL=""}(t||(e.C0=t={})),function(a){a.PAD="Â",a.HOP="Â",a.BPH="Â",a.NBH="Â",a.IND="Â",a.NEL="Â",a.SSA="Â",a.ESA="Â",a.HTS="Â",a.HTJ="Â",a.VTS="Â",a.PLD="Â",a.PLU="Â",a.RI="Â",a.SS2="Â",a.SS3="Â",a.DCS="Â",a.PU1="Â",a.PU2="Â",a.STS="Â",a.CCH="Â",a.MW="Â",a.SPA="Â",a.EPA="Â",a.SOS="Â",a.SGCI="Â",a.SCI="Â",a.CSI="Â",a.ST="Â",a.OSC="Â",a.PM="Â",a.APC="Â"}(c||(e.C1=c={})),function(a){a.ST=`${t.ESC}\\`}(u||(e.C1_ESCAPED=u={}))},7399:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateKeyboardEvent=void 0;const c=t(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};e.evaluateKeyboardEvent=function(a,d,v,m){const f={type:0,cancel:!1,key:void 0},r=(a.shiftKey?1:0)|(a.altKey?2:0)|(a.ctrlKey?4:0)|(a.metaKey?8:0);switch(a.keyCode){case 0:a.key==="UIKeyInputUpArrow"?f.key=d?c.C0.ESC+"OA":c.C0.ESC+"[A":a.key==="UIKeyInputLeftArrow"?f.key=d?c.C0.ESC+"OD":c.C0.ESC+"[D":a.key==="UIKeyInputRightArrow"?f.key=d?c.C0.ESC+"OC":c.C0.ESC+"[C":a.key==="UIKeyInputDownArrow"&&(f.key=d?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:f.key=a.ctrlKey?"\b":c.C0.DEL,a.altKey&&(f.key=c.C0.ESC+f.key);break;case 9:if(a.shiftKey){f.key=c.C0.ESC+"[Z";break}f.key=c.C0.HT,f.cancel=!0;break;case 13:f.key=a.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,f.cancel=!0;break;case 27:f.key=c.C0.ESC,a.altKey&&(f.key=c.C0.ESC+c.C0.ESC),f.cancel=!0;break;case 37:if(a.metaKey)break;r?(f.key=c.C0.ESC+"[1;"+(r+1)+"D",f.key===c.C0.ESC+"[1;3D"&&(f.key=c.C0.ESC+(v?"b":"[1;5D"))):f.key=d?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(a.metaKey)break;r?(f.key=c.C0.ESC+"[1;"+(r+1)+"C",f.key===c.C0.ESC+"[1;3C"&&(f.key=c.C0.ESC+(v?"f":"[1;5C"))):f.key=d?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(a.metaKey)break;r?(f.key=c.C0.ESC+"[1;"+(r+1)+"A",v||f.key!==c.C0.ESC+"[1;3A"||(f.key=c.C0.ESC+"[1;5A")):f.key=d?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(a.metaKey)break;r?(f.key=c.C0.ESC+"[1;"+(r+1)+"B",v||f.key!==c.C0.ESC+"[1;3B"||(f.key=c.C0.ESC+"[1;5B")):f.key=d?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:a.shiftKey||a.ctrlKey||(f.key=c.C0.ESC+"[2~");break;case 46:f.key=r?c.C0.ESC+"[3;"+(r+1)+"~":c.C0.ESC+"[3~";break;case 36:f.key=r?c.C0.ESC+"[1;"+(r+1)+"H":d?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:f.key=r?c.C0.ESC+"[1;"+(r+1)+"F":d?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:a.shiftKey?f.type=2:a.ctrlKey?f.key=c.C0.ESC+"[5;"+(r+1)+"~":f.key=c.C0.ESC+"[5~";break;case 34:a.shiftKey?f.type=3:a.ctrlKey?f.key=c.C0.ESC+"[6;"+(r+1)+"~":f.key=c.C0.ESC+"[6~";break;case 112:f.key=r?c.C0.ESC+"[1;"+(r+1)+"P":c.C0.ESC+"OP";break;case 113:f.key=r?c.C0.ESC+"[1;"+(r+1)+"Q":c.C0.ESC+"OQ";break;case 114:f.key=r?c.C0.ESC+"[1;"+(r+1)+"R":c.C0.ESC+"OR";break;case 115:f.key=r?c.C0.ESC+"[1;"+(r+1)+"S":c.C0.ESC+"OS";break;case 116:f.key=r?c.C0.ESC+"[15;"+(r+1)+"~":c.C0.ESC+"[15~";break;case 117:f.key=r?c.C0.ESC+"[17;"+(r+1)+"~":c.C0.ESC+"[17~";break;case 118:f.key=r?c.C0.ESC+"[18;"+(r+1)+"~":c.C0.ESC+"[18~";break;case 119:f.key=r?c.C0.ESC+"[19;"+(r+1)+"~":c.C0.ESC+"[19~";break;case 120:f.key=r?c.C0.ESC+"[20;"+(r+1)+"~":c.C0.ESC+"[20~";break;case 121:f.key=r?c.C0.ESC+"[21;"+(r+1)+"~":c.C0.ESC+"[21~";break;case 122:f.key=r?c.C0.ESC+"[23;"+(r+1)+"~":c.C0.ESC+"[23~";break;case 123:f.key=r?c.C0.ESC+"[24;"+(r+1)+"~":c.C0.ESC+"[24~";break;default:if(!a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)if(v&&!m||!a.altKey||a.metaKey)!v||a.altKey||a.ctrlKey||a.shiftKey||!a.metaKey?a.key&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.keyCode>=48&&a.key.length===1?f.key=a.key:a.key&&a.ctrlKey&&(a.key==="_"&&(f.key=c.C0.US),a.key==="@"&&(f.key=c.C0.NUL)):a.keyCode===65&&(f.type=1);else{const n=u[a.keyCode],s=n==null?void 0:n[a.shiftKey?1:0];if(s)f.key=c.C0.ESC+s;else if(a.keyCode>=65&&a.keyCode<=90){const o=a.ctrlKey?a.keyCode-64:a.keyCode+32;let p=String.fromCharCode(o);a.shiftKey&&(p=p.toUpperCase()),f.key=c.C0.ESC+p}else if(a.keyCode===32)f.key=c.C0.ESC+(a.ctrlKey?c.C0.NUL:" ");else if(a.key==="Dead"&&a.code.startsWith("Key")){let o=a.code.slice(3,4);a.shiftKey||(o=o.toLowerCase()),f.key=c.C0.ESC+o,f.cancel=!0}}else a.keyCode>=65&&a.keyCode<=90?f.key=String.fromCharCode(a.keyCode-64):a.keyCode===32?f.key=c.C0.NUL:a.keyCode>=51&&a.keyCode<=55?f.key=String.fromCharCode(a.keyCode-51+27):a.keyCode===56?f.key=c.C0.DEL:a.keyCode===219?f.key=c.C0.ESC:a.keyCode===220?f.key=c.C0.FS:a.keyCode===221&&(f.key=c.C0.GS)}return f}},482:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(t){return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10))+String.fromCharCode(t%1024+56320)):String.fromCharCode(t)},e.utf32ToString=function(t,c=0,u=t.length){let a="";for(let d=c;d<u;++d){let v=t[d];v>65535?(v-=65536,a+=String.fromCharCode(55296+(v>>10))+String.fromCharCode(v%1024+56320)):a+=String.fromCharCode(v)}return a},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(t,c){const u=t.length;if(!u)return 0;let a=0,d=0;if(this._interim){const v=t.charCodeAt(d++);56320<=v&&v<=57343?c[a++]=1024*(this._interim-55296)+v-56320+65536:(c[a++]=this._interim,c[a++]=v),this._interim=0}for(let v=d;v<u;++v){const m=t.charCodeAt(v);if(55296<=m&&m<=56319){if(++v>=u)return this._interim=m,a;const f=t.charCodeAt(v);56320<=f&&f<=57343?c[a++]=1024*(m-55296)+f-56320+65536:(c[a++]=m,c[a++]=f)}else m!==65279&&(c[a++]=m)}return a}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(t,c){const u=t.length;if(!u)return 0;let a,d,v,m,f=0,r=0,n=0;if(this.interim[0]){let p=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let S,k=0;for(;(S=63&this.interim[++k])&&k<4;)b<<=6,b|=S;const g=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,L=g-k;for(;n<L;){if(n>=u)return 0;if(S=t[n++],(192&S)!=128){n--,p=!0;break}this.interim[k++]=S,b<<=6,b|=63&S}p||(g===2?b<128?n--:c[f++]=b:g===3?b<2048||b>=55296&&b<=57343||b===65279||(c[f++]=b):b<65536||b>1114111||(c[f++]=b)),this.interim.fill(0)}const s=u-4;let o=n;for(;o<u;){for(;!(!(o<s)||128&(a=t[o])||128&(d=t[o+1])||128&(v=t[o+2])||128&(m=t[o+3]));)c[f++]=a,c[f++]=d,c[f++]=v,c[f++]=m,o+=4;if(a=t[o++],a<128)c[f++]=a;else if((224&a)==192){if(o>=u)return this.interim[0]=a,f;if(d=t[o++],(192&d)!=128){o--;continue}if(r=(31&a)<<6|63&d,r<128){o--;continue}c[f++]=r}else if((240&a)==224){if(o>=u)return this.interim[0]=a,f;if(d=t[o++],(192&d)!=128){o--;continue}if(o>=u)return this.interim[0]=a,this.interim[1]=d,f;if(v=t[o++],(192&v)!=128){o--;continue}if(r=(15&a)<<12|(63&d)<<6|63&v,r<2048||r>=55296&&r<=57343||r===65279)continue;c[f++]=r}else if((248&a)==240){if(o>=u)return this.interim[0]=a,f;if(d=t[o++],(192&d)!=128){o--;continue}if(o>=u)return this.interim[0]=a,this.interim[1]=d,f;if(v=t[o++],(192&v)!=128){o--;continue}if(o>=u)return this.interim[0]=a,this.interim[1]=d,this.interim[2]=v,f;if(m=t[o++],(192&m)!=128){o--;continue}if(r=(7&a)<<18|(63&d)<<12|(63&v)<<6|63&m,r<65536||r>1114111)continue;c[f++]=r}}return f}}},225:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeV6=void 0;const c=t(1480),u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],a=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;e.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let v=0;v<u.length;++v)d.fill(0,u[v][0],u[v][1]+1)}}wcwidth(v){return v<32?0:v<127?1:v<65536?d[v]:function(m,f){let r,n=0,s=f.length-1;if(m<f[0][0]||m>f[s][1])return!1;for(;s>=n;)if(r=n+s>>1,m>f[r][1])n=r+1;else{if(!(m<f[r][0]))return!0;s=r-1}return!1}(v,a)?0:v>=131072&&v<=196605||v>=196608&&v<=262141?2:1}charProperties(v,m){let f=this.wcwidth(v),r=f===0&&m!==0;if(r){const n=c.UnicodeService.extractWidth(m);n===0?r=!1:n>f&&(f=n)}return c.UnicodeService.createPropertyValue(0,f,r)}}},5981:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WriteBuffer=void 0;const c=t(8460),u=t(844);class a extends u.Disposable{constructor(v){super(),this._action=v,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(v,m){if(m!==void 0&&this._syncCalls>m)return void(this._syncCalls=0);if(this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let f;for(this._isSyncWriting=!0;f=this._writeBuffer.shift();){this._action(f);const r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(v,m){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(m),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(m)}_innerWrite(v=0,m=!0){const f=v||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const r=this._writeBuffer[this._bufferOffset],n=this._action(r,m);if(n){const o=p=>Date.now()-f>=12?setTimeout(()=>this._innerWrite(0,p)):this._innerWrite(f,p);return void n.catch(p=>(queueMicrotask(()=>{throw p}),Promise.resolve(!1))).then(o)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=r.length,Date.now()-f>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}e.WriteBuffer=a},5941:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.toRgbString=e.parseColor=void 0;const t=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function u(a,d){const v=a.toString(16),m=v.length<2?"0"+v:v;switch(d){case 4:return v[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}e.parseColor=function(a){if(!a)return;let d=a.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const v=t.exec(d);if(v){const m=v[1]?15:v[4]?255:v[7]?4095:65535;return[Math.round(parseInt(v[1]||v[4]||v[7]||v[10],16)/m*255),Math.round(parseInt(v[2]||v[5]||v[8]||v[11],16)/m*255),Math.round(parseInt(v[3]||v[6]||v[9]||v[12],16)/m*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),c.exec(d)&&[3,6,9,12].includes(d.length))){const v=d.length/3,m=[0,0,0];for(let f=0;f<3;++f){const r=parseInt(d.slice(v*f,v*f+v),16);m[f]=v===1?r<<4:v===2?r:v===3?r>>4:r>>8}return m}},e.toRgbString=function(a,d=16){const[v,m,f]=a;return`rgb:${u(v,d)}/${u(m,d)}/${u(f,d)}`}},5770:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PAYLOAD_LIMIT=void 0,e.PAYLOAD_LIMIT=1e7},6351:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DcsHandler=e.DcsParser=void 0;const c=t(482),u=t(8742),a=t(5770),d=[];e.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(m,f){this._handlers[m]===void 0&&(this._handlers[m]=[]);const r=this._handlers[m];return r.push(f),{dispose:()=>{const n=r.indexOf(f);n!==-1&&r.splice(n,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}reset(){if(this._active.length)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(m,f){if(this.reset(),this._ident=m,this._active=this._handlers[m]||d,this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(f);else this._handlerFb(this._ident,"HOOK",f)}put(m,f,r){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(m,f,r);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(m,f,r))}unhook(m,f=!0){if(this._active.length){let r=!1,n=this._active.length-1,s=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=f,s=this._stack.fallThrough,this._stack.paused=!1),!s&&r===!1){for(;n>=0&&(r=this._active[n].unhook(m),r!==!0);n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if(r=this._active[n].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",m);this._active=d,this._ident=0}};const v=new u.Params;v.addParam(0),e.DcsHandler=class{constructor(m){this._handler=m,this._data="",this._params=v,this._hitLimit=!1}hook(m){this._params=m.length>1||m.params[0]?m.clone():v,this._data="",this._hitLimit=!1}put(m,f,r){this._hitLimit||(this._data+=(0,c.utf32ToString)(m,f,r),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(m){let f=!1;if(this._hitLimit)f=!1;else if(m&&(f=this._handler(this._data,this._params),f instanceof Promise))return f.then(r=>(this._params=v,this._data="",this._hitLimit=!1,r));return this._params=v,this._data="",this._hitLimit=!1,f}}},2015:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EscapeSequenceParser=e.VT500_TRANSITION_TABLE=e.TransitionTable=void 0;const c=t(844),u=t(8742),a=t(6242),d=t(6351);class v{constructor(n){this.table=new Uint8Array(n)}setDefault(n,s){this.table.fill(n<<4|s)}add(n,s,o,p){this.table[s<<8|n]=o<<4|p}addMany(n,s,o,p){for(let b=0;b<n.length;b++)this.table[s<<8|n[b]]=o<<4|p}}e.TransitionTable=v;const m=160;e.VT500_TRANSITION_TABLE=function(){const r=new v(4095),n=Array.apply(null,Array(256)).map((k,g)=>g),s=(k,g)=>n.slice(k,g),o=s(32,127),p=s(0,24);p.push(25),p.push.apply(p,s(28,32));const b=s(0,14);let S;for(S in r.setDefault(1,0),r.addMany(o,0,2,0),b)r.addMany([24,26,153,154],S,3,0),r.addMany(s(128,144),S,3,0),r.addMany(s(144,152),S,3,0),r.add(156,S,0,0),r.add(27,S,11,1),r.add(157,S,4,8),r.addMany([152,158,159],S,0,7),r.add(155,S,11,3),r.add(144,S,11,9);return r.addMany(p,0,3,0),r.addMany(p,1,3,1),r.add(127,1,0,1),r.addMany(p,8,0,8),r.addMany(p,3,3,3),r.add(127,3,0,3),r.addMany(p,4,3,4),r.add(127,4,0,4),r.addMany(p,6,3,6),r.addMany(p,5,3,5),r.add(127,5,0,5),r.addMany(p,2,3,2),r.add(127,2,0,2),r.add(93,1,4,8),r.addMany(o,8,5,8),r.add(127,8,5,8),r.addMany([156,27,24,26,7],8,6,0),r.addMany(s(28,32),8,0,8),r.addMany([88,94,95],1,0,7),r.addMany(o,7,0,7),r.addMany(p,7,0,7),r.add(156,7,0,0),r.add(127,7,0,7),r.add(91,1,11,3),r.addMany(s(64,127),3,7,0),r.addMany(s(48,60),3,8,4),r.addMany([60,61,62,63],3,9,4),r.addMany(s(48,60),4,8,4),r.addMany(s(64,127),4,7,0),r.addMany([60,61,62,63],4,0,6),r.addMany(s(32,64),6,0,6),r.add(127,6,0,6),r.addMany(s(64,127),6,0,0),r.addMany(s(32,48),3,9,5),r.addMany(s(32,48),5,9,5),r.addMany(s(48,64),5,0,6),r.addMany(s(64,127),5,7,0),r.addMany(s(32,48),4,9,5),r.addMany(s(32,48),1,9,2),r.addMany(s(32,48),2,9,2),r.addMany(s(48,127),2,10,0),r.addMany(s(48,80),1,10,0),r.addMany(s(81,88),1,10,0),r.addMany([89,90,92],1,10,0),r.addMany(s(96,127),1,10,0),r.add(80,1,11,9),r.addMany(p,9,0,9),r.add(127,9,0,9),r.addMany(s(28,32),9,0,9),r.addMany(s(32,48),9,9,12),r.addMany(s(48,60),9,8,10),r.addMany([60,61,62,63],9,9,10),r.addMany(p,11,0,11),r.addMany(s(32,128),11,0,11),r.addMany(s(28,32),11,0,11),r.addMany(p,10,0,10),r.add(127,10,0,10),r.addMany(s(28,32),10,0,10),r.addMany(s(48,60),10,8,10),r.addMany([60,61,62,63],10,0,11),r.addMany(s(32,48),10,9,12),r.addMany(p,12,0,12),r.add(127,12,0,12),r.addMany(s(28,32),12,0,12),r.addMany(s(32,48),12,9,12),r.addMany(s(48,64),12,0,11),r.addMany(s(64,127),12,12,13),r.addMany(s(64,127),10,12,13),r.addMany(s(64,127),9,12,13),r.addMany(p,13,13,13),r.addMany(o,13,13,13),r.add(127,13,0,13),r.addMany([27,156,24,26],13,14,0),r.add(m,0,2,0),r.add(m,8,5,8),r.add(m,6,0,6),r.add(m,11,0,11),r.add(m,13,13,13),r}();class f extends c.Disposable{constructor(n=e.VT500_TRANSITION_TABLE){super(),this._transitions=n,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(s,o,p)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,o)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new a.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(n,s=[64,126]){let o=0;if(n.prefix){if(n.prefix.length>1)throw new Error("only one byte as prefix supported");if(o=n.prefix.charCodeAt(0),o&&60>o||o>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(n.intermediates){if(n.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<n.intermediates.length;++b){const S=n.intermediates.charCodeAt(b);if(32>S||S>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");o<<=8,o|=S}}if(n.final.length!==1)throw new Error("final must be a single byte");const p=n.final.charCodeAt(0);if(s[0]>p||p>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return o<<=8,o|=p,o}identToString(n){const s=[];for(;n;)s.push(String.fromCharCode(255&n)),n>>=8;return s.reverse().join("")}setPrintHandler(n){this._printHandler=n}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(n,s){const o=this._identifier(n,[48,126]);this._escHandlers[o]===void 0&&(this._escHandlers[o]=[]);const p=this._escHandlers[o];return p.push(s),{dispose:()=>{const b=p.indexOf(s);b!==-1&&p.splice(b,1)}}}clearEscHandler(n){this._escHandlers[this._identifier(n,[48,126])]&&delete this._escHandlers[this._identifier(n,[48,126])]}setEscHandlerFallback(n){this._escHandlerFb=n}setExecuteHandler(n,s){this._executeHandlers[n.charCodeAt(0)]=s}clearExecuteHandler(n){this._executeHandlers[n.charCodeAt(0)]&&delete this._executeHandlers[n.charCodeAt(0)]}setExecuteHandlerFallback(n){this._executeHandlerFb=n}registerCsiHandler(n,s){const o=this._identifier(n);this._csiHandlers[o]===void 0&&(this._csiHandlers[o]=[]);const p=this._csiHandlers[o];return p.push(s),{dispose:()=>{const b=p.indexOf(s);b!==-1&&p.splice(b,1)}}}clearCsiHandler(n){this._csiHandlers[this._identifier(n)]&&delete this._csiHandlers[this._identifier(n)]}setCsiHandlerFallback(n){this._csiHandlerFb=n}registerDcsHandler(n,s){return this._dcsParser.registerHandler(this._identifier(n),s)}clearDcsHandler(n){this._dcsParser.clearHandler(this._identifier(n))}setDcsHandlerFallback(n){this._dcsParser.setHandlerFallback(n)}registerOscHandler(n,s){return this._oscParser.registerHandler(n,s)}clearOscHandler(n){this._oscParser.clearHandler(n)}setOscHandlerFallback(n){this._oscParser.setHandlerFallback(n)}setErrorHandler(n){this._errorHandler=n}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(n,s,o,p,b){this._parseStack.state=n,this._parseStack.handlers=s,this._parseStack.handlerPos=o,this._parseStack.transition=p,this._parseStack.chunkPos=b}parse(n,s,o){let p,b=0,S=0,k=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,k=this._parseStack.chunkPos+1;else{if(o===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const g=this._parseStack.handlers;let L=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(o===!1&&L>-1){for(;L>=0&&(p=g[L](this._params),p!==!0);L--)if(p instanceof Promise)return this._parseStack.handlerPos=L,p}this._parseStack.handlers=[];break;case 4:if(o===!1&&L>-1){for(;L>=0&&(p=g[L](),p!==!0);L--)if(p instanceof Promise)return this._parseStack.handlerPos=L,p}this._parseStack.handlers=[];break;case 6:if(b=n[this._parseStack.chunkPos],p=this._dcsParser.unhook(b!==24&&b!==26,o),p)return p;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=n[this._parseStack.chunkPos],p=this._oscParser.end(b!==24&&b!==26,o),p)return p;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,k=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let g=k;g<s;++g){switch(b=n[g],S=this._transitions.table[this.currentState<<8|(b<160?b:m)],S>>4){case 2:for(let B=g+1;;++B){if(B>=s||(b=n[B])<32||b>126&&b<m){this._printHandler(n,g,B),g=B-1;break}if(++B>=s||(b=n[B])<32||b>126&&b<m){this._printHandler(n,g,B),g=B-1;break}if(++B>=s||(b=n[B])<32||b>126&&b<m){this._printHandler(n,g,B),g=B-1;break}if(++B>=s||(b=n[B])<32||b>126&&b<m){this._printHandler(n,g,B),g=B-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:g,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const L=this._csiHandlers[this._collect<<8|b];let R=L?L.length-1:-1;for(;R>=0&&(p=L[R](this._params),p!==!0);R--)if(p instanceof Promise)return this._preserveStack(3,L,R,S,g),p;R<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingJoinState=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++g<s&&(b=n[g])>47&&b<60);g--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const x=this._escHandlers[this._collect<<8|b];let O=x?x.length-1:-1;for(;O>=0&&(p=x[O](),p!==!0);O--)if(p instanceof Promise)return this._preserveStack(4,x,O,S,g),p;O<0&&this._escHandlerFb(this._collect<<8|b),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let B=g+1;;++B)if(B>=s||(b=n[B])===24||b===26||b===27||b>127&&b<m){this._dcsParser.put(n,g,B),g=B-1;break}break;case 14:if(p=this._dcsParser.unhook(b!==24&&b!==26),p)return this._preserveStack(6,[],0,S,g),p;b===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let B=g+1;;B++)if(B>=s||(b=n[B])<32||b>127&&b<m){this._oscParser.put(n,g,B),g=B-1;break}break;case 6:if(p=this._oscParser.end(b!==24&&b!==26),p)return this._preserveStack(5,[],0,S,g),p;b===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&S}}}e.EscapeSequenceParser=f},6242:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscHandler=e.OscParser=void 0;const c=t(5770),u=t(482),a=[];e.OscParser=class{constructor(){this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,v){this._handlers[d]===void 0&&(this._handlers[d]=[]);const m=this._handlers[d];return m.push(v),{dispose:()=>{const f=m.indexOf(v);f!==-1&&m.splice(f,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||a,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,v,m){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(d,v,m);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(d,v,m))}start(){this.reset(),this._state=1}put(d,v,m){if(this._state!==3){if(this._state===1)for(;v<m;){const f=d[v++];if(f===59){this._state=2,this._start();break}if(f<48||57<f)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+f-48}this._state===2&&m-v>0&&this._put(d,v,m)}}end(d,v=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let m=!1,f=this._active.length-1,r=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,m=v,r=this._stack.fallThrough,this._stack.paused=!1),!r&&m===!1){for(;f>=0&&(m=this._active[f].end(d),m!==!0);f--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,m;f--}for(;f>=0;f--)if(m=this._active[f].end(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,m}else this._handlerFb(this._id,"END",d);this._active=a,this._id=-1,this._state=0}}},e.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,v,m){this._hitLimit||(this._data+=(0,u.utf32ToString)(d,v,m),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let v=!1;if(this._hitLimit)v=!1;else if(d&&(v=this._handler(this._data),v instanceof Promise))return v.then(m=>(this._data="",this._hitLimit=!1,m));return this._data="",this._hitLimit=!1,v}}},8742:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Params=void 0;const t=2147483647;class c{static fromArray(a){const d=new c;if(!a.length)return d;for(let v=Array.isArray(a[0])?1:0;v<a.length;++v){const m=a[v];if(Array.isArray(m))for(let f=0;f<m.length;++f)d.addSubParam(m[f]);else d.addParam(m)}return d}constructor(a=32,d=32){if(this.maxLength=a,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(a),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(a),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const a=new c(this.maxLength,this.maxSubParamsLength);return a.params.set(this.params),a.length=this.length,a._subParams.set(this._subParams),a._subParamsLength=this._subParamsLength,a._subParamsIdx.set(this._subParamsIdx),a._rejectDigits=this._rejectDigits,a._rejectSubDigits=this._rejectSubDigits,a._digitIsSub=this._digitIsSub,a}toArray(){const a=[];for(let d=0;d<this.length;++d){a.push(this.params[d]);const v=this._subParamsIdx[d]>>8,m=255&this._subParamsIdx[d];m-v>0&&a.push(Array.prototype.slice.call(this._subParams,v,m))}return a}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(a){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=a>t?t:a}}addSubParam(a){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=a>t?t:a,this._subParamsIdx[this.length-1]++}}hasSubParams(a){return(255&this._subParamsIdx[a])-(this._subParamsIdx[a]>>8)>0}getSubParams(a){const d=this._subParamsIdx[a]>>8,v=255&this._subParamsIdx[a];return v-d>0?this._subParams.subarray(d,v):null}getSubParamsAll(){const a={};for(let d=0;d<this.length;++d){const v=this._subParamsIdx[d]>>8,m=255&this._subParamsIdx[d];m-v>0&&(a[d]=this._subParams.slice(v,m))}return a}addDigit(a){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const v=this._digitIsSub?this._subParams:this.params,m=v[d-1];v[d-1]=~m?Math.min(10*m+a,t):a}}e.Params=c},5741:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AddonManager=void 0,e.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let t=this._addons.length-1;t>=0;t--)this._addons[t].instance.dispose()}loadAddon(t,c){const u={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(u),c.dispose=()=>this._wrappedAddonDispose(u),c.activate(t)}_wrappedAddonDispose(t){if(t.isDisposed)return;let c=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===t){c=u;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");t.isDisposed=!0,t.dispose.apply(t.instance),this._addons.splice(c,1)}}},8771:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferApiView=void 0;const c=t(3785),u=t(511);e.BufferApiView=class{constructor(a,d){this._buffer=a,this.type=d}init(a){return this._buffer=a,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(a){const d=this._buffer.lines.get(a);if(d)return new c.BufferLineApiView(d)}getNullCell(){return new u.CellData}}},3785:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLineApiView=void 0;const c=t(511);e.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,a){if(!(u<0||u>=this._line.length))return a?(this._line.loadCell(u,a),a):this._line.loadCell(u,new c.CellData)}translateToString(u,a,d){return this._line.translateToString(u,a,d)}}},8285:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferNamespaceApi=void 0;const c=t(8771),u=t(8460),a=t(844);class d extends a.Disposable{constructor(m){super(),this._core=m,this._onBufferChange=this.register(new u.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}e.BufferNamespaceApi=d},7975:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserApi=void 0,e.ParserApi=class{constructor(t){this._core=t}registerCsiHandler(t,c){return this._core.registerCsiHandler(t,u=>c(u.toArray()))}addCsiHandler(t,c){return this.registerCsiHandler(t,c)}registerDcsHandler(t,c){return this._core.registerDcsHandler(t,(u,a)=>c(u,a.toArray()))}addDcsHandler(t,c){return this.registerDcsHandler(t,c)}registerEscHandler(t,c){return this._core.registerEscHandler(t,c)}addEscHandler(t,c){return this.registerEscHandler(t,c)}registerOscHandler(t,c){return this._core.registerOscHandler(t,c)}addOscHandler(t,c){return this.registerOscHandler(t,c)}}},7090:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeApi=void 0,e.UnicodeApi=class{constructor(t){this._core=t}register(t){this._core.unicodeService.register(t)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(t){this._core.unicodeService.activeVersion=t}}},744:function(C,e,t){var c=this&&this.__decorate||function(r,n,s,o){var p,b=arguments.length,S=b<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,n,s,o);else for(var k=r.length-1;k>=0;k--)(p=r[k])&&(S=(b<3?p(S):b>3?p(n,s,S):p(n,s))||S);return b>3&&S&&Object.defineProperty(n,s,S),S},u=this&&this.__param||function(r,n){return function(s,o){n(s,o,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferService=e.MINIMUM_ROWS=e.MINIMUM_COLS=void 0;const a=t(8460),d=t(844),v=t(5295),m=t(2585);e.MINIMUM_COLS=2,e.MINIMUM_ROWS=1;let f=e.BufferService=class extends d.Disposable{get buffer(){return this.buffers.active}constructor(r){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(r.rawOptions.cols||0,e.MINIMUM_COLS),this.rows=Math.max(r.rawOptions.rows||0,e.MINIMUM_ROWS),this.buffers=this.register(new v.BufferSet(r,this))}resize(r,n){this.cols=r,this.rows=n,this.buffers.resize(r,n),this._onResize.fire({cols:r,rows:n})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(r,n=!1){const s=this.buffer;let o;o=this._cachedBlankLine,o&&o.length===this.cols&&o.getFg(0)===r.fg&&o.getBg(0)===r.bg||(o=s.getBlankLine(r,n),this._cachedBlankLine=o),o.isWrapped=n;const p=s.ybase+s.scrollTop,b=s.ybase+s.scrollBottom;if(s.scrollTop===0){const S=s.lines.isFull;b===s.lines.length-1?S?s.lines.recycle().copyFrom(o):s.lines.push(o.clone()):s.lines.splice(b+1,0,o.clone()),S?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const S=b-p+1;s.lines.shiftElements(p+1,S-1,-1),s.lines.set(b,o.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(r,n,s){const o=this.buffer;if(r<0){if(o.ydisp===0)return;this.isUserScrolling=!0}else r+o.ydisp>=o.ybase&&(this.isUserScrolling=!1);const p=o.ydisp;o.ydisp=Math.max(Math.min(o.ydisp+r,o.ybase),0),p!==o.ydisp&&(n||this._onScroll.fire(o.ydisp))}};e.BufferService=f=c([u(0,m.IOptionsService)],f)},7994:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CharsetService=void 0,e.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(t){this.glevel=t,this.charset=this._charsets[t]}setgCharset(t,c){this._charsets[t]=c,this.glevel===t&&(this.charset=c)}}},1753:function(C,e,t){var c=this&&this.__decorate||function(o,p,b,S){var k,g=arguments.length,L=g<3?p:S===null?S=Object.getOwnPropertyDescriptor(p,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(o,p,b,S);else for(var R=o.length-1;R>=0;R--)(k=o[R])&&(L=(g<3?k(L):g>3?k(p,b,L):k(p,b))||L);return g>3&&L&&Object.defineProperty(p,b,L),L},u=this&&this.__param||function(o,p){return function(b,S){p(b,S,o)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreMouseService=void 0;const a=t(2585),d=t(8460),v=t(844),m={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:o=>o.button!==4&&o.action===1&&(o.ctrl=!1,o.alt=!1,o.shift=!1,!0)},VT200:{events:19,restrict:o=>o.action!==32},DRAG:{events:23,restrict:o=>o.action!==32||o.button!==3},ANY:{events:31,restrict:o=>!0}};function f(o,p){let b=(o.ctrl?16:0)|(o.shift?4:0)|(o.alt?8:0);return o.button===4?(b|=64,b|=o.action):(b|=3&o.button,4&o.button&&(b|=64),8&o.button&&(b|=128),o.action===32?b|=32:o.action!==0||p||(b|=3)),b}const r=String.fromCharCode,n={DEFAULT:o=>{const p=[f(o,!1)+32,o.col+32,o.row+32];return p[0]>255||p[1]>255||p[2]>255?"":`\x1B[M${r(p[0])}${r(p[1])}${r(p[2])}`},SGR:o=>{const p=o.action===0&&o.button!==4?"m":"M";return`\x1B[<${f(o,!0)};${o.col};${o.row}${p}`},SGR_PIXELS:o=>{const p=o.action===0&&o.button!==4?"m":"M";return`\x1B[<${f(o,!0)};${o.x};${o.y}${p}`}};let s=e.CoreMouseService=class extends v.Disposable{constructor(o,p){super(),this._bufferService=o,this._coreService=p,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(m))this.addProtocol(b,m[b]);for(const b of Object.keys(n))this.addEncoding(b,n[b]);this.reset()}addProtocol(o,p){this._protocols[o]=p}addEncoding(o,p){this._encodings[o]=p}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(o){if(!this._protocols[o])throw new Error(`unknown protocol "${o}"`);this._activeProtocol=o,this._onProtocolChange.fire(this._protocols[o].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(o){if(!this._encodings[o])throw new Error(`unknown encoding "${o}"`);this._activeEncoding=o}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(o){if(o.col<0||o.col>=this._bufferService.cols||o.row<0||o.row>=this._bufferService.rows||o.button===4&&o.action===32||o.button===3&&o.action!==32||o.button!==4&&(o.action===2||o.action===3)||(o.col++,o.row++,o.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,o,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(o))return!1;const p=this._encodings[this._activeEncoding](o);return p&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(p):this._coreService.triggerDataEvent(p,!0)),this._lastEvent=o,!0}explainEvents(o){return{down:!!(1&o),up:!!(2&o),drag:!!(4&o),move:!!(8&o),wheel:!!(16&o)}}_equalEvents(o,p,b){if(b){if(o.x!==p.x||o.y!==p.y)return!1}else if(o.col!==p.col||o.row!==p.row)return!1;return o.button===p.button&&o.action===p.action&&o.ctrl===p.ctrl&&o.alt===p.alt&&o.shift===p.shift}};e.CoreMouseService=s=c([u(0,a.IBufferService),u(1,a.ICoreService)],s)},6975:function(C,e,t){var c=this&&this.__decorate||function(s,o,p,b){var S,k=arguments.length,g=k<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,p,b);else for(var L=s.length-1;L>=0;L--)(S=s[L])&&(g=(k<3?S(g):k>3?S(o,p,g):S(o,p))||g);return k>3&&g&&Object.defineProperty(o,p,g),g},u=this&&this.__param||function(s,o){return function(p,b){o(p,b,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreService=void 0;const a=t(1439),d=t(8460),v=t(844),m=t(2585),f=Object.freeze({insertMode:!1}),r=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let n=e.CoreService=class extends v.Disposable{constructor(s,o,p){super(),this._bufferService=s,this._logService=o,this._optionsService=p,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(f),this.decPrivateModes=(0,a.clone)(r)}reset(){this.modes=(0,a.clone)(f),this.decPrivateModes=(0,a.clone)(r)}triggerDataEvent(s,o=!1){if(this._optionsService.rawOptions.disableStdin)return;const p=this._bufferService.buffer;o&&this._optionsService.rawOptions.scrollOnUserInput&&p.ybase!==p.ydisp&&this._onRequestScrollToBottom.fire(),o&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(b=>b.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(o=>o.charCodeAt(0))),this._onBinary.fire(s))}};e.CoreService=n=c([u(0,m.IBufferService),u(1,m.ILogService),u(2,m.IOptionsService)],n)},9074:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecorationService=void 0;const c=t(8055),u=t(8460),a=t(844),d=t(6106);let v=0,m=0;class f extends a.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new d.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,a.toDisposable)(()=>this.reset()))}registerDecoration(s){if(s.marker.isDisposed)return;const o=new r(s);if(o){const p=o.marker.onDispose(()=>o.dispose());o.onDispose(()=>{o&&(this._decorations.delete(o)&&this._onDecorationRemoved.fire(o),p.dispose())}),this._decorations.insert(o),this._onDecorationRegistered.fire(o)}return o}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,o,p){let b=0,S=0;for(const k of this._decorations.getKeyIterator(o))b=k.options.x??0,S=b+(k.options.width??1),s>=b&&s<S&&(!p||(k.options.layer??"bottom")===p)&&(yield k)}forEachDecorationAtCell(s,o,p,b){this._decorations.forEachByKey(o,S=>{v=S.options.x??0,m=v+(S.options.width??1),s>=v&&s<m&&(!p||(S.options.layer??"bottom")===p)&&b(S)})}}e.DecorationService=f;class r extends a.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InstantiationService=e.ServiceCollection=void 0;const c=t(2585),u=t(8343);class a{constructor(...v){this._entries=new Map;for(const[m,f]of v)this.set(m,f)}set(v,m){const f=this._entries.get(v);return this._entries.set(v,m),f}forEach(v){for(const[m,f]of this._entries.entries())v(m,f)}has(v){return this._entries.has(v)}get(v){return this._entries.get(v)}}e.ServiceCollection=a,e.InstantiationService=class{constructor(){this._services=new a,this._services.set(c.IInstantiationService,this)}setService(d,v){this._services.set(d,v)}getService(d){return this._services.get(d)}createInstance(d,...v){const m=(0,u.getServiceDependencies)(d).sort((n,s)=>n.index-s.index),f=[];for(const n of m){const s=this._services.get(n.id);if(!s)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${n.id}.`);f.push(s)}const r=m.length>0?m[0].index:v.length;if(v.length!==r)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${r+1} conflicts with ${v.length} static arguments`);return new d(...v,...f)}}},7866:function(C,e,t){var c=this&&this.__decorate||function(r,n,s,o){var p,b=arguments.length,S=b<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,n,s,o);else for(var k=r.length-1;k>=0;k--)(p=r[k])&&(S=(b<3?p(S):b>3?p(n,s,S):p(n,s))||S);return b>3&&S&&Object.defineProperty(n,s,S),S},u=this&&this.__param||function(r,n){return function(s,o){n(s,o,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.traceCall=e.setTraceLogger=e.LogService=void 0;const a=t(844),d=t(2585),v={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let m,f=e.LogService=class extends a.Disposable{get logLevel(){return this._logLevel}constructor(r){super(),this._optionsService=r,this._logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),m=this}_updateLogLevel(){this._logLevel=v[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(r){for(let n=0;n<r.length;n++)typeof r[n]=="function"&&(r[n]=r[n]())}_log(r,n,s){this._evalLazyOptionalParams(s),r.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+n,...s)}trace(r,...n){var s;this._logLevel<=d.LogLevelEnum.TRACE&&this._log(((s=this._optionsService.options.logger)==null?void 0:s.trace.bind(this._optionsService.options.logger))??console.log,r,n)}debug(r,...n){var s;this._logLevel<=d.LogLevelEnum.DEBUG&&this._log(((s=this._optionsService.options.logger)==null?void 0:s.debug.bind(this._optionsService.options.logger))??console.log,r,n)}info(r,...n){var s;this._logLevel<=d.LogLevelEnum.INFO&&this._log(((s=this._optionsService.options.logger)==null?void 0:s.info.bind(this._optionsService.options.logger))??console.info,r,n)}warn(r,...n){var s;this._logLevel<=d.LogLevelEnum.WARN&&this._log(((s=this._optionsService.options.logger)==null?void 0:s.warn.bind(this._optionsService.options.logger))??console.warn,r,n)}error(r,...n){var s;this._logLevel<=d.LogLevelEnum.ERROR&&this._log(((s=this._optionsService.options.logger)==null?void 0:s.error.bind(this._optionsService.options.logger))??console.error,r,n)}};e.LogService=f=c([u(0,d.IOptionsService)],f),e.setTraceLogger=function(r){m=r},e.traceCall=function(r,n,s){if(typeof s.value!="function")throw new Error("not supported");const o=s.value;s.value=function(...p){if(m.logLevel!==d.LogLevelEnum.TRACE)return o.apply(this,p);m.trace(`GlyphRenderer#${o.name}(${p.map(S=>JSON.stringify(S)).join(", ")})`);const b=o.apply(this,p);return m.trace(`GlyphRenderer#${o.name} return`,b),b}}},7302:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionsService=e.DEFAULT_OPTIONS=void 0;const c=t(8460),u=t(844),a=t(6114);e.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class v extends u.Disposable{constructor(f){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const r={...e.DEFAULT_OPTIONS};for(const n in f)if(n in r)try{const s=f[n];r[n]=this._sanitizeAndValidateOption(n,s)}catch(s){console.error(s)}this.rawOptions=r,this.options={...r},this._setupOptions(),this.register((0,u.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(f,r){return this.onOptionChange(n=>{n===f&&r(this.rawOptions[f])})}onMultipleOptionChange(f,r){return this.onOptionChange(n=>{f.indexOf(n)!==-1&&r()})}_setupOptions(){const f=n=>{if(!(n in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${n}"`);return this.rawOptions[n]},r=(n,s)=>{if(!(n in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${n}"`);s=this._sanitizeAndValidateOption(n,s),this.rawOptions[n]!==s&&(this.rawOptions[n]=s,this._onOptionChange.fire(n))};for(const n in this.rawOptions){const s={get:f.bind(this,n),set:r.bind(this,n)};Object.defineProperty(this.options,n,s)}}_sanitizeAndValidateOption(f,r){switch(f){case"cursorStyle":if(r||(r=e.DEFAULT_OPTIONS[f]),!function(n){return n==="block"||n==="underline"||n==="bar"}(r))throw new Error(`"${r}" is not a valid value for ${f}`);break;case"wordSeparator":r||(r=e.DEFAULT_OPTIONS[f]);break;case"fontWeight":case"fontWeightBold":if(typeof r=="number"&&1<=r&&r<=1e3)break;r=d.includes(r)?r:e.DEFAULT_OPTIONS[f];break;case"cursorWidth":r=Math.floor(r);case"lineHeight":case"tabStopWidth":if(r<1)throw new Error(`${f} cannot be less than 1, value: ${r}`);break;case"minimumContrastRatio":r=Math.max(1,Math.min(21,Math.round(10*r)/10));break;case"scrollback":if((r=Math.min(r,4294967295))<0)throw new Error(`${f} cannot be less than 0, value: ${r}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(r<=0)throw new Error(`${f} cannot be less than or equal to 0, value: ${r}`);break;case"rows":case"cols":if(!r&&r!==0)throw new Error(`${f} must be numeric, value: ${r}`);break;case"windowsPty":r=r??{}}return r}}e.OptionsService=v},2660:function(C,e,t){var c=this&&this.__decorate||function(v,m,f,r){var n,s=arguments.length,o=s<3?m:r===null?r=Object.getOwnPropertyDescriptor(m,f):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(v,m,f,r);else for(var p=v.length-1;p>=0;p--)(n=v[p])&&(o=(s<3?n(o):s>3?n(m,f,o):n(m,f))||o);return s>3&&o&&Object.defineProperty(m,f,o),o},u=this&&this.__param||function(v,m){return function(f,r){m(f,r,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkService=void 0;const a=t(2585);let d=e.OscLinkService=class{constructor(v){this._bufferService=v,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(v){const m=this._bufferService.buffer;if(v.id===void 0){const p=m.addMarker(m.ybase+m.y),b={data:v,id:this._nextId++,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(b,p)),this._dataByLinkId.set(b.id,b),b.id}const f=v,r=this._getEntryIdKey(f),n=this._entriesWithId.get(r);if(n)return this.addLineToLink(n.id,m.ybase+m.y),n.id;const s=m.addMarker(m.ybase+m.y),o={id:this._nextId++,key:this._getEntryIdKey(f),data:f,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(o,s)),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(v,m){const f=this._dataByLinkId.get(v);if(f&&f.lines.every(r=>r.line!==m)){const r=this._bufferService.buffer.addMarker(m);f.lines.push(r),r.onDispose(()=>this._removeMarkerFromLink(f,r))}}getLinkData(v){var m;return(m=this._dataByLinkId.get(v))==null?void 0:m.data}_getEntryIdKey(v){return`${v.id};;${v.uri}`}_removeMarkerFromLink(v,m){const f=v.lines.indexOf(m);f!==-1&&(v.lines.splice(f,1),v.lines.length===0&&(v.data.id!==void 0&&this._entriesWithId.delete(v.key),this._dataByLinkId.delete(v.id)))}};e.OscLinkService=d=c([u(0,a.IBufferService)],d)},8343:(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0;const t="di$target",c="di$dependencies";e.serviceRegistry=new Map,e.getServiceDependencies=function(u){return u[c]||[]},e.createDecorator=function(u){if(e.serviceRegistry.has(u))return e.serviceRegistry.get(u);const a=function(d,v,m){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,r,n){r[t]===r?r[c].push({id:f,index:n}):(r[c]=[{id:f,index:n}],r[t]=r)})(a,d,m)};return a.toString=()=>u,e.serviceRegistry.set(u,a),a}},2585:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;const c=t(8343);var u;e.IBufferService=(0,c.createDecorator)("BufferService"),e.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),e.ICoreService=(0,c.createDecorator)("CoreService"),e.ICharsetService=(0,c.createDecorator)("CharsetService"),e.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(a){a[a.TRACE=0]="TRACE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.OFF=5]="OFF"}(u||(e.LogLevelEnum=u={})),e.ILogService=(0,c.createDecorator)("LogService"),e.IOptionsService=(0,c.createDecorator)("OptionsService"),e.IOscLinkService=(0,c.createDecorator)("OscLinkService"),e.IUnicodeService=(0,c.createDecorator)("UnicodeService"),e.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(C,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeService=void 0;const c=t(8460),u=t(225);class a{static extractShouldJoin(v){return(1&v)!=0}static extractWidth(v){return v>>1&3}static extractCharKind(v){return v>>3}static createPropertyValue(v,m,f=!1){return(16777215&v)<<3|(3&m)<<1|(f?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const v=new u.UnicodeV6;this.register(v),this._active=v.version,this._activeProvider=v}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(v){if(!this._providers[v])throw new Error(`unknown Unicode version "${v}"`);this._active=v,this._activeProvider=this._providers[v],this._onChange.fire(v)}register(v){this._providers[v.version]=v}wcwidth(v){return this._activeProvider.wcwidth(v)}getStringCellWidth(v){let m=0,f=0;const r=v.length;for(let n=0;n<r;++n){let s=v.charCodeAt(n);if(55296<=s&&s<=56319){if(++n>=r)return m+this.wcwidth(s);const b=v.charCodeAt(n);56320<=b&&b<=57343?s=1024*(s-55296)+b-56320+65536:m+=this.wcwidth(b)}const o=this.charProperties(s,f);let p=a.extractWidth(o);a.extractShouldJoin(o)&&(p-=a.extractWidth(f)),m+=p,f=o}return m}charProperties(v,m){return this._activeProvider.charProperties(v,m)}}e.UnicodeService=a}},_={};function y(C){var e=_[C];if(e!==void 0)return e.exports;var t=_[C]={exports:{}};return l[C].call(t.exports,t,t.exports,y),t.exports}var w={};return(()=>{var C=w;Object.defineProperty(C,"__esModule",{value:!0}),C.Terminal=void 0;const e=y(9042),t=y(3236),c=y(844),u=y(5741),a=y(8285),d=y(7975),v=y(7090),m=["cols","rows"];class f extends c.Disposable{constructor(n){super(),this._core=this.register(new t.Terminal(n)),this._addonManager=this.register(new u.AddonManager),this._publicOptions={...this._core.options};const s=p=>this._core.options[p],o=(p,b)=>{this._checkReadonlyOptions(p),this._core.options[p]=b};for(const p in this._core.options){const b={get:s.bind(this,p),set:o.bind(this,p)};Object.defineProperty(this._publicOptions,p,b)}}_checkReadonlyOptions(n){if(m.includes(n))throw new Error(`Option "${n}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new d.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const n=this._core.coreService.decPrivateModes;let s="none";switch(this._core.coreMouseService.activeProtocol){case"X10":s="x10";break;case"VT200":s="vt200";break;case"DRAG":s="drag";break;case"ANY":s="any"}return{applicationCursorKeysMode:n.applicationCursorKeys,applicationKeypadMode:n.applicationKeypad,bracketedPasteMode:n.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:s,originMode:n.origin,reverseWraparoundMode:n.reverseWraparound,sendFocusMode:n.sendFocus,wraparoundMode:n.wraparound}}get options(){return this._publicOptions}set options(n){for(const s in n)this._publicOptions[s]=n[s]}blur(){this._core.blur()}focus(){this._core.focus()}input(n,s=!0){this._core.input(n,s)}resize(n,s){this._verifyIntegers(n,s),this._core.resize(n,s)}open(n){this._core.open(n)}attachCustomKeyEventHandler(n){this._core.attachCustomKeyEventHandler(n)}attachCustomWheelEventHandler(n){this._core.attachCustomWheelEventHandler(n)}registerLinkProvider(n){return this._core.registerLinkProvider(n)}registerCharacterJoiner(n){return this._checkProposedApi(),this._core.registerCharacterJoiner(n)}deregisterCharacterJoiner(n){this._checkProposedApi(),this._core.deregisterCharacterJoiner(n)}registerMarker(n=0){return this._verifyIntegers(n),this._core.registerMarker(n)}registerDecoration(n){return this._checkProposedApi(),this._verifyPositiveIntegers(n.x??0,n.width??0,n.height??0),this._core.registerDecoration(n)}hasSelection(){return this._core.hasSelection()}select(n,s,o){this._verifyIntegers(n,s,o),this._core.select(n,s,o)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(n,s){this._verifyIntegers(n,s),this._core.selectLines(n,s)}dispose(){super.dispose()}scrollLines(n){this._verifyIntegers(n),this._core.scrollLines(n)}scrollPages(n){this._verifyIntegers(n),this._core.scrollPages(n)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(n){this._verifyIntegers(n),this._core.scrollToLine(n)}clear(){this._core.clear()}write(n,s){this._core.write(n,s)}writeln(n,s){this._core.write(n),this._core.write(`\r
`,s)}paste(n){this._core.paste(n)}refresh(n,s){this._verifyIntegers(n,s),this._core.refresh(n,s)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(n){this._addonManager.loadAddon(this,n)}static get strings(){return e}_verifyIntegers(...n){for(const s of n)if(s===1/0||isNaN(s)||s%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...n){for(const s of n)if(s&&(s===1/0||isNaN(s)||s%1!=0||s<0))throw new Error("This API only accepts positive integers")}}C.Terminal=f})(),w})())})(Mi);var ur=Mi.exports,Oi={exports:{}};(function(h,i){(function(l,_){h.exports=_()})(self,()=>(()=>{var l={};return(()=>{var _=l;Object.defineProperty(_,"__esModule",{value:!0}),_.FitAddon=void 0,_.FitAddon=class{activate(y){this._terminal=y}dispose(){}fit(){const y=this.proposeDimensions();if(!y||!this._terminal||isNaN(y.cols)||isNaN(y.rows))return;const w=this._terminal._core;this._terminal.rows===y.rows&&this._terminal.cols===y.cols||(w._renderService.clear(),this._terminal.resize(y.cols,y.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const y=this._terminal._core,w=y._renderService.dimensions;if(w.css.cell.width===0||w.css.cell.height===0)return;const C=this._terminal.options.scrollback===0?0:y.viewport.scrollBarWidth,e=window.getComputedStyle(this._terminal.element.parentElement),t=parseInt(e.getPropertyValue("height")),c=Math.max(0,parseInt(e.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),a=t-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),d=c-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-C;return{cols:Math.max(2,Math.floor(d/w.css.cell.width)),rows:Math.max(1,Math.floor(a/w.css.cell.height))}}}})(),l})())})(Oi);var dr=Oi.exports,Pi={exports:{}};(function(h,i){(function(l,_){h.exports=_()})(self,()=>(()=>{var l={6:(C,e)=>{function t(u){try{const a=new URL(u),d=a.password&&a.username?`${a.protocol}//${a.username}:${a.password}@${a.host}`:a.username?`${a.protocol}//${a.username}@${a.host}`:`${a.protocol}//${a.host}`;return u.toLocaleLowerCase().startsWith(d.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.LinkComputer=e.WebLinkProvider=void 0,e.WebLinkProvider=class{constructor(u,a,d,v={}){this._terminal=u,this._regex=a,this._handler=d,this._options=v}provideLinks(u,a){const d=c.computeLink(u,this._regex,this._terminal,this._handler);a(this._addCallbacks(d))}_addCallbacks(u){return u.map(a=>(a.leave=this._options.leave,a.hover=(d,v)=>{if(this._options.hover){const{range:m}=a;this._options.hover(d,v,m)}},a))}};class c{static computeLink(a,d,v,m){const f=new RegExp(d.source,(d.flags||"")+"g"),[r,n]=c._getWindowedLineStrings(a-1,v),s=r.join("");let o;const p=[];for(;o=f.exec(s);){const b=o[0];if(!t(b))continue;const[S,k]=c._mapStrIdx(v,n,0,o.index),[g,L]=c._mapStrIdx(v,S,k,b.length);if(S===-1||k===-1||g===-1||L===-1)continue;const R={start:{x:k+1,y:S+1},end:{x:L,y:g+1}};p.push({range:R,text:b,activate:m})}return p}static _getWindowedLineStrings(a,d){let v,m=a,f=a,r=0,n="";const s=[];if(v=d.buffer.active.getLine(a)){const o=v.translateToString(!0);if(v.isWrapped&&o[0]!==" "){for(r=0;(v=d.buffer.active.getLine(--m))&&r<2048&&(n=v.translateToString(!0),r+=n.length,s.push(n),v.isWrapped&&n.indexOf(" ")===-1););s.reverse()}for(s.push(o),r=0;(v=d.buffer.active.getLine(++f))&&v.isWrapped&&r<2048&&(n=v.translateToString(!0),r+=n.length,s.push(n),n.indexOf(" ")===-1););}return[s,m]}static _mapStrIdx(a,d,v,m){const f=a.buffer.active,r=f.getNullCell();let n=v;for(;m;){const s=f.getLine(d);if(!s)return[-1,-1];for(let o=n;o<s.length;++o){s.getCell(o,r);const p=r.getChars();if(r.getWidth()&&(m-=p.length||1,o===s.length-1&&p==="")){const b=f.getLine(d+1);b&&b.isWrapped&&(b.getCell(0,r),r.getWidth()===2&&(m+=1))}if(m<0)return[d,o]}d++,n=0}return[d,n]}}e.LinkComputer=c}},_={};function y(C){var e=_[C];if(e!==void 0)return e.exports;var t=_[C]={exports:{}};return l[C](t,t.exports,y),t.exports}var w={};return(()=>{var C=w;Object.defineProperty(C,"__esModule",{value:!0}),C.WebLinksAddon=void 0;const e=y(6),t=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function c(u,a){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=a}else console.warn("Opening link blocked as opener could not be cleared")}C.WebLinksAddon=class{constructor(u=c,a={}){this._handler=u,this._options=a}activate(u){this._terminal=u;const a=this._options,d=a.urlRegex||t;this._linkProvider=this._terminal.registerLinkProvider(new e.WebLinkProvider(this._terminal,d,this._handler,a))}dispose(){var u;(u=this._linkProvider)==null||u.dispose()}}})(),w})())})(Pi);var fr=Pi.exports;const ys=5,_r=2e3,pr=25e3,vr=`\x1B[38;5;46m\r
  âââââââ âââââââââââ  âââââââââââ âââââââ\r
  ââââââââââââââââââââââââââââââââââââââââ\r
  ââââââââââââââ   ââââââ ââââââ  âââ\r
  ââââââââââââââ   ââââââ ââââââ  âââ\r
  âââ  âââââââââââââââ âââââââââââââââââââ\r
  âââ  ââââââââââââââ  âââââââââââ âââââââ\r
\x1B[0m\x1B[38;5;243m  Terminal as a Service Â· rexec.dev\x1B[0m\r
\r
`,gr={cursorBlink:!0,cursorStyle:"bar",fontSize:14,fontFamily:'"JetBrains Mono", "Fira Code", Menlo, Monaco, monospace',theme:{background:"#0a0a0a",foreground:"#e0e0e0",cursor:"#00ff41",cursorAccent:"#0a0a0a",selectionBackground:"rgba(0, 255, 65, 0.3)",black:"#0a0a0a",red:"#ff003c",green:"#00ff41",yellow:"#fcee0a",blue:"#00a0dc",magenta:"#ff00ff",cyan:"#00ffff",white:"#e0e0e0",brightBlack:"#666666",brightRed:"#ff5555",brightGreen:"#55ff55",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"},allowProposedApi:!0,scrollback:5e3},Xt={sessions:new Map,activeSessionId:null,viewMode:"floating",isMinimized:!1,floatingPosition:{x:100,y:100},floatingSize:{width:700,height:500}};function mr(){if(typeof window>"u")return{};try{const h=localStorage.getItem("rexec_terminal_prefs");if(h){const i=JSON.parse(h);return{viewMode:i.viewMode||"floating",floatingPosition:i.floatingPosition||Xt.floatingPosition,floatingSize:i.floatingSize||Xt.floatingSize}}}catch(h){console.error("Failed to load terminal preferences:",h)}return{}}function Gt(h){try{localStorage.setItem("rexec_terminal_prefs",JSON.stringify({viewMode:h.viewMode,floatingPosition:h.floatingPosition,floatingSize:h.floatingSize}))}catch(i){console.error("Failed to save terminal preferences:",i)}}function Sr(){return`session-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function br(){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}`}function Cr(){const h={...Xt,...mr()},{subscribe:i,update:l}=Rt(h),_=()=>{let w;return i(C=>w=C)(),w},y=(w,C)=>{l(e=>{const t=e.sessions.get(w);return t&&e.sessions.set(w,C(t)),{...e}})};return{subscribe:i,getState:_,createSession(w,C){const e=_();if(!bt(wt))return null;const c=Array.from(e.sessions.values()).find(u=>u.containerId===w);return c?(l(u=>({...u,activeSessionId:c.id})),this.updateUrl(w),c.id):this.createNewTab(w,C)},createNewTab(w,C){if(!bt(wt))return null;const t=_(),c=Array.from(t.sessions.values()).filter(f=>f.containerId===w).length,u=new ur.Terminal(gr),a=new dr.FitAddon;u.loadAddon(a),u.loadAddon(new fr.WebLinksAddon);const d=Sr(),v=c>0?`${C} (${c+1})`:C,m={id:d,containerId:w,name:v,terminal:u,fitAddon:a,ws:null,status:"connecting",reconnectAttempts:0,reconnectTimer:null,pingInterval:null,resizeObserver:null,isSettingUp:!1,setupMessage:""};return l(f=>(f.sessions.set(d,m),{...f,activeSessionId:d,isMinimized:!1})),this.updateUrl(w),d},updateUrl(w){const C=`/${w}`;window.location.pathname!==C&&window.history.pushState({containerId:w},"",C)},clearUrl(){window.location.pathname!=="/"&&window.history.pushState({},"","/")},connectWebSocket(w){const e=_().sessions.get(w);if(!e)return;const t=bt(wt);if(!t||e.ws&&(e.ws.readyState===WebSocket.OPEN||e.ws.readyState===WebSocket.CONNECTING))return;e.reconnectTimer&&clearTimeout(e.reconnectTimer),e.pingInterval&&clearInterval(e.pingInterval);const c=`${br()}/ws/terminal/${e.containerId}?token=${t}`,u=new WebSocket(c);y(w,a=>({...a,ws:u,status:"connecting"})),u.onopen=()=>{y(w,d=>({...d,status:"connected",reconnectAttempts:0})),u.send(JSON.stringify({type:"resize",cols:e.terminal.cols,rows:e.terminal.rows})),setTimeout(()=>{e.terminal.clear(),e.terminal.write(vr),e.terminal.writeln("\x1B[32mâ¡ Connected\x1B[0m"),e.terminal.writeln(`\x1B[38;5;243m  Type 'help' for tips & shortcuts\x1B[0m\r
`)},100);const a=setInterval(()=>{u.readyState===WebSocket.OPEN&&u.send(JSON.stringify({type:"ping"}))},pr);y(w,d=>({...d,pingInterval:a}))},u.onmessage=a=>{try{const d=JSON.parse(a.data);if(d.type==="output"){const v=d.data;if([/installing/i,/setting up/i,/configuring/i,/downloading/i,/unpacking/i,/processing/i,/apt.*get/i,/apk.*add/i,/yum.*install/i,/dnf.*install/i].some(r=>r.test(v))){const r=v.split(`
`).filter(o=>o.trim()),n=r[r.length-1]||"",s=n.slice(0,50)+(n.length>50?"...":"");y(w,o=>({...o,isSettingUp:!0,setupMessage:s})),setTimeout(()=>{y(w,o=>({...o,isSettingUp:!1,setupMessage:""}))},3e3)}e.terminal.write(v)}else d.type==="error"?e.terminal.writeln(`\r
\x1B[31mError: ${d.data}\x1B[0m`):d.type==="ping"?u.send(JSON.stringify({type:"pong"})):d.type==="setup"?y(w,v=>({...v,isSettingUp:!0,setupMessage:d.message||"Setting up environment..."})):d.type==="setup_complete"&&y(w,v=>({...v,isSettingUp:!1,setupMessage:""}))}catch{e.terminal.write(a.data)}},u.onclose=()=>{y(w,d=>({...d,status:"disconnected"}));const a=_().sessions.get(w);if(a)if(a.pingInterval&&clearInterval(a.pingInterval),a.reconnectAttempts<ys){y(w,v=>({...v,status:"connecting",reconnectAttempts:v.reconnectAttempts+1})),e.terminal.writeln(`\r
\x1B[33mReconnecting (${a.reconnectAttempts+1}/${ys})...\x1B[0m`);const d=setTimeout(()=>{this.connectWebSocket(w)},_r);y(w,v=>({...v,reconnectTimer:d}))}else e.terminal.writeln(`\r
\x1B[31mConnection lost. Click reconnect to try again.\x1B[0m`)},u.onerror=()=>{e.terminal.writeln(`\r
\x1B[31mWebSocket error\x1B[0m`)},e.terminal.onData(a=>{u.readyState===WebSocket.OPEN&&u.send(JSON.stringify({type:"input",data:a}))})},reconnectSession(w){y(w,C=>({...C,reconnectAttempts:0})),this.connectWebSocket(w)},closeSession(w){const e=_().sessions.get(w);e&&(e.ws&&e.ws.close(),e.pingInterval&&clearInterval(e.pingInterval),e.reconnectTimer&&clearTimeout(e.reconnectTimer),e.resizeObserver&&e.resizeObserver.disconnect(),e.terminal&&e.terminal.dispose(),l(t=>{t.sessions.delete(w);let c=null;if(t.activeSessionId===w){const u=Array.from(t.sessions.keys());c=u.length>0?u[u.length-1]:null}else c=t.activeSessionId;if(c){const u=t.sessions.get(c);u&&this.updateUrl(u.containerId)}else this.clearUrl();return{...t,activeSessionId:c}}))},closeAllSessions(){_().sessions.forEach((C,e)=>this.closeSession(e)),this.clearUrl()},setActiveSession(w){const e=_().sessions.get(w);e&&this.updateUrl(e.containerId),l(t=>({...t,activeSessionId:w}))},setViewMode(w){l(C=>{const e={...C,viewMode:w};return Gt(e),e})},toggleViewMode(){const w=_();this.setViewMode(w.viewMode==="floating"?"docked":"floating")},minimize(){l(w=>({...w,isMinimized:!0}))},restore(){l(w=>({...w,isMinimized:!1}))},setFloatingPosition(w,C){l(e=>{const t={...e,floatingPosition:{x:w,y:C}};return Gt(t),t})},setFloatingSize(w,C){l(e=>{const t={...e,floatingSize:{width:w,height:C}};return Gt(t),t})},fitAll(){_().sessions.forEach(C=>{var e;try{C.fitAddon.fit(),((e=C.ws)==null?void 0:e.readyState)===WebSocket.OPEN&&C.ws.send(JSON.stringify({type:"resize",cols:C.terminal.cols,rows:C.terminal.rows}))}catch(t){console.error("Failed to fit terminal:",t)}})},fitSession(w){var t;const e=_().sessions.get(w);if(e)try{e.fitAddon.fit(),((t=e.ws)==null?void 0:t.readyState)===WebSocket.OPEN&&e.ws.send(JSON.stringify({type:"resize",cols:e.terminal.cols,rows:e.terminal.rows}))}catch(c){console.error("Failed to fit terminal:",c)}},attachTerminal(w,C){const t=_().sessions.get(w);if(!(!t||!C)){if(t.resizeObserver&&t.resizeObserver.disconnect(),t.terminal.open(C),window.ResizeObserver){const c=new ResizeObserver(()=>{this.fitSession(w)});c.observe(C),y(w,u=>({...u,resizeObserver:c}))}setTimeout(()=>this.fitSession(w),50),setTimeout(()=>this.fitSession(w),150),setTimeout(()=>this.fitSession(w),300)}},reattachTerminal(w,C){const t=_().sessions.get(w);if(!(!t||!C)){if(t.resizeObserver&&t.resizeObserver.disconnect(),C.innerHTML="",t.terminal.open(C),window.ResizeObserver){const c=new ResizeObserver(()=>{this.fitSession(w)});c.observe(C),y(w,u=>({...u,resizeObserver:c}))}setTimeout(()=>{this.fitSession(w),t.terminal.focus()},50),setTimeout(()=>this.fitSession(w),150)}},writeToSession(w,C){const t=_().sessions.get(w);t&&t.terminal.write(C)},writeLineToSession(w,C){const t=_().sessions.get(w);t&&t.terminal.writeln(C)},getSessionByContainerId(w){const C=_();return Array.from(C.sessions.values()).find(e=>e.containerId===w)},hasActiveSession(w){return!!this.getSessionByContainerId(w)},getActiveContainerId(){const w=_();if(!w.activeSessionId)return null;const C=w.sessions.get(w.activeSessionId);return(C==null?void 0:C.containerId)||null}}}const _e=Cr(),wr=ke(_e,h=>h.activeSessionId?h.sessions.get(h.activeSessionId):null),Ii=ke(_e,h=>h.sessions.size),yr=ke(_e,h=>h.sessions.size>0),kr=ke(_e,h=>h.viewMode==="floating");ke(_e,h=>h.viewMode==="docked");const ks={toasts:[]};function Er(){return`toast-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function Lr(){const{subscribe:h,update:i}=Rt(ks),l=new Map;return{subscribe:h,show(_,y="info",w={}){const{duration:C=y==="loading"?0:5e3,dismissible:e=!0,id:t=Er()}=w;this.dismiss(t);const c={id:t,type:y,message:_,duration:C,dismissible:e};if(i(u=>({...u,toasts:[...u.toasts,c]})),C>0){const u=setTimeout(()=>{this.dismiss(t)},C);l.set(t,u)}return t},success(_,y){return this.show(_,"success",y)},error(_,y){return this.show(_,"error",{duration:8e3,...y})},warning(_,y){return this.show(_,"warning",y)},info(_,y){return this.show(_,"info",y)},loading(_,y){return this.show(_,"loading",{duration:0,dismissible:!1,...y})},dismiss(_){const y=l.get(_);y&&(clearTimeout(y),l.delete(_)),i(w=>({...w,toasts:w.toasts.filter(C=>C.id!==_)}))},dismissAll(){l.forEach(_=>clearTimeout(_)),l.clear(),i(()=>ks)},update(_,y,w,C=5e3){const e=l.get(_);if(e&&(clearTimeout(e),l.delete(_)),i(t=>({...t,toasts:t.toasts.map(c=>c.id===_?{...c,message:y,type:w,duration:C,dismissible:!0}:c)})),C>0){const t=setTimeout(()=>{this.dismiss(_)},C);l.set(_,t)}},async promise(_,y){const w=this.loading(y.loading);try{const C=await _,e=typeof y.success=="function"?y.success(C):y.success;return this.update(w,e,"success"),C}catch(C){const e=typeof y.error=="function"?y.error(C):y.error;throw this.update(w,e,"error",8e3),C}}}}const he=Lr(),Dr=ke(he,h=>h.toasts);ke(he,h=>h.toasts.length);const{window:Rr}=bi;function Es(h){let i,l;return{c(){i=T("span"),l=se(h[1]),A(i,"class","session-badge svelte-muaygb")},m(_,y){ee(_,i,y),E(i,l)},p(_,y){y&2&&ne(l,_[1])},d(_){_&&Q(i)}}}function Ar(h){let i,l,_,y,w;return{c(){i=T("button"),i.textContent="Try as Guest",l=U(),_=T("button"),_.textContent="Sign in with PipeOps",A(i,"class","btn btn-secondary btn-sm"),A(_,"class","btn btn-primary btn-sm")},m(C,e){ee(C,i,e),ee(C,l,e),ee(C,_,e),y||(w=[Z(i,"click",h[6]),Z(_,"click",h[7])],y=!0)},p:ie,d(C){C&&(Q(i),Q(l),Q(_)),y=!1,fe(w)}}}function Tr(h){var p,b,S;let i,l,_,y,w,C=(((b=(p=h[3].user)==null?void 0:p.name)==null?void 0:b.charAt(0).toUpperCase())||"U")+"",e,t,c,u=(((S=h[3].user)==null?void 0:S.name)||"User")+"",a,d,v,m,f,r,n,s=h[4]&&Ls(),o=h[0]&&Ds(h);return{c(){i=T("button"),i.textContent="+ New Terminal",l=U(),_=T("div"),y=T("button"),w=T("span"),e=se(C),t=U(),c=T("span"),a=se(u),d=U(),s&&s.c(),v=U(),m=T("span"),m.textContent="â¼",f=U(),o&&o.c(),A(i,"class","btn btn-primary btn-sm"),A(w,"class","user-avatar svelte-muaygb"),A(c,"class","user-name svelte-muaygb"),A(m,"class","dropdown-arrow svelte-muaygb"),A(y,"class","user-badge svelte-muaygb"),A(_,"class","user-menu-container svelte-muaygb")},m(k,g){ee(k,i,g),ee(k,l,g),ee(k,_,g),E(_,y),E(y,w),E(w,e),E(y,t),E(y,c),E(c,a),E(y,d),s&&s.m(y,null),E(y,v),E(y,m),E(_,f),o&&o.m(_,null),r||(n=[Z(i,"click",h[12]),Z(y,"click",Et(h[9]))],r=!0)},p(k,g){var L,R,x;g&8&&C!==(C=(((R=(L=k[3].user)==null?void 0:L.name)==null?void 0:R.charAt(0).toUpperCase())||"U")+"")&&ne(e,C),g&8&&u!==(u=(((x=k[3].user)==null?void 0:x.name)||"User")+"")&&ne(a,u),k[4]?s||(s=Ls(),s.c(),s.m(y,v)):s&&(s.d(1),s=null),k[0]?o?o.p(k,g):(o=Ds(k),o.c(),o.m(_,null)):o&&(o.d(1),o=null)},d(k){k&&(Q(i),Q(l),Q(_)),s&&s.d(),o&&o.d(),r=!1,fe(n)}}}function Ls(h){let i;return{c(){i=T("span"),i.textContent="Guest",A(i,"class","guest-badge svelte-muaygb")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Ds(h){var I,F,V,X;let i,l,_,y=(((I=h[3].user)==null?void 0:I.name)||"User")+"",w,C,e,t,c=(((V=(F=h[3].user)==null?void 0:F.tier)==null?void 0:V.toUpperCase())||"FREE")+"",u,a,d,v,m,f,r,n,s,o,p,b,S,k,g,L,R,x,O,B,H,N,W=((X=h[3].user)==null?void 0:X.email)&&Rs(h),$=!h[4]&&As(h),j=h[4]&&Ts(),D=h[4]&&Bs(),P=h[4]&&Ms(h);return{c(){i=T("div"),l=T("div"),_=T("span"),w=se(y),C=U(),W&&W.c(),e=U(),t=T("span"),u=se(c),a=se(" Plan"),d=U(),v=T("div"),m=U(),$&&$.c(),f=U(),r=T("button"),n=T("span"),n.textContent="âï¸",s=se(`
              Settings
              `),j&&j.c(),p=U(),b=T("button"),S=T("span"),S.textContent="ð",k=se(`
              SSH Keys
              `),D&&D.c(),L=U(),P&&P.c(),R=U(),x=T("div"),O=U(),B=T("button"),B.innerHTML=`<span>ðª</span>
              Sign Out`,A(_,"class","user-menu-name svelte-muaygb"),A(t,"class","user-menu-tier svelte-muaygb"),A(l,"class","user-menu-header svelte-muaygb"),A(v,"class","user-menu-divider svelte-muaygb"),A(r,"class","user-menu-item svelte-muaygb"),r.disabled=h[4],A(r,"title",o=h[4]?"Sign in with PipeOps to access Settings":""),le(r,"disabled",h[4]),A(b,"class","user-menu-item svelte-muaygb"),b.disabled=h[4],A(b,"title",g=h[4]?"Sign in with PipeOps to manage SSH Keys":""),le(b,"disabled",h[4]),A(x,"class","user-menu-divider svelte-muaygb"),A(B,"class","user-menu-item danger svelte-muaygb"),A(i,"class","user-menu svelte-muaygb")},m(Y,J){ee(Y,i,J),E(i,l),E(l,_),E(_,w),E(l,C),W&&W.m(l,null),E(l,e),E(l,t),E(t,u),E(t,a),E(i,d),E(i,v),E(i,m),$&&$.m(i,null),E(i,f),E(i,r),E(r,n),E(r,s),j&&j.m(r,null),E(i,p),E(i,b),E(b,S),E(b,k),D&&D.m(b,null),E(i,L),P&&P.m(i,null),E(i,R),E(i,x),E(i,O),E(i,B),H||(N=[Z(r,"click",h[14]),Z(b,"click",h[15]),Z(B,"click",h[8])],H=!0)},p(Y,J){var z,M,K,q;J&8&&y!==(y=(((z=Y[3].user)==null?void 0:z.name)||"User")+"")&&ne(w,y),(M=Y[3].user)!=null&&M.email?W?W.p(Y,J):(W=Rs(Y),W.c(),W.m(l,e)):W&&(W.d(1),W=null),J&8&&c!==(c=(((q=(K=Y[3].user)==null?void 0:K.tier)==null?void 0:q.toUpperCase())||"FREE")+"")&&ne(u,c),Y[4]?$&&($.d(1),$=null):$?$.p(Y,J):($=As(Y),$.c(),$.m(i,f)),Y[4]?j||(j=Ts(),j.c(),j.m(r,null)):j&&(j.d(1),j=null),J&16&&(r.disabled=Y[4]),J&16&&o!==(o=Y[4]?"Sign in with PipeOps to access Settings":"")&&A(r,"title",o),J&16&&le(r,"disabled",Y[4]),Y[4]?D||(D=Bs(),D.c(),D.m(b,null)):D&&(D.d(1),D=null),J&16&&(b.disabled=Y[4]),J&16&&g!==(g=Y[4]?"Sign in with PipeOps to manage SSH Keys":"")&&A(b,"title",g),J&16&&le(b,"disabled",Y[4]),Y[4]?P?P.p(Y,J):(P=Ms(Y),P.c(),P.m(i,R)):P&&(P.d(1),P=null)},d(Y){Y&&Q(i),W&&W.d(),$&&$.d(),j&&j.d(),D&&D.d(),P&&P.d(),H=!1,fe(N)}}}function Rs(h){let i,l=h[3].user.email+"",_;return{c(){i=T("span"),_=se(l),A(i,"class","user-menu-email svelte-muaygb")},m(y,w){ee(y,i,w),E(i,_)},p(y,w){w&8&&l!==(l=y[3].user.email+"")&&ne(_,l)},d(y){y&&Q(i)}}}function As(h){let i,l,_;return{c(){i=T("button"),i.innerHTML=`<span>ð</span>
                Dashboard`,A(i,"class","user-menu-item svelte-muaygb")},m(y,w){ee(y,i,w),l||(_=Z(i,"click",h[13]),l=!0)},p:ie,d(y){y&&Q(i),l=!1,_()}}}function Ts(h){let i;return{c(){i=T("span"),i.textContent="ð",A(i,"class","lock-icon svelte-muaygb")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Bs(h){let i;return{c(){i=T("span"),i.textContent="ð",A(i,"class","lock-icon svelte-muaygb")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Ms(h){let i,l,_,y,w;return{c(){i=T("div"),l=U(),_=T("button"),_.innerHTML=`<span>ð</span>
                Sign in with PipeOps`,A(i,"class","user-menu-divider svelte-muaygb"),A(_,"class","user-menu-item accent svelte-muaygb")},m(C,e){ee(C,i,e),ee(C,l,e),ee(C,_,e),y||(w=Z(_,"click",h[7]),y=!0)},p:ie,d(C){C&&(Q(i),Q(l),Q(_)),y=!1,w()}}}function Br(h){let i,l,_,y,w,C,e,t,c,u,a=h[1]>0&&Es(h);function d(f,r){return f[2]?Tr:Ar}let v=d(h),m=v(h);return{c(){i=T("header"),l=T("button"),_=T("span"),_.textContent="R",y=U(),w=T("span"),w.textContent="Rexec",C=U(),a&&a.c(),e=U(),t=T("nav"),m.c(),A(_,"class","logo-icon svelte-muaygb"),A(w,"class","logo-text svelte-muaygb"),A(l,"class","logo svelte-muaygb"),A(t,"class","nav-actions svelte-muaygb"),A(i,"class","header svelte-muaygb")},m(f,r){ee(f,i,r),E(i,l),E(l,_),E(l,y),E(l,w),E(l,C),a&&a.m(l,null),E(i,e),E(i,t),m.m(t,null),c||(u=[Z(Rr,"click",h[10]),Z(l,"click",h[11])],c=!0)},p(f,[r]){f[1]>0?a?a.p(f,r):(a=Es(f),a.c(),a.m(l,null)):a&&(a.d(1),a=null),v===(v=d(f))&&m?m.p(f,r):(m.d(1),m=v(f),m&&(m.c(),m.m(t,null)))},i:ie,o:ie,d(f){f&&Q(i),a&&a.d(),m.d(),c=!1,fe(u)}}}function Mr(h,i,l){let _,y,w,C;be(h,Ii,o=>l(1,_=o)),be(h,Ti,o=>l(2,y=o)),be(h,ye,o=>l(3,w=o)),be(h,rs,o=>l(4,C=o));const e=pt();let t=!1;function c(){e("guest")}async function u(){const o=await ye.getOAuthUrl();o&&(window.location.href=o)}function a(){l(0,t=!1),ye.logout()}function d(){l(0,t=!t)}function v(o){o.target.closest(".user-menu-container")||l(0,t=!1)}return[t,_,y,w,C,e,c,u,a,d,v,()=>e("home"),()=>e("create"),()=>{l(0,t=!1),e("home")},()=>{C||(l(0,t=!1),e("settings"))},()=>{C||(l(0,t=!1),e("sshkeys"))}]}class xr extends Ue{constructor(i){super(),Ne(this,i,Mr,Br,Pe,{})}}function Or(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s;return{c(){i=T("div"),l=T("div"),_=T("div"),_.innerHTML='<span class="dot svelte-13obf84"></span> <span>Terminal as a Service</span>',y=U(),w=T("h1"),w.innerHTML=`Instant <span class="accent svelte-13obf84">Linux</span> Terminals
      <br/>
      In Your Browser`,C=U(),e=T("p"),e.textContent=`Launch isolated containers with full shell access. No setup required.
      Choose from Ubuntu, Debian, Alpine, Fedora, and more.`,t=U(),c=T("div"),u=T("button"),u.textContent="Try Now â No Sign Up",a=U(),d=T("button"),d.textContent="Sign in with PipeOps",v=U(),m=T("div"),m.innerHTML='<div class="terminal-preview-header svelte-13obf84"><span class="terminal-dot dot-red svelte-13obf84"></span> <span class="terminal-dot dot-yellow svelte-13obf84"></span> <span class="terminal-dot dot-green svelte-13obf84"></span> <span class="terminal-title svelte-13obf84">ubuntu-24 â rexec</span></div> <div class="terminal-preview-body svelte-13obf84"><div class="terminal-line svelte-13obf84"><span class="prompt svelte-13obf84">root@rexec:~#</span> <span class="command svelte-13obf84">whoami</span></div> <div class="terminal-output svelte-13obf84">root</div> <div class="terminal-line svelte-13obf84"><span class="prompt svelte-13obf84">root@rexec:~#</span> <span class="command svelte-13obf84">uname -a</span></div> <div class="terminal-output svelte-13obf84">Linux rexec 6.5.0-44-generic #44-Ubuntu SMP x86_64 GNU/Linux</div> <div class="terminal-line svelte-13obf84"><span class="prompt svelte-13obf84">root@rexec:~#</span> <span class="cursor svelte-13obf84">_</span></div></div>',f=U(),r=T("div"),r.innerHTML='<div class="feature svelte-13obf84"><span class="feature-icon svelte-13obf84">â¡</span> <h3 class="svelte-13obf84">Instant</h3> <p class="svelte-13obf84">Containers launch in seconds with pre-configured shells</p></div> <div class="feature svelte-13obf84"><span class="feature-icon svelte-13obf84">ð</span> <h3 class="svelte-13obf84">Isolated</h3> <p class="svelte-13obf84">Each container is fully isolated with its own filesystem</p></div> <div class="feature svelte-13obf84"><span class="feature-icon svelte-13obf84">ð</span> <h3 class="svelte-13obf84">Accessible</h3> <p class="svelte-13obf84">Access from any browser, anywhere. SSH support included</p></div>',A(_,"class","landing-badge svelte-13obf84"),A(w,"class","svelte-13obf84"),A(e,"class","description svelte-13obf84"),A(u,"class","btn btn-primary btn-lg"),A(d,"class","btn btn-secondary btn-lg"),A(c,"class","landing-actions svelte-13obf84"),A(m,"class","terminal-preview svelte-13obf84"),A(r,"class","features svelte-13obf84"),A(l,"class","landing-content svelte-13obf84"),A(i,"class","landing svelte-13obf84")},m(o,p){ee(o,i,p),E(i,l),E(l,_),E(l,y),E(l,w),E(l,C),E(l,e),E(l,t),E(l,c),E(c,u),E(c,a),E(c,d),E(l,v),E(l,m),E(l,f),E(l,r),n||(s=[Z(u,"click",h[0]),Z(d,"click",h[1])],n=!0)},p:ie,i:ie,o:ie,d(o){o&&Q(i),n=!1,fe(s)}}}function Pr(h){const i=pt();function l(){i("guest")}async function _(){const y=await ye.getOAuthUrl();y&&(window.location.href=y)}return[l,_]}class Ir extends Ue{constructor(i){super(),Ne(this,i,Pr,Or,Pe,{})}}const Hr="";function Fr(){return bt(wt)}function Wr(h){const i=new Headers({"Content-Type":"application/json"}),l=Fr();return l&&i.set("Authorization",`Bearer ${l}`),h&&new Headers(h).forEach((y,w)=>{i.set(w,y)}),i}async function St(h,i={}){const l=`${Hr}${h}`;try{const _=await fetch(l,{...i,headers:Wr(i.headers)});let y,w;const C=_.headers.get("content-type");if(C!=null&&C.includes("application/json"))try{const e=await _.json();_.ok?y=e:w=e.error||e.message||`Request failed with status ${_.status}`}catch{_.ok||(w=`Request failed with status ${_.status}`)}else _.ok||(w=`Request failed with status ${_.status}`);return{data:y,error:w,status:_.status,ok:_.ok}}catch(_){return{error:_ instanceof Error?_.message:"Network error",status:0,ok:!1}}}const Ot={get(h,i){return St(h,{...i,method:"GET"})},post(h,i,l){return St(h,{...l,method:"POST",body:i?JSON.stringify(i):void 0})},put(h,i,l){return St(h,{...l,method:"PUT",body:i?JSON.stringify(i):void 0})},delete(h,i){return St(h,{...i,method:"DELETE"})},patch(h,i,l){return St(h,{...l,method:"PATCH",body:i?JSON.stringify(i):void 0})}};function xs(h){const i=new Date,l=typeof h=="string"?new Date(h):h,_=Math.floor((i.getTime()-l.getTime())/1e3);return _<60?"just now":_<3600?`${Math.floor(_/60)}m ago`:_<86400?`${Math.floor(_/3600)}h ago`:_<604800?`${Math.floor(_/86400)}d ago`:l.toLocaleDateString()}function Os(h,i,l){const _=h.slice();return _[23]=i[l],_}function zr(h){let i;return{c(){i=se("+ New Terminal")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Nr(h){let i;return{c(){i=se("Creating...")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Ur(h){let i,l,_=[],y=new Map,w=h[0]&&h[3]&&Ps(h),C=Le(h[1]);const e=t=>t[23].id;for(let t=0;t<C.length;t+=1){let c=Os(h,C,t),u=e(c);y.set(u,_[t]=Hs(u,c))}return{c(){i=T("div"),w&&w.c(),l=U();for(let t=0;t<_.length;t+=1)_[t].c();A(i,"class","containers-grid svelte-ru6oo4")},m(t,c){ee(t,i,c),w&&w.m(i,null),E(i,l);for(let u=0;u<_.length;u+=1)_[u]&&_[u].m(i,null)},p(t,c){t[0]&&t[3]?w?w.p(t,c):(w=Ps(t),w.c(),w.m(i,l)):w&&(w.d(1),w=null),c&3970&&(C=Le(t[1]),_=Xe(_,c,e,1,t,C,y,i,Dt,Hs,null,Os))},d(t){t&&Q(i),w&&w.d();for(let c=0;c<_.length;c+=1)_[c].d()}}}function $r(h){let i,l,_,y,w,C,e,t,c,u;return{c(){i=T("div"),l=T("div"),l.textContent="ð¦",_=U(),y=T("h2"),y.textContent="No Terminals Yet",w=U(),C=T("p"),C.textContent="Create your first terminal to get started with a Linux environment in seconds.",e=U(),t=T("button"),t.textContent="+ Create Terminal",A(l,"class","empty-icon svelte-ru6oo4"),A(y,"class","svelte-ru6oo4"),A(C,"class","svelte-ru6oo4"),A(t,"class","btn btn-primary btn-lg"),A(i,"class","empty-state svelte-ru6oo4")},m(a,d){ee(a,i,d),E(i,l),E(i,_),E(i,y),E(i,w),E(i,C),E(i,e),E(i,t),c||(u=Z(t,"click",h[17]),c=!0)},p:ie,d(a){a&&Q(i),c=!1,u()}}}function qr(h){let i;return{c(){i=T("div"),i.innerHTML='<div class="spinner"></div> <p class="svelte-ru6oo4">Loading terminals...</p>',A(i,"class","loading-state svelte-ru6oo4")},m(l,_){ee(l,i,_)},p:ie,d(l){l&&Q(i)}}}function Ps(h){let i,l,_,y,w,C,e=(h[3].name||"New Terminal")+"",t,c,u,a=h[3].image+"",d,v,m,f,r,n,s,o,p,b,S=h[3].stage+"",k,g,L,R=h[3].progress+"",x,O,B,H,N=h[3].message+"",W;return{c(){i=T("div"),l=T("div"),_=T("span"),_.textContent="â³",y=U(),w=T("div"),C=T("h3"),t=se(e),c=U(),u=T("span"),d=se(a),v=U(),m=T("span"),m.innerHTML=`<span class="status-dot svelte-ru6oo4"></span>
              creating`,f=U(),r=T("div"),n=T("div"),s=T("div"),o=U(),p=T("div"),b=T("span"),k=se(S),g=U(),L=T("span"),x=se(R),O=se("%"),B=U(),H=T("p"),W=se(N),A(_,"class","container-icon svelte-ru6oo4"),A(C,"class","container-name svelte-ru6oo4"),A(u,"class","container-image svelte-ru6oo4"),A(w,"class","container-info svelte-ru6oo4"),A(m,"class","container-status status-creating svelte-ru6oo4"),A(l,"class","container-header svelte-ru6oo4"),A(s,"class","progress-fill svelte-ru6oo4"),Me(s,"width",h[3].progress+"%"),A(n,"class","progress-bar svelte-ru6oo4"),A(b,"class","progress-stage svelte-ru6oo4"),A(L,"class","progress-percent svelte-ru6oo4"),A(p,"class","progress-info svelte-ru6oo4"),A(H,"class","progress-message svelte-ru6oo4"),A(r,"class","creating-progress svelte-ru6oo4"),A(i,"class","container-card creating-card svelte-ru6oo4")},m($,j){ee($,i,j),E(i,l),E(l,_),E(l,y),E(l,w),E(w,C),E(C,t),E(w,c),E(w,u),E(u,d),E(l,v),E(l,m),E(i,f),E(i,r),E(r,n),E(n,s),E(r,o),E(r,p),E(p,b),E(b,k),E(p,g),E(p,L),E(L,x),E(L,O),E(r,B),E(r,H),E(H,W)},p($,j){j&8&&e!==(e=($[3].name||"New Terminal")+"")&&ne(t,e),j&8&&a!==(a=$[3].image+"")&&ne(d,a),j&8&&Me(s,"width",$[3].progress+"%"),j&8&&S!==(S=$[3].stage+"")&&ne(k,S),j&8&&R!==(R=$[3].progress+"")&&ne(x,R),j&8&&N!==(N=$[3].message+"")&&ne(W,N)},d($){$&&Q(i)}}}function Is(h){let i,l,_,y,w=Math.floor(h[23].idle_seconds/60)+"",C,e;return{c(){i=T("div"),l=T("span"),l.textContent="Idle",_=U(),y=T("span"),C=se(w),e=se("m"),A(l,"class","meta-label svelte-ru6oo4"),A(y,"class","meta-value svelte-ru6oo4"),A(i,"class","meta-item svelte-ru6oo4")},m(t,c){ee(t,i,c),E(i,l),E(i,_),E(i,y),E(y,C),E(y,e)},p(t,c){c&2&&w!==(w=Math.floor(t[23].idle_seconds/60)+"")&&ne(C,w)},d(t){t&&Q(i)}}}function jr(h){let i,l,_,y,w=h[23].status+"",C,e;return{c(){i=T("div"),l=T("button"),_=T("span"),y=U(),C=se(w),e=se("..."),A(_,"class","spinner-sm svelte-ru6oo4"),A(l,"class","btn btn-secondary btn-sm flex-1 svelte-ru6oo4"),l.disabled=!0,A(i,"class","action-row svelte-ru6oo4")},m(t,c){ee(t,i,c),E(i,l),E(l,_),E(l,y),E(l,C),E(l,e)},p(t,c){c&2&&w!==(w=t[23].status+"")&&ne(C,w)},d(t){t&&Q(i)}}}function Kr(h){let i,l,_,y,w,C;function e(){return h[21](h[23])}function t(){return h[22](h[23])}return{c(){i=T("div"),l=T("button"),l.textContent="Start",_=U(),y=T("button"),y.textContent="Delete",A(l,"class","btn btn-primary btn-sm flex-1 svelte-ru6oo4"),A(y,"class","btn btn-danger btn-sm flex-1 svelte-ru6oo4"),A(i,"class","action-row svelte-ru6oo4")},m(c,u){ee(c,i,u),E(i,l),E(i,_),E(i,y),w||(C=[Z(l,"click",e),Z(y,"click",t)],w=!0)},p(c,u){h=c},d(c){c&&Q(i),w=!1,fe(C)}}}function Vr(h){let i,l,_=h[11](h[23].id)?"+ New Tab":"Connect",y,w,C,e,t,c,u,a,d,v;function m(){return h[18](h[23])}function f(){return h[19](h[23])}function r(){return h[20](h[23])}return{c(){i=T("div"),l=T("button"),y=se(_),w=U(),C=T("button"),C.textContent="SSH",e=U(),t=T("div"),c=T("button"),c.textContent="Stop",u=U(),a=T("button"),a.textContent="Delete",A(l,"class","btn btn-primary btn-sm flex-1 svelte-ru6oo4"),A(C,"class","btn btn-secondary btn-sm"),A(C,"title","SSH Info"),A(i,"class","action-row svelte-ru6oo4"),A(c,"class","btn btn-secondary btn-sm flex-1 svelte-ru6oo4"),A(a,"class","btn btn-danger btn-sm flex-1 svelte-ru6oo4"),A(t,"class","action-row svelte-ru6oo4")},m(n,s){ee(n,i,s),E(i,l),E(l,y),E(i,w),E(i,C),ee(n,e,s),ee(n,t,s),E(t,c),E(t,u),E(t,a),d||(v=[Z(l,"click",m),Z(c,"click",f),Z(a,"click",r)],d=!0)},p(n,s){h=n,s&2&&_!==(_=h[11](h[23].id)?"+ New Tab":"Connect")&&ne(y,_)},d(n){n&&(Q(i),Q(e),Q(t)),d=!1,fe(v)}}}function Hs(h,i){let l,_,y,w=Ws(i[23].image)+"",C,e,t,c,u=i[23].name+"",a,d,v,m=i[23].image+"",f,r,n,s,o,p=i[23].status+"",b,S,k,g,L,R,x,O,B=xs(i[23].created_at)+"",H,N,W,$,j,D,P,I=i[23].id.slice(0,12)+"",F,V,X,Y,J=i[23].idle_seconds!==void 0&&Is(i);function z(q,G){return q[23].status==="running"?Vr:q[23].status==="stopped"?Kr:jr}let M=z(i),K=M(i);return{key:h,first:null,c(){l=T("div"),_=T("div"),y=T("span"),C=se(w),e=U(),t=T("div"),c=T("h3"),a=se(u),d=U(),v=T("span"),f=se(m),r=U(),n=T("span"),s=T("span"),o=U(),b=se(p),k=U(),g=T("div"),L=T("div"),R=T("span"),R.textContent="Created",x=U(),O=T("span"),H=se(B),N=U(),J&&J.c(),W=U(),$=T("div"),j=T("span"),j.textContent="ID",D=U(),P=T("span"),F=se(I),V=U(),X=T("div"),K.c(),Y=U(),A(y,"class","container-icon svelte-ru6oo4"),A(c,"class","container-name svelte-ru6oo4"),A(v,"class","container-image svelte-ru6oo4"),A(t,"class","container-info svelte-ru6oo4"),A(s,"class","status-dot svelte-ru6oo4"),A(n,"class",S="container-status "+Fs(i[23].status)+" svelte-ru6oo4"),A(_,"class","container-header svelte-ru6oo4"),A(R,"class","meta-label svelte-ru6oo4"),A(O,"class","meta-value svelte-ru6oo4"),A(L,"class","meta-item svelte-ru6oo4"),A(j,"class","meta-label svelte-ru6oo4"),A(P,"class","meta-value mono svelte-ru6oo4"),A($,"class","meta-item svelte-ru6oo4"),A(g,"class","container-meta svelte-ru6oo4"),A(X,"class","container-actions svelte-ru6oo4"),A(l,"class","container-card svelte-ru6oo4"),le(l,"active",i[11](i[23].id)),this.first=l},m(q,G){ee(q,l,G),E(l,_),E(_,y),E(y,C),E(_,e),E(_,t),E(t,c),E(c,a),E(t,d),E(t,v),E(v,f),E(_,r),E(_,n),E(n,s),E(n,o),E(n,b),E(l,k),E(l,g),E(g,L),E(L,R),E(L,x),E(L,O),E(O,H),E(g,N),J&&J.m(g,null),E(g,W),E(g,$),E($,j),E($,D),E($,P),E(P,F),E(l,V),E(l,X),K.m(X,null),E(l,Y)},p(q,G){i=q,G&2&&w!==(w=Ws(i[23].image)+"")&&ne(C,w),G&2&&u!==(u=i[23].name+"")&&ne(a,u),G&2&&m!==(m=i[23].image+"")&&ne(f,m),G&2&&p!==(p=i[23].status+"")&&ne(b,p),G&2&&S!==(S="container-status "+Fs(i[23].status)+" svelte-ru6oo4")&&A(n,"class",S),G&2&&B!==(B=xs(i[23].created_at)+"")&&ne(H,B),i[23].idle_seconds!==void 0?J?J.p(i,G):(J=Is(i),J.c(),J.m(g,W)):J&&(J.d(1),J=null),G&2&&I!==(I=i[23].id.slice(0,12)+"")&&ne(F,I),M===(M=z(i))&&K?K.p(i,G):(K.d(1),K=M(i),K&&(K.c(),K.m(X,null))),G&2050&&le(l,"active",i[11](i[23].id))},d(q){q&&Q(l),J&&J.d(),K.d()}}}function Gr(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s;function o(L,R){return L[0]?Nr:zr}let p=o(h),b=p(h);function S(L,R){return L[5]&&L[1].length===0?qr:L[1].length===0?$r:Ur}let k=S(h),g=k(h);return{c(){i=T("div"),l=T("div"),_=T("div"),y=T("h1"),y.textContent="Terminals",w=U(),C=T("span"),e=se(h[2]),t=se(" / "),c=se(h[4]),u=U(),a=T("div"),d=T("button"),d.textContent="â» Refresh",v=U(),m=T("button"),b.c(),r=U(),g.c(),A(y,"class","svelte-ru6oo4"),A(C,"class","count-badge svelte-ru6oo4"),A(_,"class","dashboard-title svelte-ru6oo4"),A(d,"class","btn btn-secondary btn-sm"),A(m,"class","btn btn-primary"),m.disabled=f=h[2]>=h[4]||h[0],A(a,"class","dashboard-actions svelte-ru6oo4"),A(l,"class","dashboard-header svelte-ru6oo4"),A(i,"class","dashboard svelte-ru6oo4")},m(L,R){ee(L,i,R),E(i,l),E(l,_),E(_,y),E(_,w),E(_,C),E(C,e),E(C,t),E(C,c),E(l,u),E(l,a),E(a,d),E(a,v),E(a,m),b.m(m,null),E(i,r),g.m(i,null),n||(s=[Z(d,"click",h[15]),Z(m,"click",h[16])],n=!0)},p(L,[R]){R&4&&ne(e,L[2]),R&16&&ne(c,L[4]),p!==(p=o(L))&&(b.d(1),b=p(L),b&&(b.c(),b.m(m,null))),R&21&&f!==(f=L[2]>=L[4]||L[0])&&(m.disabled=f),k===(k=S(L))&&g?g.p(L,R):(g.d(1),g=k(L),g&&(g.c(),g.m(i,null)))},i:ie,o:ie,d(L){L&&Q(i),b.d(),g.d(),n=!1,fe(s)}}}function Fs(h){switch(h){case"running":return"status-running";case"stopped":return"status-stopped";case"creating":return"status-creating";default:return"status-unknown"}}function Ws(h){const i=h.toLowerCase();return i.includes("ubuntu")?"ð ":i.includes("debian")?"ð´":i.includes("alpine")||i.includes("fedora")?"ðµ":i.includes("centos")||i.includes("rocky")||i.includes("alma")?"ð£":i.includes("arch")?"ð·":i.includes("kali")?"ð":"ð§"}function Jr(h,i,l){let _,y,w,C,e,t,c,u,a;be(h,hr,R=>l(12,c=R)),be(h,cr,R=>l(13,u=R)),be(h,Ee,R=>l(14,a=R));const d=pt();async function v(R){const x=he.loading(`Starting ${R.name}...`),O=await Ee.startContainer(R.id);O.success?(he.update(x,`${R.name} started`,"success"),O.recreated&&he.info("Terminal was recreated. Your data volume was preserved.")):he.update(x,O.error||"Failed to start terminal","error")}async function m(R){const x=he.loading(`Stopping ${R.name}...`),O=await Ee.stopContainer(R.id);O.success?he.update(x,`${R.name} stopped`,"success"):he.update(x,O.error||"Failed to stop terminal","error")}async function f(R){if(!confirm(`Delete terminal "${R.name}"? This cannot be undone.`))return;const x=he.loading(`Deleting ${R.name}...`),O=await Ee.deleteContainer(R.id);O.success?he.update(x,`${R.name} deleted`,"success"):he.update(x,O.error||"Failed to delete terminal","error")}function r(R){d("connect",{id:R.id,name:R.name})}function n(R){return _e.hasActiveSession(R)}const s=()=>Ee.fetchContainers(),o=()=>d("create"),p=()=>d("create"),b=R=>r(R),S=R=>m(R),k=R=>f(R),g=R=>v(R),L=R=>f(R);return h.$$.update=()=>{h.$$.dirty&16384&&l(1,_=a.containers),h.$$.dirty&16384&&l(5,y=a.isLoading),h.$$.dirty&16384&&l(4,w=a.limit),h.$$.dirty&8192&&l(0,C=u),h.$$.dirty&4096&&l(3,e=c),h.$$.dirty&3&&l(2,t=_.length+(C?1:0))},[C,_,t,e,w,y,d,v,m,f,r,n,c,u,a,s,o,p,b,S,k,g,L]}class Xr extends Ue{constructor(i){super(),Ne(this,i,Jr,Gr,Pe,{})}}function zs(h,i,l){const _=h.slice();return _[19]=i[l],_}function Yr(h){let i,l,_,y,w,C,e,t,c,u,a,d,v=[],m=new Map,f,r,n,s,o,p,b,S,k,g,L,R,x=Le(h[7]);const O=H=>H[19].name;for(let H=0;H<x.length;H+=1){let N=zs(h,x,H),W=O(N);m.set(W,v[H]=Us(W,N))}let B=h[0]==="custom"&&$s(h);return{c(){i=T("div"),l=T("div"),_=T("label"),_.innerHTML=`Terminal Name
          <span class="optional svelte-194utap">(optional)</span>`,y=U(),w=T("input"),C=U(),e=T("span"),e.textContent='Leave empty for auto-generated name like "swift-tiger-123"',t=U(),c=T("div"),u=T("label"),u.textContent="Select Operating System",a=U(),d=T("div");for(let H=0;H<v.length;H+=1)v[H].c();f=U(),r=T("button"),r.innerHTML='<span class="image-icon svelte-194utap">ð¦</span> <span class="image-name svelte-194utap">Custom Image</span>',n=U(),B&&B.c(),s=U(),o=T("div"),p=T("button"),p.textContent="Cancel",b=U(),S=T("button"),k=se("Create Terminal"),A(_,"for","container-name"),A(_,"class","svelte-194utap"),A(w,"type","text"),A(w,"id","container-name"),A(w,"placeholder","Auto-generated if empty"),A(w,"maxlength","64"),A(w,"class","svelte-194utap"),A(e,"class","form-hint svelte-194utap"),A(l,"class","form-group svelte-194utap"),A(u,"class","svelte-194utap"),A(r,"type","button"),A(r,"class","image-card svelte-194utap"),le(r,"selected",h[0]==="custom"),A(d,"class","image-grid svelte-194utap"),A(c,"class","form-group svelte-194utap"),A(p,"type","button"),A(p,"class","btn btn-secondary svelte-194utap"),A(S,"type","button"),A(S,"class","btn btn-primary btn-lg svelte-194utap"),S.disabled=g=!h[8],A(o,"class","form-actions svelte-194utap"),A(i,"class","create-form svelte-194utap")},m(H,N){ee(H,i,N),E(i,l),E(l,_),E(l,y),E(l,w),ge(w,h[3]),E(l,C),E(l,e),E(i,t),E(i,c),E(c,u),E(c,a),E(c,d);for(let W=0;W<v.length;W+=1)v[W]&&v[W].m(d,null);E(d,f),E(d,r),E(i,n),B&&B.m(i,null),E(i,s),E(i,o),E(o,p),E(o,b),E(o,S),E(S,k),L||(R=[Z(w,"input",h[13]),Z(r,"click",h[15]),Z(p,"click",h[11]),Z(S,"click",h[10])],L=!0)},p(H,N){N&8&&w.value!==H[3]&&ge(w,H[3]),N&4737&&(x=Le(H[7]),v=Xe(v,N,O,1,H,x,m,d,Dt,Us,f,zs)),N&1&&le(r,"selected",H[0]==="custom"),H[0]==="custom"?B?B.p(H,N):(B=$s(H),B.c(),B.m(i,s)):B&&(B.d(1),B=null),N&256&&g!==(g=!H[8])&&(S.disabled=g)},d(H){H&&Q(i);for(let N=0;N<v.length;N+=1)v[N].d();B&&B.d(),L=!1,fe(R)}}}function Zr(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s,o;return{c(){i=T("div"),l=T("div"),_=T("h2"),_.textContent="Creating Terminal",y=U(),w=T("span"),C=se(h[4]),e=se("%"),t=U(),c=T("div"),u=T("div"),a=U(),d=T("div"),v=T("span"),m=se(h[6]),f=U(),r=T("span"),n=se(h[5]),s=U(),o=T("div"),o.innerHTML='<div class="spinner-large svelte-194utap"></div>',A(_,"class","svelte-194utap"),A(w,"class","progress-percent svelte-194utap"),A(l,"class","progress-header svelte-194utap"),A(u,"class","progress-fill svelte-194utap"),Me(u,"width",h[4]+"%"),A(c,"class","progress-bar svelte-194utap"),A(v,"class","progress-stage svelte-194utap"),A(r,"class","progress-message svelte-194utap"),A(d,"class","progress-info svelte-194utap"),A(o,"class","progress-spinner svelte-194utap"),A(i,"class","progress-section svelte-194utap")},m(p,b){ee(p,i,b),E(i,l),E(l,_),E(l,y),E(l,w),E(w,C),E(w,e),E(i,t),E(i,c),E(c,u),E(i,a),E(i,d),E(d,v),E(v,m),E(d,f),E(d,r),E(r,n),E(i,s),E(i,o)},p(p,b){b&16&&ne(C,p[4]),b&16&&Me(u,"width",p[4]+"%"),b&64&&ne(m,p[6]),b&32&&ne(n,p[5])},d(p){p&&Q(i)}}}function Ns(h){let i;return{c(){i=T("span"),i.textContent="Popular",A(i,"class","popular-badge svelte-194utap")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Us(h,i){let l,_,y=i[9](i[19].name)+"",w,C,e,t=(i[19].display_name||i[19].name)+"",c,u,a,d,v,m=i[19].popular&&Ns();function f(){return i[14](i[19])}return{key:h,first:null,c(){l=T("button"),_=T("span"),w=se(y),C=U(),e=T("span"),c=se(t),u=U(),m&&m.c(),a=U(),A(_,"class","image-icon svelte-194utap"),A(e,"class","image-name svelte-194utap"),A(l,"type","button"),A(l,"class","image-card svelte-194utap"),le(l,"selected",i[0]===i[19].name),this.first=l},m(r,n){ee(r,l,n),E(l,_),E(_,w),E(l,C),E(l,e),E(e,c),E(l,u),m&&m.m(l,null),E(l,a),d||(v=Z(l,"click",f),d=!0)},p(r,n){i=r,n&128&&y!==(y=i[9](i[19].name)+"")&&ne(w,y),n&128&&t!==(t=(i[19].display_name||i[19].name)+"")&&ne(c,t),i[19].popular?m||(m=Ns(),m.c(),m.m(l,a)):m&&(m.d(1),m=null),n&129&&le(l,"selected",i[0]===i[19].name)},d(r){r&&Q(l),m&&m.d(),d=!1,v()}}}function $s(h){let i,l,_,y,w,C,e,t;return{c(){i=T("div"),l=T("label"),l.textContent="Docker Image",_=U(),y=T("input"),w=U(),C=T("span"),C.textContent="Enter a valid Docker image name from Docker Hub or any registry",A(l,"for","custom-image"),A(l,"class","svelte-194utap"),A(y,"type","text"),A(y,"id","custom-image"),A(y,"placeholder","e.g., nginx:latest or ghcr.io/user/image:tag"),A(y,"class","svelte-194utap"),A(C,"class","form-hint svelte-194utap"),A(i,"class","form-group svelte-194utap")},m(c,u){ee(c,i,u),E(i,l),E(i,_),E(i,y),ge(y,h[1]),E(i,w),E(i,C),e||(t=Z(y,"input",h[16]),e=!0)},p(c,u){u&2&&y.value!==c[1]&&ge(y,c[1])},d(c){c&&Q(i),e=!1,t()}}}function Qr(h){let i,l,_,y,w,C,e,t,c;function u(v,m){return v[2]?Zr:Yr}let a=u(h),d=a(h);return{c(){i=T("div"),l=T("div"),_=T("button"),y=se("â Back"),w=U(),C=T("h1"),C.textContent="Create Terminal",e=U(),d.c(),A(_,"class","back-btn svelte-194utap"),_.disabled=h[2],A(C,"class","svelte-194utap"),A(l,"class","create-header svelte-194utap"),A(i,"class","create-container svelte-194utap")},m(v,m){ee(v,i,m),E(i,l),E(l,_),E(_,y),E(l,w),E(l,C),E(i,e),d.m(i,null),t||(c=Z(_,"click",h[11]),t=!0)},p(v,[m]){m&4&&(_.disabled=v[2]),a===(a=u(v))&&d?d.p(v,m):(d.d(1),d=a(v),d&&(d.c(),d.m(i,null)))},i:ie,o:ie,d(v){v&&Q(i),d.d(),t=!1,c()}}}function en(){const h=["swift","bold","calm","dark","eager","fast","grand","happy","keen","light","merry","noble","proud","quick","rare","sharp"],i=["ant","bear","cat","fox","hawk","lion","owl","wolf","tiger","eagle","shark","cobra","raven","viper","lynx","orca"],l=h[Math.floor(Math.random()*h.length)],_=i[Math.floor(Math.random()*i.length)],y=Math.floor(Math.random()*1e3);return`${l}-${_}-${y}`}function tn(h,i,l){let _;const y=pt();let w="",C="",e="",t=!1,c=0,u="",a="",d=[];const v={ubuntu:"ð ",debian:"ð´",alpine:"ðµ",fedora:"ðµ",centos:"ð£",rocky:"ð£",alma:"ð£",arch:"ð·",kali:"ð",parrot:"ð¦",custom:"ð¦"};function m(S){const k=S.toLowerCase();for(const[g,L]of Object.entries(v))if(k.includes(g))return L;return"ð§"}Lt(async()=>{const{data:S,error:k}=await Ot.get("/api/images");S?l(7,d=S.images||S.popular||[]):k&&he.error("Failed to load images")});async function f(){if(!_)return;l(2,t=!0),l(4,c=0),l(5,u="Starting..."),l(6,a="initializing");const S=w.trim()||en(),k=C,g=C==="custom"?e.trim():void 0;Ee.createContainerWithProgress(S,k,g,L=>{l(4,c=L.progress||0),l(5,u=L.message||""),l(6,a=L.stage||""),L.complete&&L.container_id&&(l(2,t=!1),he.success(`Terminal "${S}" created!`),y("created",{id:L.container_id,name:S})),L.error&&(l(2,t=!1),he.error(L.error))},L=>{l(2,t=!1),y("created",{id:L.id,name:L.name})},L=>{l(2,t=!1),he.error(L)})}function r(){t||y("cancel")}function n(S){l(0,C=S)}function s(){w=this.value,l(3,w)}const o=S=>n(S.name),p=()=>n("custom");function b(){e=this.value,l(1,e)}return h.$$.update=()=>{h.$$.dirty&7&&l(8,_=C&&(C!=="custom"||e.trim())&&!t)},[C,e,t,w,c,u,a,d,_,m,f,r,n,s,o,p,b]}class sn extends Ue{constructor(i){super(),Ne(this,i,tn,Qr,Pe,{})}}function qs(h){let i,l,_,y,w,C,e;return{c(){i=T("div"),l=T("div"),l.innerHTML='<label class="svelte-x5kzqt">â ï¸ Guest Account</label> <span class="setting-description svelte-x5kzqt">Your session is temporary. Sign in to save your data.</span>',_=U(),y=T("div"),w=T("button"),w.textContent="Sign In",A(l,"class","setting-info svelte-x5kzqt"),A(w,"class","btn btn-primary btn-sm"),A(y,"class","setting-value svelte-x5kzqt"),A(i,"class","setting-item warning svelte-x5kzqt")},m(t,c){ee(t,i,c),E(i,l),E(i,_),E(i,y),E(y,w),C||(e=Z(w,"click",h[12]),C=!0)},p:ie,d(t){t&&Q(i),C=!1,e()}}}function rn(h){var ds,fs,_s;let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r=(((ds=h[6].user)==null?void 0:ds.email)||"Not set")+"",n,s,o,p,b,S,k,g=(((_s=(fs=h[6].user)==null?void 0:fs.tier)==null?void 0:_s.toUpperCase())||"FREE")+"",L,R,x,O,B,H,N,W,$,j,D,P,I,F,V,X,Y,J,z,M,K,q,G,te,oe,ce,ae,ve,re,$e,et,Ie,je,Ye,Ce,Se,we,Te,He,De,Ze,Re,Fe,de,tt,st,Ke,ns,$t,os,it,At,as,rt,Tt,ls,Bt,We,nt,Qe,cs,ot,vt,hs,gt,qt,us,Ae=h[7]&&qs(h);return{c(){var me;i=T("div"),l=T("div"),_=T("button"),_.textContent="â Back",y=U(),w=T("h1"),w.textContent="Settings",C=U(),e=T("div"),t=T("section"),c=T("h2"),c.textContent="Account",u=U(),a=T("div"),d=T("div"),d.innerHTML='<label class="svelte-x5kzqt">Email</label> <span class="setting-description svelte-x5kzqt">Your account email address</span>',v=U(),m=T("div"),f=T("span"),n=se(r),s=U(),o=T("div"),p=T("div"),p.innerHTML='<label class="svelte-x5kzqt">Account Type</label> <span class="setting-description svelte-x5kzqt">Your current subscription plan</span>',b=U(),S=T("div"),k=T("span"),L=se(g),x=U(),Ae&&Ae.c(),O=U(),B=T("section"),H=T("h2"),H.textContent="Terminal",N=U(),W=T("div"),$=T("div"),$.innerHTML='<label for="font-size" class="svelte-x5kzqt">Font Size</label> <span class="setting-description svelte-x5kzqt">Terminal font size in pixels</span>',j=U(),D=T("div"),P=T("input"),I=U(),F=T("div"),V=T("div"),V.innerHTML='<label for="cursor-style" class="svelte-x5kzqt">Cursor Style</label> <span class="setting-description svelte-x5kzqt">Terminal cursor appearance</span>',X=U(),Y=T("div"),J=T("select"),z=T("option"),z.textContent="Bar",M=T("option"),M.textContent="Block",K=T("option"),K.textContent="Underline",q=U(),G=T("div"),te=T("div"),te.innerHTML='<label for="cursor-blink" class="svelte-x5kzqt">Cursor Blink</label> <span class="setting-description svelte-x5kzqt">Enable cursor blinking</span>',oe=U(),ce=T("div"),ae=T("label"),ve=T("input"),re=U(),$e=T("span"),et=U(),Ie=T("div"),je=T("div"),je.innerHTML='<label for="scrollback" class="svelte-x5kzqt">Scrollback Lines</label> <span class="setting-description svelte-x5kzqt">Number of lines to keep in history</span>',Ye=U(),Ce=T("div"),Se=T("select"),we=T("option"),we.textContent="1,000",Te=T("option"),Te.textContent="5,000",He=T("option"),He.textContent="10,000",De=T("option"),De.textContent="50,000",Ze=U(),Re=T("div"),Fe=T("div"),Fe.innerHTML='<label for="copy-on-select" class="svelte-x5kzqt">Copy on Select</label> <span class="setting-description svelte-x5kzqt">Automatically copy selected text</span>',de=U(),tt=T("div"),st=T("label"),Ke=T("input"),ns=U(),$t=T("span"),os=U(),it=T("section"),At=T("h2"),At.textContent="Appearance",as=U(),rt=T("div"),Tt=T("div"),Tt.innerHTML='<label for="theme" class="svelte-x5kzqt">Theme</label> <span class="setting-description svelte-x5kzqt">Color scheme for the interface</span>',ls=U(),Bt=T("div"),We=T("select"),nt=T("option"),nt.textContent="Dark",Qe=T("option"),Qe.textContent="Light (Coming Soon)",cs=U(),ot=T("div"),vt=T("button"),vt.textContent="Reset to Defaults",hs=U(),gt=T("button"),gt.textContent="Save Settings",A(_,"class","back-btn svelte-x5kzqt"),A(w,"class","svelte-x5kzqt"),A(l,"class","settings-header svelte-x5kzqt"),A(c,"class","svelte-x5kzqt"),A(d,"class","setting-info svelte-x5kzqt"),A(f,"class","value-text svelte-x5kzqt"),A(m,"class","setting-value svelte-x5kzqt"),A(a,"class","setting-item svelte-x5kzqt"),A(p,"class","setting-info svelte-x5kzqt"),A(k,"class",R="tier-badge tier-"+(((me=h[6].user)==null?void 0:me.tier)||"free")+" svelte-x5kzqt"),A(S,"class","setting-value svelte-x5kzqt"),A(o,"class","setting-item svelte-x5kzqt"),A(t,"class","settings-section svelte-x5kzqt"),A(H,"class","svelte-x5kzqt"),A($,"class","setting-info svelte-x5kzqt"),A(P,"type","number"),A(P,"id","font-size"),A(P,"min","10"),A(P,"max","24"),A(P,"class","input-sm svelte-x5kzqt"),A(D,"class","setting-value svelte-x5kzqt"),A(W,"class","setting-item svelte-x5kzqt"),A(V,"class","setting-info svelte-x5kzqt"),z.__value="bar",ge(z,z.__value),M.__value="block",ge(M,M.__value),K.__value="underline",ge(K,K.__value),A(J,"id","cursor-style"),A(J,"class","select-sm svelte-x5kzqt"),h[3]===void 0&&qe(()=>h[14].call(J)),A(Y,"class","setting-value svelte-x5kzqt"),A(F,"class","setting-item svelte-x5kzqt"),A(te,"class","setting-info svelte-x5kzqt"),A(ve,"type","checkbox"),A(ve,"id","cursor-blink"),A(ve,"class","svelte-x5kzqt"),A($e,"class","toggle-slider svelte-x5kzqt"),A(ae,"class","toggle svelte-x5kzqt"),A(ce,"class","setting-value svelte-x5kzqt"),A(G,"class","setting-item svelte-x5kzqt"),A(je,"class","setting-info svelte-x5kzqt"),we.__value=1e3,ge(we,we.__value),Te.__value=5e3,ge(Te,Te.__value),He.__value=1e4,ge(He,He.__value),De.__value=5e4,ge(De,De.__value),A(Se,"id","scrollback"),A(Se,"class","select-sm svelte-x5kzqt"),h[4]===void 0&&qe(()=>h[16].call(Se)),A(Ce,"class","setting-value svelte-x5kzqt"),A(Ie,"class","setting-item svelte-x5kzqt"),A(Fe,"class","setting-info svelte-x5kzqt"),A(Ke,"type","checkbox"),A(Ke,"id","copy-on-select"),A(Ke,"class","svelte-x5kzqt"),A($t,"class","toggle-slider svelte-x5kzqt"),A(st,"class","toggle svelte-x5kzqt"),A(tt,"class","setting-value svelte-x5kzqt"),A(Re,"class","setting-item svelte-x5kzqt"),A(B,"class","settings-section svelte-x5kzqt"),A(At,"class","svelte-x5kzqt"),A(Tt,"class","setting-info svelte-x5kzqt"),nt.__value="dark",ge(nt,nt.__value),Qe.__value="light",ge(Qe,Qe.__value),Qe.disabled=!0,A(We,"id","theme"),A(We,"class","select-sm svelte-x5kzqt"),h[0]===void 0&&qe(()=>h[18].call(We)),A(Bt,"class","setting-value svelte-x5kzqt"),A(rt,"class","setting-item svelte-x5kzqt"),A(it,"class","settings-section svelte-x5kzqt"),A(vt,"class","btn btn-secondary svelte-x5kzqt"),A(gt,"class","btn btn-primary svelte-x5kzqt"),A(ot,"class","settings-actions svelte-x5kzqt"),A(e,"class","settings-content svelte-x5kzqt"),A(i,"class","settings svelte-x5kzqt")},m(me,Be){ee(me,i,Be),E(i,l),E(l,_),E(l,y),E(l,w),E(i,C),E(i,e),E(e,t),E(t,c),E(t,u),E(t,a),E(a,d),E(a,v),E(a,m),E(m,f),E(f,n),E(t,s),E(t,o),E(o,p),E(o,b),E(o,S),E(S,k),E(k,L),E(t,x),Ae&&Ae.m(t,null),E(e,O),E(e,B),E(B,H),E(B,N),E(B,W),E(W,$),E(W,j),E(W,D),E(D,P),ge(P,h[1]),E(B,I),E(B,F),E(F,V),E(F,X),E(F,Y),E(Y,J),E(J,z),E(J,M),E(J,K),at(J,h[3],!0),E(B,q),E(B,G),E(G,te),E(G,oe),E(G,ce),E(ce,ae),E(ae,ve),ve.checked=h[2],E(ae,re),E(ae,$e),E(B,et),E(B,Ie),E(Ie,je),E(Ie,Ye),E(Ie,Ce),E(Ce,Se),E(Se,we),E(Se,Te),E(Se,He),E(Se,De),at(Se,h[4],!0),E(B,Ze),E(B,Re),E(Re,Fe),E(Re,de),E(Re,tt),E(tt,st),E(st,Ke),Ke.checked=h[5],E(st,ns),E(st,$t),E(e,os),E(e,it),E(it,At),E(it,as),E(it,rt),E(rt,Tt),E(rt,ls),E(rt,Bt),E(Bt,We),E(We,nt),E(We,Qe),at(We,h[0],!0),E(e,cs),E(e,ot),E(ot,vt),E(ot,hs),E(ot,gt),qt||(us=[Z(_,"click",h[11]),Z(P,"input",h[13]),Z(J,"change",h[14]),Z(ve,"change",h[15]),Z(Se,"change",h[16]),Z(Ke,"change",h[17]),Z(We,"change",h[18]),Z(vt,"click",h[10]),Z(gt,"click",h[9])],qt=!0)},p(me,[Be]){var ps,vs,gs,ms;Be&64&&r!==(r=(((ps=me[6].user)==null?void 0:ps.email)||"Not set")+"")&&ne(n,r),Be&64&&g!==(g=(((gs=(vs=me[6].user)==null?void 0:vs.tier)==null?void 0:gs.toUpperCase())||"FREE")+"")&&ne(L,g),Be&64&&R!==(R="tier-badge tier-"+(((ms=me[6].user)==null?void 0:ms.tier)||"free")+" svelte-x5kzqt")&&A(k,"class",R),me[7]?Ae?Ae.p(me,Be):(Ae=qs(me),Ae.c(),Ae.m(t,null)):Ae&&(Ae.d(1),Ae=null),Be&2&&wi(P.value)!==me[1]&&ge(P,me[1]),Be&8&&at(J,me[3]),Be&4&&(ve.checked=me[2]),Be&16&&at(Se,me[4]),Be&32&&(Ke.checked=me[5]),Be&1&&at(We,me[0])},i:ie,o:ie,d(me){me&&Q(i),Ae&&Ae.d(),qt=!1,fe(us)}}}function nn(h,i,l){let _,y;be(h,ye,k=>l(6,_=k)),be(h,rs,k=>l(7,y=k));const w=pt();let C="dark",e=14,t=!0,c="bar",u=5e3,a=!1;function d(){try{const k=localStorage.getItem("rexec_settings");if(k){const g=JSON.parse(k);l(0,C=g.theme||"dark"),l(1,e=g.fontSize||14),l(2,t=g.cursorBlink??!0),l(3,c=g.cursorStyle||"bar"),l(4,u=g.scrollback||5e3),l(5,a=g.copyOnSelect??!1)}}catch(k){console.error("Failed to load settings:",k)}}function v(){try{localStorage.setItem("rexec_settings",JSON.stringify({theme:C,fontSize:e,cursorBlink:t,cursorStyle:c,scrollback:u,copyOnSelect:a})),he.success("Settings saved")}catch(k){console.error("Failed to save settings:",k),he.error("Failed to save settings")}}function m(){l(0,C="dark"),l(1,e=14),l(2,t=!0),l(3,c="bar"),l(4,u=5e3),l(5,a=!1),v()}d();const f=()=>w("back"),r=()=>ye.getOAuthUrl().then(k=>k&&(window.location.href=k));function n(){e=wi(this.value),l(1,e)}function s(){c=Kt(this),l(3,c)}function o(){t=this.checked,l(2,t)}function p(){u=Kt(this),l(4,u)}function b(){a=this.checked,l(5,a)}function S(){C=Kt(this),l(0,C)}return[C,e,t,c,u,a,_,y,w,v,m,f,r,n,s,o,p,b,S]}class on extends Ue{constructor(i){super(),Ne(this,i,nn,rn,Pe,{})}}function js(h,i,l){const _=h.slice();return _[19]=i[l],_}function Ks(h){let i;return{c(){i=se("ð")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function an(h){let i,l=[],_=new Map,y=Le(h[0]);const w=C=>C[19].id;for(let C=0;C<y.length;C+=1){let e=js(h,y,C),t=w(e);_.set(t,l[C]=Gs(t,e))}return{c(){i=T("div");for(let C=0;C<l.length;C+=1)l[C].c();A(i,"class","keys-list svelte-c2fxg1")},m(C,e){ee(C,i,e);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(i,null)},p(C,e){e&513&&(y=Le(C[0]),l=Xe(l,e,w,1,C,y,_,i,Dt,Gs,null,js))},d(C){C&&Q(i);for(let e=0;e<l.length;e+=1)l[e].d()}}}function ln(h){let i,l,_,y,w,C,e,t,c,u;return{c(){i=T("div"),l=T("div"),l.textContent="ð",_=U(),y=T("h2"),y.textContent="No SSH Keys",w=U(),C=T("p"),C.textContent="Add an SSH key to enable secure passwordless access to your terminals.",e=U(),t=T("button"),t.textContent="+ Add Your First Key",A(l,"class","empty-icon svelte-c2fxg1"),A(y,"class","svelte-c2fxg1"),A(C,"class","svelte-c2fxg1"),A(t,"class","btn btn-primary"),A(i,"class","empty-state svelte-c2fxg1")},m(a,d){ee(a,i,d),E(i,l),E(i,_),E(i,y),E(i,w),E(i,C),E(i,e),E(i,t),c||(u=Z(t,"click",h[10]),c=!0)},p:ie,d(a){a&&Q(i),c=!1,u()}}}function cn(h){let i,l,_,y,w,C,e,t,c,u;return{c(){i=T("div"),l=T("div"),l.textContent="ð",_=U(),y=T("h2"),y.textContent="SSH Keys Locked",w=U(),C=T("p"),C.textContent="Sign in with PipeOps to manage your SSH keys and enable secure passwordless access to your terminals.",e=U(),t=T("button"),t.textContent="Sign in with PipeOps",A(l,"class","guest-icon svelte-c2fxg1"),A(y,"class","svelte-c2fxg1"),A(C,"class","svelte-c2fxg1"),A(t,"class","btn btn-primary"),A(i,"class","guest-state svelte-c2fxg1")},m(a,d){ee(a,i,d),E(i,l),E(i,_),E(i,y),E(i,w),E(i,C),E(i,e),E(i,t),c||(u=Z(t,"click",h[14]),c=!0)},p:ie,d(a){a&&Q(i),c=!1,u()}}}function hn(h){let i;return{c(){i=T("div"),i.innerHTML='<div class="spinner svelte-c2fxg1"></div> <p class="svelte-c2fxg1">Loading SSH keys...</p>',A(i,"class","loading-state svelte-c2fxg1")},m(l,_){ee(l,i,_)},p:ie,d(l){l&&Q(i)}}}function Vs(h){let i,l,_=zt(h[19].last_used_at)+"",y;return{c(){i=T("span"),l=se("â¢ Last used "),y=se(_)},m(w,C){ee(w,i,C),E(i,l),E(i,y)},p(w,C){C&1&&_!==(_=zt(w[19].last_used_at)+"")&&ne(y,_)},d(w){w&&Q(i)}}}function Gs(h,i){let l,_,y,w,C,e=i[19].name+"",t,c,u,a=i[19].fingerprint+"",d,v,m,f,r,n=zt(i[19].created_at)+"",s,o,p,b,S,k,g,L=i[19].last_used_at&&Vs(i);function R(){return i[15](i[19])}return{key:h,first:null,c(){l=T("div"),_=T("div"),_.textContent="ð",y=U(),w=T("div"),C=T("div"),t=se(e),c=U(),u=T("div"),d=se(a),v=U(),m=T("div"),f=T("span"),r=se("Added "),s=se(n),o=U(),L&&L.c(),p=U(),b=T("button"),b.textContent="Delete",S=U(),A(_,"class","key-icon svelte-c2fxg1"),A(C,"class","key-name svelte-c2fxg1"),A(u,"class","key-fingerprint svelte-c2fxg1"),A(m,"class","key-meta svelte-c2fxg1"),A(w,"class","key-info svelte-c2fxg1"),A(b,"class","btn btn-danger btn-sm svelte-c2fxg1"),A(l,"class","key-card svelte-c2fxg1"),this.first=l},m(x,O){ee(x,l,O),E(l,_),E(l,y),E(l,w),E(w,C),E(C,t),E(w,c),E(w,u),E(u,d),E(w,v),E(w,m),E(m,f),E(f,r),E(f,s),E(m,o),L&&L.m(m,null),E(l,p),E(l,b),E(l,S),k||(g=Z(b,"click",R),k=!0)},p(x,O){i=x,O&1&&e!==(e=i[19].name+"")&&ne(t,e),O&1&&a!==(a=i[19].fingerprint+"")&&ne(d,a),O&1&&n!==(n=zt(i[19].created_at)+"")&&ne(s,n),i[19].last_used_at?L?L.p(i,O):(L=Vs(i),L.c(),L.m(m,null)):L&&(L.d(1),L=null)},d(x){x&&Q(l),L&&L.d(),k=!1,g()}}}function Js(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s,o,p,b,S,k,g,L,R=h[5]?"Adding...":"Add Key",x,O,B,H;return{c(){i=T("div"),l=T("div"),_=T("div"),y=T("h2"),y.textContent="Add SSH Key",w=U(),C=T("button"),C.textContent="Ã",e=U(),t=T("div"),c=T("div"),u=T("label"),u.textContent="Name",a=U(),d=T("input"),v=U(),m=T("div"),f=T("label"),f.textContent="Public Key",r=U(),n=T("textarea"),s=U(),o=T("span"),o.textContent="Paste your public key (usually from ~/.ssh/id_ed25519.pub or ~/.ssh/id_rsa.pub)",p=U(),b=T("div"),S=T("button"),k=se("Cancel"),g=U(),L=T("button"),x=se(R),A(y,"class","svelte-c2fxg1"),A(C,"class","modal-close svelte-c2fxg1"),A(_,"class","modal-header svelte-c2fxg1"),A(u,"for","key-name"),A(u,"class","svelte-c2fxg1"),A(d,"type","text"),A(d,"id","key-name"),A(d,"placeholder","e.g., MacBook Pro, Work Laptop"),A(d,"maxlength","64"),A(d,"class","svelte-c2fxg1"),A(c,"class","form-group svelte-c2fxg1"),A(f,"for","key-content"),A(f,"class","svelte-c2fxg1"),A(n,"id","key-content"),A(n,"placeholder","ssh-ed25519 AAAA... or ssh-rsa AAAA..."),A(n,"rows","4"),A(n,"class","svelte-c2fxg1"),A(o,"class","form-hint svelte-c2fxg1"),A(m,"class","form-group svelte-c2fxg1"),A(t,"class","modal-body svelte-c2fxg1"),A(S,"class","btn btn-secondary"),S.disabled=h[5],A(L,"class","btn btn-primary"),L.disabled=O=h[5]||!h[3].trim()||!h[4].trim(),A(b,"class","modal-footer svelte-c2fxg1"),A(l,"class","modal svelte-c2fxg1"),A(l,"role","dialog"),A(l,"aria-modal","true"),A(i,"class","modal-overlay svelte-c2fxg1"),A(i,"role","presentation")},m(N,W){ee(N,i,W),E(i,l),E(l,_),E(_,y),E(_,w),E(_,C),E(l,e),E(l,t),E(t,c),E(c,u),E(c,a),E(c,d),ge(d,h[3]),E(t,v),E(t,m),E(m,f),E(m,r),E(m,n),ge(n,h[4]),E(m,s),E(m,o),E(l,p),E(l,b),E(b,S),E(S,k),E(b,g),E(b,L),E(L,x),B||(H=[Z(C,"click",h[11]),Z(d,"input",h[16]),Z(n,"input",h[17]),Z(S,"click",h[11]),Z(L,"click",h[8]),Z(l,"click",Et(h[12])),Z(i,"click",h[11])],B=!0)},p(N,W){W&8&&d.value!==N[3]&&ge(d,N[3]),W&16&&ge(n,N[4]),W&32&&(S.disabled=N[5]),W&32&&R!==(R=N[5]?"Adding...":"Add Key")&&ne(x,R),W&56&&O!==(O=N[5]||!N[3].trim()||!N[4].trim())&&(L.disabled=O)},d(N){N&&Q(i),B=!1,fe(H)}}}function un(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s,o,p,b=h[6]&&Ks();function S(R,x){return R[1]?hn:R[6]?cn:R[0].length===0?ln:an}let k=S(h),g=k(h),L=h[2]&&Js(h);return{c(){i=T("div"),l=T("div"),_=T("button"),_.textContent="â Back",y=U(),w=T("h1"),w.textContent="SSH Keys",C=U(),e=T("div"),t=T("div"),c=T("p"),c.textContent="SSH keys allow you to connect to your terminals securely without a password.",u=U(),a=T("button"),b&&b.c(),d=se(" Add SSH Key"),m=U(),g.c(),f=U(),r=T("div"),r.innerHTML='<h3 class="svelte-c2fxg1">How to generate an SSH key</h3> <div class="instruction-steps svelte-c2fxg1"><div class="step svelte-c2fxg1"><span class="step-number svelte-c2fxg1">1</span> <div class="step-content svelte-c2fxg1"><p class="svelte-c2fxg1">Open your terminal and run:</p> <code class="svelte-c2fxg1">ssh-keygen -t ed25519 -C &quot;your_email@example.com&quot;</code></div></div> <div class="step svelte-c2fxg1"><span class="step-number svelte-c2fxg1">2</span> <div class="step-content svelte-c2fxg1"><p class="svelte-c2fxg1">Copy your public key:</p> <code class="svelte-c2fxg1">cat ~/.ssh/id_ed25519.pub</code></div></div> <div class="step svelte-c2fxg1"><span class="step-number svelte-c2fxg1">3</span> <div class="step-content svelte-c2fxg1"><p class="svelte-c2fxg1">Paste the key above and give it a memorable name.</p></div></div></div>',n=U(),L&&L.c(),s=kt(),A(_,"class","back-btn svelte-c2fxg1"),A(w,"class","svelte-c2fxg1"),A(l,"class","ssh-keys-header svelte-c2fxg1"),A(c,"class","section-description svelte-c2fxg1"),A(a,"class","btn btn-primary"),a.disabled=h[6],A(a,"title",v=h[6]?"Sign in with PipeOps to add SSH keys":""),A(t,"class","section-header svelte-c2fxg1"),A(r,"class","instructions svelte-c2fxg1"),A(e,"class","ssh-keys-content svelte-c2fxg1"),A(i,"class","ssh-keys svelte-c2fxg1")},m(R,x){ee(R,i,x),E(i,l),E(l,_),E(l,y),E(l,w),E(i,C),E(i,e),E(e,t),E(t,c),E(t,u),E(t,a),b&&b.m(a,null),E(a,d),E(e,m),g.m(e,null),E(e,f),E(e,r),ee(R,n,x),L&&L.m(R,x),ee(R,s,x),o||(p=[Z(_,"click",h[13]),Z(a,"click",h[10])],o=!0)},p(R,[x]){R[6]?b||(b=Ks(),b.c(),b.m(a,d)):b&&(b.d(1),b=null),x&64&&(a.disabled=R[6]),x&64&&v!==(v=R[6]?"Sign in with PipeOps to add SSH keys":"")&&A(a,"title",v),k===(k=S(R))&&g?g.p(R,x):(g.d(1),g=k(R),g&&(g.c(),g.m(e,f))),R[2]?L?L.p(R,x):(L=Js(R),L.c(),L.m(s.parentNode,s)):L&&(L.d(1),L=null)},i:ie,o:ie,d(R){R&&(Q(i),Q(n),Q(s)),b&&b.d(),g.d(),L&&L.d(R),o=!1,fe(p)}}}function zt(h){return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function dn(h,i,l){let _;be(h,rs,S=>l(6,_=S));const y=pt();let w=[],C=!0,e=!1,t="",c="",u=!1;async function a(){l(1,C=!0);const{data:S,error:k}=await Ot.get("/api/ssh-keys");S?l(0,w=S.keys||[]):k&&he.error("Failed to load SSH keys"),l(1,C=!1)}async function d(){if(!t.trim()||!c.trim()){he.error("Please provide a name and key");return}l(5,u=!0);const{data:S,error:k}=await Ot.post("/api/ssh-keys",{name:t.trim(),public_key:c.trim()});S?(l(0,w=[...w,S]),he.success("SSH key added"),f()):he.error(k||"Failed to add SSH key"),l(5,u=!1)}async function v(S,k){if(!confirm(`Delete SSH key "${k}"? This cannot be undone.`))return;const{error:g}=await Ot.delete(`/api/ssh-keys/${S}`);g?he.error(g||"Failed to delete SSH key"):(l(0,w=w.filter(L=>L.id!==S)),he.success("SSH key deleted"))}function m(){l(3,t=""),l(4,c=""),l(2,e=!0)}function f(){l(2,e=!1),l(3,t=""),l(4,c="")}Lt(a);function r(S){Li.call(this,h,S)}const n=()=>y("back"),s=()=>ye.getOAuthUrl().then(S=>S&&(window.location.href=S)),o=S=>v(S.id,S.name);function p(){t=this.value,l(3,t)}function b(){c=this.value,l(4,c)}return[w,C,e,t,c,u,_,y,d,v,m,f,r,n,s,o,p,b]}class fn extends Ue{constructor(i){super(),Ne(this,i,dn,un,Pe,{})}}function Xs(h){let i;return{c(){i=T("span"),i.innerHTML=`<span class="setup-spinner svelte-1g0beqj"></span>
          Installing...`,A(i,"class","setup-indicator svelte-1g0beqj")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Ys(h){let i,l,_;return{c(){i=T("button"),i.textContent="â» Reconnect",A(i,"class","toolbar-btn svelte-1g0beqj"),A(i,"title","Reconnect")},m(y,w){ee(y,i,w),l||(_=Z(i,"click",h[8]),l=!0)},p:ie,d(y){y&&Q(i),l=!1,_()}}}function Zs(h){let i;return{c(){i=T("div"),i.innerHTML='<div class="connection-spinner svelte-1g0beqj"></div> <span class="svelte-1g0beqj">Connecting...</span>',A(i,"class","connection-overlay svelte-1g0beqj")},m(l,_){ee(l,i,_)},d(l){l&&Q(i)}}}function Qs(h){let i,l,_,y,w,C,e,t;return{c(){i=T("div"),l=T("span"),l.textContent="â ",_=U(),y=T("span"),y.textContent="Disconnected",w=U(),C=T("button"),C.textContent="â» Reconnect",A(l,"class","disconnected-icon svelte-1g0beqj"),A(y,"class","svelte-1g0beqj"),A(C,"class","reconnect-btn svelte-1g0beqj"),A(i,"class","disconnected-overlay svelte-1g0beqj")},m(c,u){ee(c,i,u),E(i,l),E(i,_),E(i,y),E(i,w),E(i,C),e||(t=Z(C,"click",h[8]),e=!0)},p:ie,d(c){c&&Q(i),e=!1,t()}}}function ei(h){let i,l,_,y,w,C,e,t;return{c(){i=T("div"),l=T("div"),_=T("div"),y=U(),w=T("span"),w.textContent="Installing packages...",C=U(),e=T("span"),t=se(h[3]),A(_,"class","setup-spinner-large svelte-1g0beqj"),A(w,"class","setup-title svelte-1g0beqj"),A(e,"class","setup-detail svelte-1g0beqj"),A(l,"class","setup-content svelte-1g0beqj"),A(i,"class","setup-overlay svelte-1g0beqj")},m(c,u){ee(c,i,u),E(i,l),E(l,_),E(l,y),E(l,w),E(l,C),E(l,e),E(e,t)},p(c,u){u&8&&ne(t,c[3])},d(c){c&&Q(i)}}}function _n(h){let i,l,_,y,w=h[0].name+"",C,e,t,c,u,a,d,v,m,f,r,n,s,o,p,b,S,k,g,L,R,x,O=h[4]&&Xs(),B=h[5]&&Ys(h),H=h[6]&&Zs(),N=h[5]&&Qs(h),W=h[4]&&ei(h);return{c(){i=T("div"),l=T("div"),_=T("div"),y=T("span"),C=se(w),e=U(),t=T("span"),c=T("span"),u=U(),a=se(h[2]),d=U(),O&&O.c(),v=U(),m=T("div"),B&&B.c(),f=U(),r=T("button"),r.textContent="ð Copy",n=U(),s=T("button"),s.textContent="ð¥ Paste",o=U(),p=T("button"),p.textContent="ð Clear",b=U(),S=T("div"),k=U(),H&&H.c(),g=U(),N&&N.c(),L=U(),W&&W.c(),A(y,"class","terminal-name svelte-1g0beqj"),A(c,"class","status-indicator svelte-1g0beqj"),A(t,"class","terminal-status svelte-1g0beqj"),le(t,"connected",h[7]),le(t,"connecting",h[6]),le(t,"disconnected",h[5]),A(_,"class","toolbar-left svelte-1g0beqj"),A(r,"class","toolbar-btn svelte-1g0beqj"),A(r,"title","Copy Selection"),A(s,"class","toolbar-btn svelte-1g0beqj"),A(s,"title","Paste"),A(p,"class","toolbar-btn svelte-1g0beqj"),A(p,"title","Clear Terminal"),A(m,"class","toolbar-actions svelte-1g0beqj"),A(l,"class","terminal-toolbar svelte-1g0beqj"),A(S,"class","terminal-container svelte-1g0beqj"),A(S,"role","textbox"),A(S,"tabindex","0"),A(i,"class","terminal-panel-wrapper svelte-1g0beqj")},m($,j){ee($,i,j),E(i,l),E(l,_),E(_,y),E(y,C),E(_,e),E(_,t),E(t,c),E(t,u),E(t,a),E(_,d),O&&O.m(_,null),E(l,v),E(l,m),B&&B.m(m,null),E(m,f),E(m,r),E(m,n),E(m,s),E(m,o),E(m,p),E(i,b),E(i,S),h[14](S),E(i,k),H&&H.m(i,null),E(i,g),N&&N.m(i,null),E(i,L),W&&W.m(i,null),R||(x=[Z(r,"click",h[10]),Z(s,"click",h[11]),Z(p,"click",h[9]),Z(S,"click",h[12]),Z(S,"keydown",pn)],R=!0)},p($,[j]){j&1&&w!==(w=$[0].name+"")&&ne(C,w),j&4&&ne(a,$[2]),j&128&&le(t,"connected",$[7]),j&64&&le(t,"connecting",$[6]),j&32&&le(t,"disconnected",$[5]),$[4]?O||(O=Xs(),O.c(),O.m(_,null)):O&&(O.d(1),O=null),$[5]?B?B.p($,j):(B=Ys($),B.c(),B.m(m,f)):B&&(B.d(1),B=null),$[6]?H||(H=Zs(),H.c(),H.m(i,g)):H&&(H.d(1),H=null),$[5]?N?N.p($,j):(N=Qs($),N.c(),N.m(i,L)):N&&(N.d(1),N=null),$[4]?W?W.p($,j):(W=ei($),W.c(),W.m(i,null)):W&&(W.d(1),W=null)},i:ie,o:ie,d($){$&&Q(i),O&&O.d(),B&&B.d(),h[14](null),H&&H.d(),N&&N.d(),W&&W.d(),R=!1,fe(x)}}}const pn=()=>{};function vn(h,i,l){let _,y,w,C,e,t,{session:c}=i,u,a=null;function d(){if(!(!u||!(c!=null&&c.terminal))&&a!==u){l(1,u.innerHTML="",u);try{c.terminal.open(u),l(13,a=u),requestAnimationFrame(()=>{c!=null&&c.terminal&&u&&(_e.fitSession(c.id),c.terminal.focus())})}catch(o){console.error("Failed to attach terminal:",o)}}}Lt(()=>{var o;u&&c&&((o=c.terminal)!=null&&o.element?d():(_e.attachTerminal(c.id,u),l(13,a=u)),(!c.ws||c.ws.readyState!==WebSocket.OPEN&&c.ws.readyState!==WebSocket.CONNECTING)&&_e.connectWebSocket(c.id))}),Ei(()=>{l(13,a=null)});function v(){_e.reconnectSession(c.id)}function m(){c.terminal&&c.terminal.clear()}function f(){if(c.terminal){const o=c.terminal.getSelection();o&&navigator.clipboard.writeText(o)}}function r(){navigator.clipboard.readText().then(o=>{c.ws&&c.ws.readyState===WebSocket.OPEN&&c.ws.send(JSON.stringify({type:"input",data:o}))})}function n(){c.terminal&&c.terminal.focus()}function s(o){Ft[o?"unshift":"push"](()=>{u=o,l(1,u)})}return h.$$set=o=>{"session"in o&&l(0,c=o.session)},h.$$.update=()=>{h.$$.dirty&8195&&u&&c!=null&&c.terminal&&a!==u&&d(),h.$$.dirty&1&&l(2,_=(c==null?void 0:c.status)||"disconnected"),h.$$.dirty&4&&l(7,y=_==="connected"),h.$$.dirty&4&&l(6,w=_==="connecting"),h.$$.dirty&4&&l(5,C=_==="disconnected"||_==="error"),h.$$.dirty&1&&l(4,e=(c==null?void 0:c.isSettingUp)||!1),h.$$.dirty&1&&l(3,t=(c==null?void 0:c.setupMessage)||"")},[c,u,_,t,e,C,w,y,v,m,f,r,n,a,s]}class Hi extends Ue{constructor(i){super(),Ne(this,i,vn,_n,Pe,{session:0})}}function ti(h,i,l){const _=h.slice();return _[33]=i[l][0],_[34]=i[l][1],_}function si(h,i,l){const _=h.slice();return _[33]=i[l][0],_[34]=i[l][1],_}function ii(h,i,l){const _=h.slice();return _[33]=i[l][0],_[34]=i[l][1],_}function ri(h,i,l){const _=h.slice();return _[33]=i[l][0],_[34]=i[l][1],_}function ni(h){let i,l,_,y;const w=[mn,gn],C=[];function e(t,c){return t[7]?0:1}return i=e(h),l=C[i]=w[i](h),{c(){l.c(),_=kt()},m(t,c){C[i].m(t,c),ee(t,_,c),y=!0},p(t,c){let u=i;i=e(t),i===u?C[i].p(t,c):(Ge(),pe(C[u],1,1,()=>{C[u]=null}),Je(),l=C[i],l?l.p(t,c):(l=C[i]=w[i](t),l.c()),ue(l,1),l.m(_.parentNode,_))},i(t){y||(ue(l),y=!0)},o(t){pe(l),y=!1},d(t){t&&Q(_),C[i].d(t)}}}function gn(h){let i,l,_,y=[],w=new Map,C,e,t,c,u,a,d,v,m,f,r,n=[],s=new Map,o,p,b,S=Le(h[3]);const k=R=>R[33];for(let R=0;R<S.length;R+=1){let x=si(h,S,R),O=k(x);w.set(O,y[R]=oi(O,x))}let g=Le(h[3]);const L=R=>R[33];for(let R=0;R<g.length;R+=1){let x=ti(h,g,R),O=L(x);s.set(O,n[R]=ai(O,x))}return{c(){i=T("div"),l=T("div"),_=T("div");for(let R=0;R<y.length;R+=1)y[R].c();C=U(),e=T("div"),t=T("button"),t.textContent="+ New Tab",c=U(),u=T("button"),u.textContent="â¬ Float",a=U(),d=T("button"),d.textContent="â Back",v=U(),m=T("button"),m.textContent="â Close All",f=U(),r=T("div");for(let R=0;R<n.length;R+=1)n[R].c();A(_,"class","docked-tabs svelte-1sobzgq"),A(t,"class","btn btn-primary btn-sm"),A(t,"title","New Tab"),A(u,"class","btn btn-secondary btn-sm"),A(d,"class","btn btn-secondary btn-sm"),A(m,"class","btn btn-danger btn-sm"),A(e,"class","docked-actions svelte-1sobzgq"),A(l,"class","docked-header svelte-1sobzgq"),A(r,"class","docked-body svelte-1sobzgq"),A(i,"class","docked-terminal svelte-1sobzgq")},m(R,x){ee(R,i,x),E(i,l),E(l,_);for(let O=0;O<y.length;O+=1)y[O]&&y[O].m(_,null);E(l,C),E(l,e),E(e,t),E(e,c),E(e,u),E(e,a),E(e,d),E(e,v),E(e,m),E(i,f),E(i,r);for(let O=0;O<n.length;O+=1)n[O]&&n[O].m(r,null);o=!0,p||(b=[Z(t,"click",h[16]),Z(u,"click",h[10]),Z(d,"click",h[24]),Z(m,"click",h[13])],p=!0)},p(R,x){x[0]&49164&&(S=Le(R[3]),y=Xe(y,x,k,1,R,S,w,_,Dt,oi,null,si)),x[0]&12&&(g=Le(R[3]),Ge(),n=Xe(n,x,L,1,R,g,s,r,is,ai,null,ti),Je())},i(R){if(!o){for(let x=0;x<g.length;x+=1)ue(n[x]);o=!0}},o(R){for(let x=0;x<n.length;x+=1)pe(n[x]);o=!1},d(R){R&&Q(i);for(let x=0;x<y.length;x+=1)y[x].d();for(let x=0;x<n.length;x+=1)n[x].d();p=!1,fe(b)}}}function mn(h){let i,l,_,y,w=[],C=new Map,e,t,c,u,a,d,v,m,f,r,n,s=[],o=new Map,p,b,S,k,g,L,R,x=Le(h[3]);const O=W=>W[33];for(let W=0;W<x.length;W+=1){let $=ri(h,x,W),j=O($);C.set(j,w[W]=li(j,$))}let B=Le(h[3]);const H=W=>W[33];for(let W=0;W<B.length;W+=1){let $=ii(h,B,W),j=H($);o.set(j,s[W]=ci(j,$))}let N=h[5]&&hi(h);return{c(){i=T("div"),l=T("div"),_=T("div"),y=T("div");for(let W=0;W<w.length;W+=1)w[W].c();e=U(),t=T("div"),c=T("button"),c.textContent="+",u=U(),a=T("button"),a.textContent="â¬ Dock",d=U(),v=T("button"),v.textContent="â",m=U(),f=T("button"),f.textContent="Ã",r=U(),n=T("div");for(let W=0;W<s.length;W+=1)s[W].c();p=U(),b=T("div"),S=U(),N&&N.c(),k=kt(),A(y,"class","floating-tabs svelte-1sobzgq"),A(c,"title","New Tab"),A(c,"class","new-tab-btn svelte-1sobzgq"),A(a,"title","Dock Terminal"),A(a,"class","svelte-1sobzgq"),A(v,"title","Minimize"),A(v,"class","svelte-1sobzgq"),A(f,"title","Close All"),A(f,"class","svelte-1sobzgq"),A(t,"class","floating-actions svelte-1sobzgq"),A(_,"class","floating-header svelte-1sobzgq"),A(_,"role","toolbar"),A(n,"class","floating-body svelte-1sobzgq"),A(b,"class","resize-handle svelte-1sobzgq"),A(b,"role","separator"),A(l,"class","floating-terminal svelte-1sobzgq"),Me(l,"left",h[1].x+"px"),Me(l,"top",h[1].y+"px"),Me(l,"width",h[4].width+"px"),Me(l,"height",h[4].height+"px"),le(l,"minimized",h[5]),le(l,"focused",!0),A(i,"class","floating-container svelte-1sobzgq")},m(W,$){ee(W,i,$),E(i,l),E(l,_),E(_,y);for(let j=0;j<w.length;j+=1)w[j]&&w[j].m(y,null);E(_,e),E(_,t),E(t,c),E(t,u),E(t,a),E(t,d),E(t,v),E(t,m),E(t,f),E(l,r),E(l,n);for(let j=0;j<s.length;j+=1)s[j]&&s[j].m(n,null);E(l,p),E(l,b),h[21](l),ee(W,S,$),N&&N.m(W,$),ee(W,k,$),g=!0,L||(R=[Z(c,"click",h[16]),Z(a,"click",h[10]),Z(v,"click",h[11]),Z(f,"click",h[13]),Z(_,"mousedown",h[8]),Z(b,"mousedown",h[9])],L=!0)},p(W,$){$[0]&49164&&(x=Le(W[3]),w=Xe(w,$,O,1,W,x,C,y,Dt,li,null,ri)),$[0]&12&&(B=Le(W[3]),Ge(),s=Xe(s,$,H,1,W,B,o,n,is,ci,null,ii),Je()),(!g||$[0]&2)&&Me(l,"left",W[1].x+"px"),(!g||$[0]&2)&&Me(l,"top",W[1].y+"px"),(!g||$[0]&16)&&Me(l,"width",W[4].width+"px"),(!g||$[0]&16)&&Me(l,"height",W[4].height+"px"),(!g||$[0]&32)&&le(l,"minimized",W[5]),W[5]?N?N.p(W,$):(N=hi(W),N.c(),N.m(k.parentNode,k)):N&&(N.d(1),N=null)},i(W){if(!g){for(let $=0;$<B.length;$+=1)ue(s[$]);g=!0}},o(W){for(let $=0;$<s.length;$+=1)pe(s[$]);g=!1},d(W){W&&(Q(i),Q(S),Q(k));for(let $=0;$<w.length;$+=1)w[$].d();for(let $=0;$<s.length;$+=1)s[$].d();h[21](null),N&&N.d(W),L=!1,fe(R)}}}function oi(h,i){let l,_,y,w,C,e=i[34].name+"",t,c,u,a,d,v;function m(){return i[22](i[33])}function f(){return i[23](i[33])}return{key:h,first:null,c(){l=T("button"),_=T("span"),w=U(),C=T("span"),t=se(e),c=U(),u=T("button"),u.textContent="Ã",a=U(),A(_,"class",y="status-dot "+Nt(i[34].status)+" svelte-1sobzgq"),A(C,"class","tab-name svelte-1sobzgq"),A(u,"class","tab-close svelte-1sobzgq"),A(u,"title","Close"),A(l,"class","docked-tab svelte-1sobzgq"),le(l,"active",i[33]===i[2]),this.first=l},m(r,n){ee(r,l,n),E(l,_),E(l,w),E(l,C),E(C,t),E(l,c),E(l,u),E(l,a),d||(v=[Z(u,"click",Et(m)),Z(l,"click",f)],d=!0)},p(r,n){i=r,n[0]&8&&y!==(y="status-dot "+Nt(i[34].status)+" svelte-1sobzgq")&&A(_,"class",y),n[0]&8&&e!==(e=i[34].name+"")&&ne(t,e),n[0]&12&&le(l,"active",i[33]===i[2])},d(r){r&&Q(l),d=!1,fe(v)}}}function ai(h,i){let l,_,y,w;return _=new Hi({props:{session:i[34]}}),{key:h,first:null,c(){l=T("div"),ze(_.$$.fragment),y=U(),A(l,"class","terminal-panel svelte-1sobzgq"),le(l,"active",i[33]===i[2]),this.first=l},m(C,e){ee(C,l,e),xe(_,l,null),E(l,y),w=!0},p(C,e){i=C;const t={};e[0]&8&&(t.session=i[34]),_.$set(t),(!w||e[0]&12)&&le(l,"active",i[33]===i[2])},i(C){w||(ue(_.$$.fragment,C),w=!0)},o(C){pe(_.$$.fragment,C),w=!1},d(C){C&&Q(l),Oe(_)}}}function li(h,i){let l,_,y,w,C,e=i[34].name+"",t,c,u,a,d,v;function m(){return i[19](i[33])}function f(){return i[20](i[33])}return{key:h,first:null,c(){l=T("button"),_=T("span"),w=U(),C=T("span"),t=se(e),c=U(),u=T("button"),u.textContent="Ã",a=U(),A(_,"class",y="status-dot "+Nt(i[34].status)+" svelte-1sobzgq"),A(C,"class","tab-name svelte-1sobzgq"),A(u,"class","tab-close svelte-1sobzgq"),A(u,"title","Close"),A(l,"class","floating-tab svelte-1sobzgq"),le(l,"active",i[33]===i[2]),this.first=l},m(r,n){ee(r,l,n),E(l,_),E(l,w),E(l,C),E(C,t),E(l,c),E(l,u),E(l,a),d||(v=[Z(u,"click",Et(m)),Z(l,"click",f)],d=!0)},p(r,n){i=r,n[0]&8&&y!==(y="status-dot "+Nt(i[34].status)+" svelte-1sobzgq")&&A(_,"class",y),n[0]&8&&e!==(e=i[34].name+"")&&ne(t,e),n[0]&12&&le(l,"active",i[33]===i[2])},d(r){r&&Q(l),d=!1,fe(v)}}}function ci(h,i){let l,_,y,w;return _=new Hi({props:{session:i[34]}}),{key:h,first:null,c(){l=T("div"),ze(_.$$.fragment),y=U(),A(l,"class","terminal-panel svelte-1sobzgq"),le(l,"active",i[33]===i[2]),this.first=l},m(C,e){ee(C,l,e),xe(_,l,null),E(l,y),w=!0},p(C,e){i=C;const t={};e[0]&8&&(t.session=i[34]),_.$set(t),(!w||e[0]&12)&&le(l,"active",i[33]===i[2])},i(C){w||(ue(_.$$.fragment,C),w=!0)},o(C){pe(_.$$.fragment,C),w=!1},d(C){C&&Q(l),Oe(_)}}}function hi(h){let i,l,_,y,w,C,e,t=h[6]>1?"s":"",c,u,a;return{c(){i=T("div"),l=T("button"),_=T("span"),_.textContent="â",y=U(),w=T("span"),C=se(h[6]),e=se(" Terminal"),c=se(t),A(_,"class","restore-icon svelte-1sobzgq"),A(l,"class","restore-btn svelte-1sobzgq"),A(i,"class","minimized-bar svelte-1sobzgq")},m(d,v){ee(d,i,v),E(i,l),E(l,_),E(l,y),E(l,w),E(w,C),E(w,e),E(w,c),u||(a=Z(l,"click",h[12]),u=!0)},p(d,v){v[0]&64&&ne(C,d[6]),v[0]&64&&t!==(t=d[6]>1?"s":"")&&ne(c,t)},d(d){d&&Q(i),u=!1,a()}}}function Sn(h){let i,l,_=h[6]>0&&ni(h);return{c(){_&&_.c(),i=kt()},m(y,w){_&&_.m(y,w),ee(y,i,w),l=!0},p(y,w){y[6]>0?_?(_.p(y,w),w[0]&64&&ue(_,1)):(_=ni(y),_.c(),ue(_,1),_.m(i.parentNode,i)):_&&(Ge(),pe(_,1,1,()=>{_=null}),Je())},i(y){l||(ue(_),l=!0)},o(y){pe(_),l=!1},d(y){y&&Q(i),_&&_.d(y)}}}function Nt(h){switch(h){case"connected":return"status-connected";case"connecting":return"status-connecting";default:return"status-disconnected"}}function bn(h,i,l){let _,y,w,C,e,t,c,u,a,d,v;be(h,_e,D=>l(17,u=D)),be(h,wr,D=>l(18,a=D)),be(h,Ii,D=>l(6,d=D)),be(h,kr,D=>l(7,v=D));let m,f=!1,r=!1,n={x:0,y:0};function s(D){D.target instanceof HTMLElement&&(D.target.tagName==="BUTTON"||D.target.closest("button"))||(f=!0,n={x:D.clientX-C.x,y:D.clientY-C.y})}function o(D){if(f){const P=Math.max(0,Math.min(window.innerWidth-100,D.clientX-n.x)),I=Math.max(0,Math.min(window.innerHeight-100,D.clientY-n.y));_e.setFloatingPosition(P,I)}if(r){const P=Math.max(400,D.clientX-C.x),I=Math.max(300,D.clientY-C.y);_e.setFloatingSize(P,I)}}function p(){(f||r)&&(f=!1,r=!1,setTimeout(()=>_e.fitAll(),50))}function b(D){D.preventDefault(),D.stopPropagation(),r=!0}function S(){_e.toggleViewMode()}function k(){_e.minimize()}function g(){_e.restore()}function L(){confirm("Close all terminal sessions?")&&_e.closeAllSessions()}function R(D){_e.closeSession(D)}function x(D){_e.setActiveSession(D)}function O(){_&&_e.createNewTab(_,y)}Lt(()=>{window.addEventListener("mousemove",o),window.addEventListener("mouseup",p)}),Ei(()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",p)});const B=D=>R(D),H=D=>x(D);function N(D){Ft[D?"unshift":"push"](()=>{m=D,l(0,m)})}const W=D=>R(D),$=D=>x(D),j=()=>window.history.back();return h.$$.update=()=>{var D;h.$$.dirty[0]&262144&&(_=(a==null?void 0:a.containerId)||null),h.$$.dirty[0]&262144&&(y=((D=a==null?void 0:a.name)==null?void 0:D.replace(/\s*\(\d+\)$/,""))||"Terminal"),h.$$.dirty[0]&131072&&u.viewMode,h.$$.dirty[0]&131072&&l(5,w=u.isMinimized),h.$$.dirty[0]&131072&&l(1,C=u.floatingPosition),h.$$.dirty[0]&131072&&l(4,e=u.floatingSize),h.$$.dirty[0]&131072&&l(3,t=Array.from(u.sessions.entries())),h.$$.dirty[0]&131072&&l(2,c=u.activeSessionId)},[m,C,c,t,e,w,d,v,s,b,S,k,g,L,R,x,O,u,a,B,H,N,W,$,j]}class Cn extends Ue{constructor(i){super(),Ne(this,i,bn,Sn,Pe,{},null,[-1,-1])}}function Fi(h){const i=h-1;return i*i*i+1}function wn(h,{from:i,to:l},_={}){const y=getComputedStyle(h),w=y.transform==="none"?"":y.transform,[C,e]=y.transformOrigin.split(" ").map(parseFloat),t=i.left+i.width*C/l.width-(l.left+C),c=i.top+i.height*e/l.height-(l.top+e),{delay:u=0,duration:a=v=>Math.sqrt(v)*120,easing:d=Fi}=_;return{delay:u,duration:_t(a)?a(Math.sqrt(t*t+c*c)):a,easing:d,css:(v,m)=>{const f=m*t,r=m*c,n=v+m*i.width/l.width,s=v+m*i.height/l.height;return`transform: ${w} translate(${f}px, ${r}px) scale(${n}, ${s});`}}}function yn(h,{delay:i=0,duration:l=400,easing:_=Ut}={}){const y=+getComputedStyle(h).opacity;return{delay:i,duration:l,easing:_,css:w=>`opacity: ${w*y}`}}function kn(h,{delay:i=0,duration:l=400,easing:_=Fi,x:y=0,y:w=0,opacity:C=0}={}){const e=getComputedStyle(h),t=+e.opacity,c=e.transform==="none"?"":e.transform,u=t*(1-C),[a,d]=bs(y),[v,m]=bs(w);return{delay:i,duration:l,easing:_,css:(f,r)=>`
			transform: ${c} translate(${(1-f)*a}${d}, ${(1-f)*v}${m});
			opacity: ${t-u*r}`}}function ui(h,i,l){const _=h.slice();return _[2]=i[l],_}function di(h){let i,l,_;function y(){return h[1](h[2])}return{c(){i=T("button"),i.textContent="Ã",A(i,"class","toast-close svelte-19p1m4m"),A(i,"aria-label","Dismiss")},m(w,C){ee(w,i,C),l||(_=Z(i,"click",y),l=!0)},p(w,C){h=w},d(w){w&&Q(i),l=!1,_()}}}function fi(h,i){let l,_,y=_i(i[2].type)+"",w,C,e,t=i[2].message+"",c,u,a,d,v,m,f,r=ie,n,s=i[2].dismissible&&di(i);return{key:h,first:null,c(){l=T("div"),_=T("span"),w=se(y),C=U(),e=T("span"),c=se(t),u=U(),s&&s.c(),a=U(),A(_,"class","toast-icon svelte-19p1m4m"),le(_,"spinning",i[2].type==="loading"),A(e,"class","toast-message svelte-19p1m4m"),A(l,"class",d="toast toast-"+i[2].type+" svelte-19p1m4m"),this.first=l},m(o,p){ee(o,l,p),E(l,_),E(_,w),E(l,C),E(l,e),E(e,c),E(l,u),s&&s.m(l,null),E(l,a),n=!0},p(o,p){i=o,(!n||p&1)&&y!==(y=_i(i[2].type)+"")&&ne(w,y),(!n||p&1)&&le(_,"spinning",i[2].type==="loading"),(!n||p&1)&&t!==(t=i[2].message+"")&&ne(c,t),i[2].dismissible?s?s.p(i,p):(s=di(i),s.c(),s.m(l,a)):s&&(s.d(1),s=null),(!n||p&1&&d!==(d="toast toast-"+i[2].type+" svelte-19p1m4m"))&&A(l,"class",d)},r(){f=l.getBoundingClientRect()},f(){Ji(l),r(),ki(l,f)},a(){r(),r=Gi(l,f,wn,{duration:200})},i(o){n||(o&&qe(()=>{n&&(m&&m.end(1),v=er(l,kn,{x:100,duration:200}),v.start())}),n=!0)},o(o){v&&v.invalidate(),o&&(m=tr(l,yn,{duration:150})),n=!1},d(o){o&&Q(l),s&&s.d(),o&&m&&m.end()}}}function En(h){let i,l=[],_=new Map,y,w=Le(h[0]);const C=e=>e[2].id;for(let e=0;e<w.length;e+=1){let t=ui(h,w,e),c=C(t);_.set(c,l[e]=fi(c,t))}return{c(){i=T("div");for(let e=0;e<l.length;e+=1)l[e].c();A(i,"class","toast-container svelte-19p1m4m")},m(e,t){ee(e,i,t);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(i,null);y=!0},p(e,[t]){if(t&1){w=Le(e[0]),Ge();for(let c=0;c<l.length;c+=1)l[c].r();l=Xe(l,t,C,1,e,w,_,i,sr,fi,null,ui);for(let c=0;c<l.length;c+=1)l[c].a();Je()}},i(e){if(!y){for(let t=0;t<w.length;t+=1)ue(l[t]);y=!0}},o(e){for(let t=0;t<l.length;t+=1)pe(l[t]);y=!1},d(e){e&&Q(i);for(let t=0;t<l.length;t+=1)l[t].d()}}}function _i(h){switch(h){case"success":return"â";case"error":return"â";case"warning":return"â ";case"loading":return"â";default:return"â¹"}}function Ln(h,i,l){let _;return be(h,Dr,w=>l(0,_=w)),[_,w=>he.dismiss(w.id)]}class Dn extends Ue{constructor(i){super(),Ne(this,i,Ln,En,Pe,{})}}const{window:Rn}=bi;function An(h){let i,l,_,y,w,C,e,t,c,u,a;i=new xr({}),i.$on("home",h[10]),i.$on("create",h[11]),i.$on("settings",h[12]),i.$on("sshkeys",h[13]),i.$on("guest",h[6]);const d=[Pn,On,xn,Mn,Bn],v=[];function m(n,s){return n[0]==="landing"?0:n[0]==="dashboard"?1:n[0]==="create"?2:n[0]==="settings"?3:n[0]==="sshkeys"?4:-1}~(y=m(h))&&(w=v[y]=d[y](h));let f=h[5]&&pi();t=new Dn({});let r=h[2]&&vi(h);return{c(){ze(i.$$.fragment),l=U(),_=T("main"),w&&w.c(),C=U(),f&&f.c(),e=U(),ze(t.$$.fragment),c=U(),r&&r.c(),u=kt(),A(_,"class","main svelte-ts6zs6")},m(n,s){xe(i,n,s),ee(n,l,s),ee(n,_,s),~y&&v[y].m(_,null),ee(n,C,s),f&&f.m(n,s),ee(n,e,s),xe(t,n,s),ee(n,c,s),r&&r.m(n,s),ee(n,u,s),a=!0},p(n,s){let o=y;y=m(n),y===o?~y&&v[y].p(n,s):(w&&(Ge(),pe(v[o],1,1,()=>{v[o]=null}),Je()),~y?(w=v[y],w?w.p(n,s):(w=v[y]=d[y](n),w.c()),ue(w,1),w.m(_,null)):w=null),n[5]?f?s&32&&ue(f,1):(f=pi(),f.c(),ue(f,1),f.m(e.parentNode,e)):f&&(Ge(),pe(f,1,1,()=>{f=null}),Je()),n[2]?r?r.p(n,s):(r=vi(n),r.c(),r.m(u.parentNode,u)):r&&(r.d(1),r=null)},i(n){a||(ue(i.$$.fragment,n),ue(w),ue(f),ue(t.$$.fragment,n),a=!0)},o(n){pe(i.$$.fragment,n),pe(w),pe(f),pe(t.$$.fragment,n),a=!1},d(n){n&&(Q(l),Q(_),Q(C),Q(e),Q(c),Q(u)),Oe(i,n),~y&&v[y].d(),f&&f.d(n),Oe(t,n),r&&r.d(n)}}}function Tn(h){let i;return{c(){i=T("div"),i.innerHTML='<div class="spinner-large svelte-ts6zs6"></div> <p class="svelte-ts6zs6">Loading...</p>',A(i,"class","loading-screen svelte-ts6zs6")},m(l,_){ee(l,i,_)},p:ie,i:ie,o:ie,d(l){l&&Q(i)}}}function Bn(h){let i,l;return i=new fn({}),i.$on("back",h[10]),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},p:ie,i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function Mn(h){let i,l;return i=new on({}),i.$on("back",h[10]),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},p:ie,i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function xn(h){let i,l;return i=new sn({}),i.$on("cancel",h[10]),i.$on("created",h[14]),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},p:ie,i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function On(h){let i,l;return i=new Xr({}),i.$on("create",h[11]),i.$on("connect",h[18]),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},p:ie,i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function Pn(h){let i,l;return i=new Ir({}),i.$on("guest",h[6]),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},p:ie,i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function pi(h){let i,l;return i=new Cn({}),{c(){ze(i.$$.fragment)},m(_,y){xe(i,_,y),l=!0},i(_){l||(ue(i.$$.fragment,_),l=!0)},o(_){pe(i.$$.fragment,_),l=!1},d(_){Oe(i,_)}}}function vi(h){let i,l,_,y,w,C,e,t,c,u,a,d,v,m,f,r,n,s,o,p,b,S,k=h[4]?"Starting...":"Start Terminal",g,L,R,x;return{c(){i=T("div"),l=T("div"),_=T("div"),y=T("h2"),y.textContent="Get Started",w=U(),C=T("button"),C.textContent="Ã",e=U(),t=T("div"),c=T("p"),c.textContent="Enter your email to start your free guest session. We'll use this to save your work and send you updates.",u=U(),a=T("div"),d=T("label"),d.textContent="Email Address",v=U(),m=T("input"),f=U(),r=T("p"),r.textContent="ð Guest sessions last 30 minutes. Sign in with PipeOps for unlimited access.",n=U(),s=T("div"),o=T("button"),p=se("Cancel"),b=U(),S=T("button"),g=se(k),A(y,"id","guest-modal-title"),A(y,"class","svelte-ts6zs6"),A(C,"class","modal-close svelte-ts6zs6"),A(C,"aria-label","Close"),A(_,"class","modal-header svelte-ts6zs6"),A(c,"class","modal-description svelte-ts6zs6"),A(d,"for","guest-email"),A(d,"class","svelte-ts6zs6"),A(m,"type","email"),A(m,"id","guest-email"),A(m,"placeholder","you@example.com"),m.disabled=h[4],A(m,"class","svelte-ts6zs6"),A(a,"class","form-group svelte-ts6zs6"),A(r,"class","modal-hint svelte-ts6zs6"),A(t,"class","modal-body svelte-ts6zs6"),A(o,"class","btn btn-secondary"),o.disabled=h[4],A(S,"class","btn btn-primary"),S.disabled=L=h[4]||!h[3].trim(),A(s,"class","modal-footer svelte-ts6zs6"),A(l,"class","modal svelte-ts6zs6"),A(l,"role","dialog"),A(l,"aria-modal","true"),A(l,"aria-labelledby","guest-modal-title"),A(i,"class","modal-overlay svelte-ts6zs6"),A(i,"role","presentation")},m(O,B){ee(O,i,B),E(i,l),E(l,_),E(_,y),E(_,w),E(_,C),E(l,e),E(l,t),E(t,c),E(t,u),E(t,a),E(a,d),E(a,v),E(a,m),ge(m,h[3]),E(t,f),E(t,r),E(l,n),E(l,s),E(s,o),E(o,p),E(s,b),E(s,S),E(S,g),R||(x=[Z(C,"click",h[7]),Z(m,"input",h[19]),Z(m,"keydown",h[9]),Z(o,"click",h[7]),Z(S,"click",h[8]),Z(l,"click",Et(h[17])),Z(i,"click",h[7]),Z(i,"keydown",h[9])],R=!0)},p(O,B){B&16&&(m.disabled=O[4]),B&8&&m.value!==O[3]&&ge(m,O[3]),B&16&&(o.disabled=O[4]),B&16&&k!==(k=O[4]?"Starting...":"Start Terminal")&&ne(g,k),B&24&&L!==(L=O[4]||!O[3].trim())&&(S.disabled=L)},d(O){O&&Q(i),R=!1,fe(x)}}}function In(h){let i,l,_,y,w,C;const e=[Tn,An],t=[];function c(u,a){return u[1]?0:1}return l=c(h),_=t[l]=e[l](h),{c(){i=T("div"),_.c(),A(i,"class","app svelte-ts6zs6")},m(u,a){ee(u,i,a),t[l].m(i,null),y=!0,w||(C=Z(Rn,"popstate",h[15]),w=!0)},p(u,[a]){let d=l;l=c(u),l===d?t[l].p(u,a):(Ge(),pe(t[d],1,1,()=>{t[d]=null}),Je(),_=t[l],_?_.p(u,a):(_=t[l]=e[l](u),_.c()),ue(_,1),_.m(i,null))},i(u){y||(ue(_),y=!0)},o(u){pe(_),y=!1},d(u){u&&Q(i),t[l].d(),w=!1,C()}}}function Hn(h){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)}function Fn(h,i,l){let _,y,w;be(h,Ti,R=>l(16,_=R)),be(h,ye,R=>l(20,y=R)),be(h,yr,R=>l(5,w=R));let C="landing",e=!0,t=!1,c="",u=!1;function a(){l(3,c=""),l(2,t=!0)}function d(){l(2,t=!1),l(3,c="")}async function v(){if(!c.trim()){he.error("Please enter your email");return}if(!Hn(c.trim())){he.error("Please enter a valid email");return}l(4,u=!0);const R=await ye.guestLogin(c.trim());l(4,u=!1),R.success&&d()}function m(R){R.key==="Enter"&&!u?v():R.key==="Escape"&&d()}async function f(){const x=new URLSearchParams(window.location.search).get("code");x&&(await ye.exchangeOAuthCode(x)).success&&(window.history.replaceState({},"",window.location.pathname),l(0,C="dashboard"))}async function r(){const x=window.location.pathname.match(/^\/(?:terminal\/)?([a-f0-9]{64}|[a-f0-9-]{36})$/i);if(x&&_){const O=x[1],B=await Ee.getContainer(O);B.success&&B.container&&_e.createSession(O,B.container.name)}}Lt(async()=>{await f(),y.token&&(await ye.validateToken()?(await ye.fetchProfile(),l(0,C="dashboard"),await Ee.fetchContainers(),await r()):ye.logout()),l(1,e=!1)});function n(){l(0,C="dashboard"),window.history.pushState({},"","/")}function s(){l(0,C="create")}function o(){l(0,C="settings")}function p(){l(0,C="sshkeys")}function b(R){const{id:x,name:O}=R.detail;l(0,C="dashboard"),_e.createSession(x,O)}function S(){const R=window.location.pathname;(R==="/"||R==="")&&l(0,C=_?"dashboard":"landing")}function k(R){Li.call(this,h,R)}const g=R=>{_e.createSession(R.detail.id,R.detail.name)};function L(){c=this.value,l(3,c)}return h.$$.update=()=>{h.$$.dirty&65537&&_&&C==="landing"&&(l(0,C="dashboard"),Ee.fetchContainers()),h.$$.dirty&65537&&!_&&C!=="landing"&&(l(0,C="landing"),Ee.reset(),_e.closeAllSessions())},[C,e,t,c,u,w,a,d,v,m,n,s,o,p,b,S,_,k,g,L]}class Wn extends Ue{constructor(i){super(),Ne(this,i,Fn,In,Pe,{})}}new Wn({target:document.getElementById("app")});
